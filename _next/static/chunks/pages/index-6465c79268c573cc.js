(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7385)}])},7385:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var r=a(5893),i=a(7294),s=a(1163);let n={current:[]},l=new Set,o=!1,isClient=()=>!0,useBasket=()=>{let[,e]=(0,i.useState)(0),t=(0,i.useRef)(()=>{e(e=>e+1)});(0,i.useEffect)(()=>{let e=t.current;return l.add(e),()=>l.delete(e)},[]),(0,i.useEffect)(()=>{if(isClient()&&!o){o=!0;let e=sessionStorage.getItem("basket");if(e)try{n.current=JSON.parse(e),l.forEach(e=>e())}catch(e){console.error("Failed to load basket:",e)}}},[]);let a=(0,i.useCallback)(e=>{n.current=e,isClient()&&sessionStorage.setItem("basket",JSON.stringify(e)),l.forEach(e=>e())},[]),r=(0,i.useCallback)(e=>{let t="string"==typeof e?e:e.sedol;n.current.includes(t)||a([...n.current,t])},[a]),s=(0,i.useCallback)(e=>{a(n.current.filter(t=>t!==e))},[a]),c=(0,i.useCallback)(()=>{a([])},[a]),d=(0,i.useCallback)(e=>n.current.includes(e),[]);return{basket:n.current,addToBasket:r,removeFromBasket:s,clearBasket:c,isInBasket:d}};var c=a(3550),d=a(467),m=a(9832),_=a(9921),h=a(6243),u=a.n(h),components_Navigation=e=>{let{currentStep:t,onStepChange:a,basket:s=[]}=e,n=[{id:"picker",name:"Select Funds",icon:c.Z},{id:"analyze",name:"Analysis",icon:d.Z},{id:"optimize",name:"Optimize",icon:m.Z},{id:"summary",name:"Summary",icon:_.Z}],l="string"==typeof t?n.findIndex(e=>e.id===t)+1:t,isStepDisabled=e=>e>=2&&0===s.length,handleStepClick=e=>{isStepDisabled(e)||a(e)},getStepClasses=e=>{let t=[u().step];return l===e&&t.push(u().active),l>e&&t.push(u().completed),isStepDisabled(e)&&t.push(u().disabled),t.join(" ")};return(0,r.jsx)("div",{className:u()["step-nav"],children:(0,r.jsx)("div",{className:u()["nav-steps"],children:n.map((e,t)=>{e.icon;let a=t+1,s=isStepDisabled(a);return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)("div",{className:getStepClasses(a),onClick:()=>handleStepClick(a),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),handleStepClick(a))},role:"button",tabIndex:s?-1:0,"aria-label":"Step ".concat(a,": ").concat(e.name).concat(s?" (disabled)":""),"aria-disabled":s,children:[(0,r.jsx)("div",{className:u()["step-number"],children:a}),(0,r.jsx)("span",{children:e.name})]}),t<n.length-1&&(0,r.jsx)("div",{className:"".concat(u()["step-connector"]," ").concat(l>a?u().completed:"")})]},e.id)})})})},p=a(3408),x=a(6615),f=a(2598);let v={categorical:{sector_name:{field:"sector_name",label:"Sector",type:"select",defaultValue:"",searchable:!0,filterKey:"sector_name"},unit_type:{field:"unit_type",label:"Unit Type",type:"select",defaultValue:"",searchable:!1,filterKey:"unit_type"},payment_type:{field:"payment_type",label:"Payment Type",type:"select",defaultValue:"",searchable:!1,filterKey:"payment_type"},payment_frequency:{field:"payment_frequency",label:"Payment Frequency",type:"select",defaultValue:"",searchable:!1,filterKey:"payment_frequency"}},numeric:{annual_charge:{field:"annual_charge",label:"Annual Charge (%)",minKey:"annual_charge_min",maxKey:"annual_charge_max",boundKey:"annual_charge",step:.1,decimals:1,unit:"%",format:"percentage"},sharpe_one_year:{field:"fidelity_sharpeRatios_oneYear",label:"Sharpe Ratio (1Y)",minKey:"sharpe_one_year_min",maxKey:"sharpe_one_year_max",boundKey:"sharpe_one_year",step:.1,decimals:1,unit:"",format:"decimal"},sharpe_three_year:{field:"fidelity_sharpeRatios_threeYear",label:"Sharpe Ratio (3Y)",minKey:"sharpe_three_year_min",maxKey:"sharpe_three_year_max",boundKey:"sharpe_three_year",step:.1,decimals:1,unit:"",format:"decimal"},sharpe_five_year:{field:"fidelity_sharpeRatios_fiveYear",label:"Sharpe Ratio (5Y)",minKey:"sharpe_five_year_min",maxKey:"sharpe_five_year_max",boundKey:"sharpe_five_year",step:.1,decimals:1,unit:"",format:"decimal"},yield:{field:"yield",label:"Yield",minKey:"yield_min",maxKey:"yield_max",boundKey:"yield",step:.1,decimals:1,unit:"%",format:"percentage"},perf3m:{field:"perf3m",label:"Performance (3M)",minKey:"perf3m_min",maxKey:"perf3m_max",boundKey:"perf3m",step:1,decimals:0,unit:"%",format:"percentage"},perf6m:{field:"perf6m",label:"Performance (6M)",minKey:"perf6m_min",maxKey:"perf6m_max",boundKey:"perf6m",step:1,decimals:0,unit:"%",format:"percentage"},perf12m:{field:"perf12m",label:"Performance (12M)",minKey:"perf12m_min",maxKey:"perf12m_max",boundKey:"perf12m",step:1,decimals:0,unit:"%",format:"percentage"},perf36m:{field:"perf36m",label:"Performance (36M)",minKey:"perf36m_min",maxKey:"perf36m_max",boundKey:"perf36m",step:1,decimals:0,unit:"%",format:"percentage"},perf60m:{field:"perf60m",label:"Performance (60M)",minKey:"perf60m_min",maxKey:"perf60m_max",boundKey:"perf60m",step:1,decimals:0,unit:"%",format:"percentage"}},search:{fields:["sedol","fund_name","description","citicode","yahoo_symbol"],caseSensitive:!1,fuzzyMatch:!1},sorting:{defaultField:"fund_name",defaultOrder:"asc",availableFields:[{field:"fund_name",label:"Fund Name",type:"string"},{field:"annual_charge",label:"Annual Charge",type:"number"},{field:"yield",label:"Yield",type:"number"},{field:"perf12m",label:"Performance (12M)",type:"number"},{field:"fidelity_sharpeRatios_oneYear",label:"Sharpe Ratio (1Y)",type:"number"}]},performance:{chunkSize:50,updateInterval:100,maxCacheSize:100,maxSearchRegexCache:50}},initializeFiltersFromConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return Object.entries(v.categorical).forEach(e=>{let[a,r]=e;t[r.filterKey]=r.defaultValue}),Object.entries(v.numeric).forEach(a=>{let[r,i]=a,s=e[i.boundKey]||{min:0,max:0};t[i.minKey]=s.min.toString(),t[i.maxKey]=s.max.toString()}),t},calculateDataBoundsFromConfig=e=>{let t={};if(Object.entries(v.numeric).forEach(e=>{let[a,r]=e;t[r.boundKey]={min:1/0,max:-1/0}}),e&&e.length>0)for(let a of e)Object.entries(v.numeric).forEach(e=>{let[r,i]=e,s=a[i.field];if(null!=s&&!isNaN(s)){let e=t[i.boundKey];s<e.min&&(e.min=s),s>e.max&&(e.max=s)}});return Object.entries(t).forEach(e=>{let[a,r]=e;r.min===1/0||r.max===-1/0?t[a]={min:0,max:0}:t[a]={min:Math.floor(10*r.min)/10,max:Math.ceil(10*r.max)/10}}),t},getActiveFiltersFromConfig=(e,t)=>{if(!e)return{};let a={};return Object.entries(v.categorical).forEach(t=>{var r;let[i,s]=t;(null===(r=e[s.filterKey])||void 0===r?void 0:r.trim())&&(a[s.filterKey]=e[s.filterKey])}),Object.entries(v.numeric).forEach(r=>{let[i,s]=r,n=t[s.boundKey];if(n){let t=parseFloat(e[s.minKey]),r=parseFloat(e[s.maxKey]);!isNaN(t)&&!isNaN(r)&&(t>n.min||r<n.max)&&(a[s.minKey]=e[s.minKey],a[s.maxKey]=e[s.maxKey])}}),a},compileFilterFunctionFromConfig=(e,t)=>{let a=getActiveFiltersFromConfig(e,t);if(0===Object.keys(a).length)return()=>!0;let r=[];Object.entries(v.categorical).forEach(e=>{let[t,i]=e;if(a[i.filterKey]){let e=a[i.filterKey];r.push(t=>t[i.field]===e)}});let i=[];return Object.entries(v.numeric).forEach(e=>{let[t,r]=e;if(a[r.minKey]&&a[r.maxKey]){let e=parseFloat(a[r.minKey]),t=parseFloat(a[r.maxKey]);isNaN(e)||isNaN(t)||i.push(a=>{let i=a[r.field];return null!=i&&i>=e&&i<=t})}}),e=>{for(let t of r)if(!t(e))return!1;for(let t of i)if(!t(e))return!1;return!0}},validateFiltersFromConfig=(e,t)=>{if(!e||!t)return null;let a={...e};return Object.entries(v.numeric).forEach(e=>{let[r,i]=e,s=t[i.boundKey];if(s){let e=parseFloat(a[i.minKey]),t=parseFloat(a[i.maxKey]);isNaN(e)||(a[i.minKey]=Math.max(e,s.min).toString()),isNaN(t)||(a[i.maxKey]=Math.min(t,s.max).toString())}}),a},g=new class{initializeFilters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return initializeFiltersFromConfig(e)}calculateDataBounds(e){return calculateDataBoundsFromConfig(e)}validateFilters(e,t){return validateFiltersFromConfig(e,t)}resetFilters(e){return this.clearCaches(),this.initializeFilters(e)}getActiveFilters(e,t){let a=JSON.stringify({filters:e,bounds:t});if(this.activeFiltersCache.has(a))return this.activeFiltersCache.get(a);let r=getActiveFiltersFromConfig(e,t);return this.activeFiltersCache.size>v.performance.maxCacheSize&&this.activeFiltersCache.clear(),this.activeFiltersCache.set(a,r),r}compileFilterFunction(e,t){let a=JSON.stringify({filters:e,bounds:t});if(this.filterFunctionCache.has(a))return this.filterFunctionCache.get(a);let r=compileFilterFunctionFromConfig(e,t);return this.filterFunctionCache.size>v.performance.maxCacheSize&&this.filterFunctionCache.clear(),this.filterFunctionCache.set(a,r),r}matchesSearchTerm(e,t){if(!t)return!0;let a=t.toLowerCase(),r=this.searchRegexCache.get(a);if(!r){let e=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");r=new RegExp(e,v.search.caseSensitive?"":"i"),this.searchRegexCache.size>v.performance.maxSearchRegexCache&&this.searchRegexCache.clear(),this.searchRegexCache.set(a,r)}let i=v.search.fields.map(t=>e[t]).filter(Boolean).join(" ").toLowerCase();return r.test(i)}sortFunds(e,t,a){if(!e.length)return[];let r="asc"===a,i=v.sorting.availableFields.find(e=>e.field===t),s=(null==i?void 0:i.type)==="number";return s?e.slice().sort((e,a)=>{var i,s;let n=null!==(i=e[t])&&void 0!==i?i:0,l=null!==(s=a[t])&&void 0!==s?s:0;return r?n-l:l-n}):e.slice().sort((e,a)=>{var i,s;let n=String(null!==(i=e[t])&&void 0!==i?i:"").toLowerCase(),l=String(null!==(s=a[t])&&void 0!==s?s:"").toLowerCase();return n<l?r?-1:1:n>l?r?1:-1:0})}async filterAndSearch(e,t,a,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{useProgressive:s=!1,onProgressUpdate:n=null,abortSignal:l=null}=i,o=Object.keys(this.getActiveFilters(a,r)).length,c=(null==t?void 0:t.trim().length)>0,d=s||e.length>500||o>2||c;return d&&n?this._filterAndSearchProgressive(e,t,a,r,n,l):this._filterAndSearchFast(e,t,a,r)}_filterAndSearchFast(e,t,a,r){let i=(null==t?void 0:t.trim().length)>0,s=this.compileFilterFunction(a,r),n=[],l=[];for(let a of e)if(i){let e=this.matchesSearchTerm(a,t);if(e){let e=s(a);e?n.push(a):l.push({...a,_filteredOut:!0})}}else s(a)&&n.push(a);return{funds:n,searchMatchedButFiltered:l}}async _filterAndSearchProgressive(e,t,a,r,i,s){let n=v.performance.chunkSize,l=v.performance.updateInterval;try{let o=(null==t?void 0:t.trim().length)>0,c=this.compileFilterFunction(a,r),d=[],m=[],_=0,h=Date.now();for(let a=0;a<e.length;a+=n){if(null==s?void 0:s.aborted)throw Error("Operation aborted");let r=e.slice(a,a+n);for(let e of r){if(o){let a=this.matchesSearchTerm(e,t);if(a){let t=c(e);t?d.push(e):m.push({...e,_filteredOut:!0})}}else c(e)&&d.push(e);_++}let u=Date.now(),p=a+n>=e.length;(u-h>=l||p||_%n==0)&&(i&&i({processed:_,total:e.length,currentResults:d.length,filteredOut:m.length,isComplete:p}),h=u,await new Promise(e=>setTimeout(e,0)))}return{funds:d,searchMatchedButFiltered:m,totalProcessed:_}}catch(e){throw"Operation aborted"===e.message?console.log("Progressive filtering aborted"):console.error("Error in progressive filtering:",e),e}}getUniqueValues(e,t){if(!(null==e?void 0:e.length))return[];let a=new Set;for(let r of e){let e=r[t];null!=e&&""!==e&&a.add(e)}return Array.from(a).sort()}clearCaches(){this.activeFiltersCache.clear(),this.searchRegexCache.clear(),this.filterFunctionCache.clear()}getFilterInfo(e){let t=v.categorical[e]||v.numeric[e];return t?{label:t.label,type:t.type||"numeric",field:t.field,format:t.format,unit:t.unit}:null}getAvailableFilters(){let e=[];return Object.entries(v.categorical).forEach(t=>{let[a,r]=t;e.push({key:a,type:"categorical",label:r.label,field:r.field,searchable:r.searchable})}),Object.entries(v.numeric).forEach(t=>{let[a,r]=t;e.push({key:a,type:"numeric",label:r.label,field:r.field,minKey:r.minKey,maxKey:r.maxKey,unit:r.unit,format:r.format,step:r.step,decimals:r.decimals})}),e}getSortingOptions(){return v.sorting.availableFields.map(e=>({value:e.field,label:e.label,type:e.type}))}constructor(){this.activeFiltersCache=new Map,this.searchRegexCache=new Map,this.filterFunctionCache=new Map}},y={initialize:e=>g.initializeFilters(e),calculateBounds:e=>g.calculateDataBounds(e),validateFilters:(e,t)=>g.validateFilters(e,t),resetFilters:e=>g.resetFilters(e),filterAndSearch:(e,t,a,r,i)=>g.filterAndSearch(e,t,a,r,i),sortFunds:(e,t,a)=>g.sortFunds(e,t,a),getUniqueValues:(e,t)=>g.getUniqueValues(e,t),getActiveFilters:(e,t)=>g.getActiveFilters(e,t),getFilterInfo:e=>g.getFilterInfo(e),getAvailableFilters:()=>g.getAvailableFilters(),getSortingOptions:()=>g.getSortingOptions(),clearCaches:()=>g.clearCaches()};y.initialize,y.calculateBounds,y.validateFilters,y.resetFilters,y.sortFunds,y.getUniqueValues,y.getActiveFilters,y.clearCaches;let saveSortingPreferences=(e,t)=>{try{localStorage.setItem("fundSortBy",e),localStorage.setItem("fundSortOrder",t)}catch(e){console.warn("Failed to save sorting preferences to localStorage:",e)}},loadSortingPreferences=()=>{try{let e=localStorage.getItem("fundSortBy"),t=localStorage.getItem("fundSortOrder");return{sortBy:e,sortOrder:t}}catch(e){return console.warn("Failed to load sorting preferences from localStorage:",e),{sortBy:null,sortOrder:null}}},saveFilters=e=>{try{localStorage.setItem("fundFilters",JSON.stringify(e))}catch(e){console.warn("Failed to save filters to localStorage:",e)}},loadSavedFilters=()=>{try{let e=localStorage.getItem("fundFilters");if(e)return JSON.parse(e)}catch(e){console.warn("Failed to load filters from localStorage:",e)}return null};var j=a(1587),b=a(4004),N=a(1203),S=a(9906),C=a(8255),k=a(5227),F=a.n(k),components_BasketModal=e=>{let{showBasket:t,setShowBasket:a,funds:s,onViewFundDetails:n}=e,[l,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(""),[m,_]=(0,i.useState)(null),{basket:h,removeFromBasket:u}=useBasket();if(!t)return null;i.useEffect(()=>{let handleEscapeKey=e=>{"Escape"===e.key&&(a(!1),o(!1))};return t&&(document.addEventListener("keydown",handleEscapeKey),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",handleEscapeKey),document.body.style.overflow="unset"}},[t,a]);let copyFundItem=async e=>{let t="".concat(e.sedol," - ").concat(e.fund_name);try{await navigator.clipboard.writeText(t),_(e.sedol),setTimeout(()=>_(null),2e3)}catch(e){console.error("Failed to copy fund item:",e)}},copySedols=async()=>{let e=h.map(e=>'"'.concat(e.sedol,'"')).join(", ");try{await navigator.clipboard.writeText(e),d("SEDOLs copied!"),o(!1),setTimeout(()=>d(""),2e3)}catch(e){console.error("Failed to copy SEDOLs:",e),d("Copy failed"),setTimeout(()=>d(""),2e3)}},copyAsJson=async()=>{let e=h.reduce((e,t)=>{let a=t.yahoo_symbol||t.sedol;return e[a]=t.fund_name,e},{});try{await navigator.clipboard.writeText(JSON.stringify(e,null,2)),d("JSON copied!"),o(!1),setTimeout(()=>d(""),2e3)}catch(e){console.error("Failed to copy JSON:",e),d("Copy failed"),setTimeout(()=>d(""),2e3)}},handleViewFundDetails=e=>{n&&n(e)};return(0,r.jsx)("div",{className:F().overlay,onClick:e=>{e.target===e.currentTarget&&(a(!1),o(!1))},children:(0,r.jsxs)("div",{className:F().modal,role:"dialog","aria-labelledby":"basket-title","aria-modal":"true",children:[(0,r.jsxs)("div",{className:F().header,children:[(0,r.jsxs)("h3",{id:"basket-title",className:F().title,children:["Fund Basket (",h.length,")"]}),(0,r.jsxs)("div",{className:F().headerActions,children:[h.length>0&&(0,r.jsxs)("div",{className:F().copyContainer,children:[(0,r.jsxs)("button",{onClick:()=>o(!l),className:F().copyButton,"aria-label":"Copy basket data",children:[(0,r.jsx)(j.Z,{size:18}),(0,r.jsx)(b.Z,{size:16})]}),l&&(0,r.jsxs)("div",{className:F().copyMenu,children:[(0,r.jsx)("button",{onClick:copySedols,className:F().copyMenuItem,children:"Copy SEDOLs"}),(0,r.jsx)("button",{onClick:copyAsJson,className:F().copyMenuItem,children:"Copy as JSON"})]}),c&&(0,r.jsx)("div",{className:F().copySuccess,children:c})]}),(0,r.jsx)("button",{onClick:()=>a(!1),className:F().closeButton,"aria-label":"Close basket modal",children:(0,r.jsx)(N.Z,{size:24})})]})]}),0===h.length?(0,r.jsx)("p",{className:F().emptyState,children:"No funds in basket"}):(0,r.jsx)("div",{className:F().fundsList,children:s.filter(e=>h.some(t=>t===e.sedol)).map(e=>(0,r.jsxs)("div",{className:F().fundItem,children:[(0,r.jsxs)("div",{className:F().fundInfo,children:[(0,r.jsx)("h4",{className:F().fundName,children:e.fund_name}),(0,r.jsxs)("p",{className:F().fundDetails,children:[e.sector_name,(0,r.jsx)("span",{className:F().separator,children:"•"}),(0,r.jsxs)("span",{className:F().fee,children:[e.annual_charge,"% fee"]})]})]}),(0,r.jsxs)("div",{className:F().fundActions,children:[(0,r.jsx)("button",{onClick:()=>handleViewFundDetails(e),className:F().infoButton,"aria-label":"View details for ".concat(e.fund_name),children:(0,r.jsx)(S.Z,{size:16})}),(0,r.jsxs)("button",{onClick:()=>copyFundItem(e),className:F().copyItemButton,"aria-label":"Copy ".concat(e.fund_name," details"),children:[(0,r.jsx)(j.Z,{size:16}),m===e.sedol&&(0,r.jsx)("span",{className:F().copiedIndicator,children:"Copied!"})]}),(0,r.jsx)("button",{onClick:()=>u(e.sedol),className:F().removeButton,"aria-label":"Remove ".concat(e.fund_name," from basket"),children:(0,r.jsx)(C.Z,{size:18})})]})]},e.sedol))})]})})},z=a(2205),M=a.n(z),w=a(6513),A=a.n(w),components_RangeSlider=e=>{let{label:t,field:a,bounds:s,unit:n="",draftFilters:l,setDraftFilters:o,disabled:c}=e,d=parseFloat(l["".concat(a,"_min")])||s.min,m=parseFloat(l["".concat(a,"_max")])||s.max,[_,h]=(0,i.useState)({min:!1,max:!1}),u=(0,i.useRef)([d,m]),p=(0,i.useRef)(null),x=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=parseFloat(l["".concat(a,"_min")])||s.min,t=parseFloat(l["".concat(a,"_max")])||s.max;u.current=[e,t]},[l,a,s]);let f=(0,i.useMemo)(()=>{let e=s.max-s.min,t=e/4;return Array.from({length:5},(e,a)=>{let r=s.min+t*a;return{value:r,label:r.toFixed(1)+n}})},[s,n]),v=(0,i.useCallback)(e=>{if(!p.current)return s.min;let t=p.current.getBoundingClientRect(),a=Math.max(0,Math.min(1,(e-t.left)/t.width)),r=s.min+a*(s.max-s.min);return Math.max(s.min,Math.min(s.max,r))},[s]),g=(0,i.useCallback)(e=>{let t=(e-s.min)/(s.max-s.min);return 100*t},[s]),y=(0,i.useCallback)((e,t)=>{x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{var a,r,i,s,l;let o=null===(a=p.current)||void 0===a?void 0:a.querySelector('[data-thumb="min"]'),c=null===(r=p.current)||void 0===r?void 0:r.querySelector('[data-thumb="max"]'),d=null===(i=p.current)||void 0===i?void 0:i.querySelector('[data-range="true"]'),m=null===(s=p.current)||void 0===s?void 0:s.querySelector('[data-tooltip="min"]'),_=null===(l=p.current)||void 0===l?void 0:l.querySelector('[data-tooltip="max"]'),h=g(e),u=g(t);o&&(o.style.left="".concat(h,"%")),c&&(c.style.left="".concat(u,"%")),d&&(d.style.left="".concat(h,"%"),d.style.width="".concat(u-h,"%")),m&&(m.textContent="".concat(e.toFixed(1)).concat(n)),_&&(_.textContent="".concat(t.toFixed(1)).concat(n))})},[g,n]),j=(0,i.useCallback)((e,t)=>{if(c)return;e.preventDefault(),e.stopPropagation(),h(e=>({...e,[t]:!0}));let handleMouseMove=e=>{let a=v(e.clientX),r=u.current[0],i=u.current[1];"min"===t?r=Math.min(a,u.current[1]):i=Math.max(a,u.current[0]),u.current=[r,i],y(r,i)},handleMouseUp=()=>{h({min:!1,max:!1});let[e,t]=u.current;o(r=>({...r,["".concat(a,"_min")]:e.toString(),["".concat(a,"_max")]:t.toString()})),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)};document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp)},[c,a,v,y,o]),b=(0,i.useCallback)(e=>{if(c)return;let t=v(e.clientX),[r,i]=u.current,s=r,n=i;Math.abs(t-r)<Math.abs(t-i)?s=Math.min(t,i):n=Math.max(t,r),u.current=[s,n],o(e=>({...e,["".concat(a,"_min")]:s.toString(),["".concat(a,"_max")]:n.toString()}))},[c,a,v,o]);(0,i.useEffect)(()=>()=>{x.current&&cancelAnimationFrame(x.current)},[]);let[N,S]=u.current,C=g(N),k=g(S);return(0,r.jsxs)("div",{className:A()["range-slider-container"],children:[(0,r.jsx)("div",{className:A()["slider-label"],children:t}),(0,r.jsxs)("div",{className:A()["slider-values"],children:[(0,r.jsxs)("span",{className:A()["value-display"],children:[N.toFixed(1),n]}),(0,r.jsxs)("span",{className:A()["value-display"],children:[S.toFixed(1),n]})]}),(0,r.jsxs)("div",{className:A()["custom-slider"],ref:p,children:[(0,r.jsx)("div",{className:A()["slider-scale"],children:f.map((e,t)=>(0,r.jsxs)("div",{className:A()["scale-mark"],style:{left:"".concat(g(e.value),"%")},children:[(0,r.jsx)("div",{className:A()["scale-tick"]}),(0,r.jsx)("div",{className:A()["scale-label"],children:e.label})]},t))}),(0,r.jsxs)("div",{className:A()["slider-track"],onClick:b,children:[(0,r.jsx)("div",{className:A()["slider-range"],"data-range":"true",style:{left:"".concat(C,"%"),width:"".concat(k-C,"%")}}),(0,r.jsx)("div",{className:"".concat(A()["slider-thumb"]," ").concat(_.min?A().dragging:""),"data-thumb":"min",style:{left:"".concat(C,"%")},onMouseDown:e=>j(e,"min"),role:"slider","aria-valuemin":s.min,"aria-valuemax":s.max,"aria-valuenow":N,"aria-label":"".concat(t," minimum value"),tabIndex:0,children:(0,r.jsxs)("div",{className:A()["thumb-tooltip"],"data-tooltip":"min",children:[N.toFixed(1),n]})}),(0,r.jsx)("div",{className:"".concat(A()["slider-thumb"]," ").concat(_.max?A().dragging:""),"data-thumb":"max",style:{left:"".concat(k,"%")},onMouseDown:e=>j(e,"max"),role:"slider","aria-valuemin":s.min,"aria-valuemax":s.max,"aria-valuenow":S,"aria-label":"".concat(t," maximum value"),tabIndex:0,children:(0,r.jsxs)("div",{className:A()["thumb-tooltip"],"data-tooltip":"max",children:[S.toFixed(1),n]})})]})]})]})},components_FilterModal=e=>{let{showFilterModal:t,setShowFilterModal:a,filters:s,setFilters:n,dataBounds:l,getUniqueValues:o,resetFilters:c,disabled:d=!1}=e,[m,_]=(0,i.useState)(s);if((0,i.useEffect)(()=>{t&&_({...s})},[t,s]),!t)return null;let handleClose=()=>{d||(_({...s}),a(!1))};(0,i.useEffect)(()=>{let handleEscape=e=>{"Escape"===e.key&&t&&handleClose()};if(t)return document.addEventListener("keydown",handleEscape),()=>document.removeEventListener("keydown",handleEscape)},[t,s]);let SelectField=e=>{let{label:t,value:a,onChange:i,options:s,placeholder:n}=e;return(0,r.jsxs)("div",{className:M()["form-group"],children:[(0,r.jsx)("label",{className:M()["form-group__label"],children:t}),(0,r.jsxs)("select",{value:a||"",onChange:e=>!d&&i(e.target.value),className:M()["form-group__select"],disabled:d,children:[(0,r.jsx)("option",{value:"",children:n}),s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})};return(0,r.jsx)("div",{className:M()["modal-overlay"],onClick:e=>{e.target===e.currentTarget&&handleClose()},children:(0,r.jsxs)("div",{className:M()["modal-container"],children:[(0,r.jsxs)("div",{className:M()["modal-header"],children:[(0,r.jsx)("h2",{className:M()["modal-header__title"],children:"Filter Funds"}),(0,r.jsx)("button",{onClick:handleClose,className:M()["modal-header__close-button"],"aria-label":"Close filter modal",disabled:d,children:(0,r.jsx)(N.Z,{size:24})})]}),(0,r.jsxs)("div",{className:M()["filter-grid"],children:[(0,r.jsxs)("div",{className:M()["filter-section"],children:[(0,r.jsx)("h3",{className:M()["filter-section__title"],children:"Fees & Ratios"}),(0,r.jsx)(components_RangeSlider,{label:"Annual Charge",field:"annual_charge",bounds:l.annual_charge,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Yield",field:"yield",bounds:l.yield,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Sharpe Ratio (1 Year)",field:"sharpe_one_year",bounds:l.sharpe_one_year,draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Sharpe Ratio (3 Years)",field:"sharpe_three_year",bounds:l.sharpe_three_year,draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Sharpe Ratio (5 Years)",field:"sharpe_five_year",bounds:l.sharpe_five_year,draftFilters:m,setDraftFilters:_,disabled:d})]}),(0,r.jsxs)("div",{className:M()["filter-section"],children:[(0,r.jsx)("h3",{className:M()["filter-section__title"],children:"Performance"}),(0,r.jsx)(components_RangeSlider,{label:"Performance (3 Months)",field:"perf3m",bounds:l.perf3m,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Performance (6 Months)",field:"perf6m",bounds:l.perf6m,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Performance (12 Months)",field:"perf12m",bounds:l.perf12m,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Performance (36 Months)",field:"perf36m",bounds:l.perf36m,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d}),(0,r.jsx)(components_RangeSlider,{label:"Performance (60 Months)",field:"perf60m",bounds:l.perf60m,unit:"%",draftFilters:m,setDraftFilters:_,disabled:d})]}),(0,r.jsxs)("div",{className:M()["filter-section"],children:[(0,r.jsx)("h3",{className:M()["filter-section__title"],children:"Fund Details"}),(0,r.jsx)(SelectField,{label:"Sector",value:m.sector_name,onChange:e=>_({...m,sector_name:e}),options:o("sector_name"),placeholder:"All Sectors"}),(0,r.jsx)(SelectField,{label:"Unit Type",value:m.unit_type,onChange:e=>_({...m,unit_type:e}),options:o("unit_type"),placeholder:"All Types"}),(0,r.jsx)(SelectField,{label:"Payment Type",value:m.payment_type,onChange:e=>_({...m,payment_type:e}),options:o("payment_type"),placeholder:"All Payment Types"}),(0,r.jsx)(SelectField,{label:"Payment Frequency",value:m.payment_frequency,onChange:e=>_({...m,payment_frequency:e}),options:o("payment_frequency"),placeholder:"All Frequencies"})]})]}),(0,r.jsxs)("div",{className:M()["modal-footer"],children:[(0,r.jsx)("button",{onClick:()=>{d||(c(),a(!1))},className:M()["modal-footer__reset-button"],disabled:d,children:"Reset All"}),(0,r.jsx)("button",{onClick:()=>{d||(n(m),a(!1))},className:M()["modal-footer__apply-button"],disabled:d,children:"Apply Filters"})]})]})})},R=a(113),P=a(8347),O=a(8109),T=a.n(O),components_FundCard=e=>{let{fund:t,onViewDetails:a,isFilteredOut:i=!1}=e,{basket:s,addToBasket:n,isInBasket:l}=useBasket(),o="".concat(T()["fund-card"]," ").concat(i?T()["fund-card--filtered"]:"");return(0,r.jsxs)("div",{className:o,children:[i&&(0,r.jsxs)("div",{className:T()["filtered-badge"],children:[(0,r.jsx)(R.Z,{size:12}),(0,r.jsx)("span",{children:"Filtered by criteria"})]}),(0,r.jsxs)("div",{className:T()["fund-card-header"],children:[(0,r.jsxs)("div",{className:T()["fund-info"],children:[(0,r.jsx)("h4",{className:T()["fund-name"],children:t.fund_name}),(0,r.jsx)("div",{className:T()["fund-sector"],children:t.sector_name}),(0,r.jsxs)("div",{className:T()["fund-sedol"],children:["SEDOL: ",t.sedol||"N/A"]})]}),(0,r.jsx)("button",{className:"".concat(T()["add-button"]," ").concat(l(t.sedol)||i?T()["add-button--disabled"]:""),onClick:e=>{e.stopPropagation(),i||n(t.sedol)},disabled:l(t.sedol)||i,title:i?"Fund is filtered out - adjust filters to add":"Add to basket",children:(0,r.jsx)(P.Z,{size:16})})]}),(0,r.jsxs)("div",{className:T()["fund-details"],children:[(0,r.jsxs)("div",{className:T()["fund-detail-item"],children:[(0,r.jsx)("strong",{children:"Annual Fee:"}),(0,r.jsxs)("span",{className:T()["fee-text"],children:[t.annual_charge||"N/A","%"]})]}),(0,r.jsxs)("div",{className:T()["fund-detail-item"],children:[(0,r.jsx)("strong",{children:"Unit Type:"}),(0,r.jsx)("span",{children:t.unit_type||"N/A"})]}),(0,r.jsxs)("div",{className:T()["fund-detail-item"],children:[(0,r.jsx)("strong",{children:"Min Investment:"}),(0,r.jsxs)("span",{children:["\xa3",t.lump_sum_min_inv||"N/A"]})]}),(0,r.jsxs)("div",{className:T()["fund-detail-item"],children:[(0,r.jsx)("strong",{children:"Fund Size:"}),(0,r.jsxs)("span",{children:["\xa3",t.fund_size||"N/A","M"]})]})]}),(0,r.jsxs)("button",{className:T()["view-details-button"],onClick:()=>a(t),children:[(0,r.jsx)(S.Z,{size:16}),"View Details"]})]},t.sedol)},D=a(512),Y=a(1628),B=a.n(Y),components_FundDetailModal=e=>{let{selectedFund:t,setSelectedFund:a}=e;if(!t)return null;let{basket:s,addToBasket:n,isInBasket:l}=useBasket(),o=l(t.sedol),formatPerformance=e=>{if(!e||"N/A"===e)return"N/A";let t=parseFloat(e);return{value:"".concat(e,"%"),className:t>0?"positive":t<0?"negative":""}};i.useEffect(()=>{let handleEscape=e=>{"Escape"===e.key&&a(null)};return document.addEventListener("keydown",handleEscape),()=>document.removeEventListener("keydown",handleEscape)},[a]);let c=formatPerformance(t.perf3m),d=formatPerformance(t.perf6m),m=formatPerformance(t.perf12m),_=formatPerformance(t.perf36m),h=formatPerformance(t.perf60m);return(0,r.jsx)("div",{className:B().modal,onClick:e=>{e.target===e.currentTarget&&a(null)},children:(0,r.jsxs)("div",{className:B().modal__content,children:[(0,r.jsxs)("div",{className:B().modal__header,children:[(0,r.jsx)("h3",{children:t.fund_name}),(0,r.jsx)("button",{className:B().modal__close,onClick:()=>a(null),"aria-label":"Close modal",children:(0,r.jsx)(N.Z,{size:24})})]}),(0,r.jsxs)("div",{className:B().details__grid,children:[(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"SEDOL"}),(0,r.jsx)("span",{children:t.sedol})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Sector"}),(0,r.jsx)("span",{children:t.sector_name})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Annual Charge"}),(0,r.jsxs)("span",{children:[t.annual_charge,"%"]})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Unit Type"}),(0,r.jsx)("span",{children:t.unit_type})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Company"}),(0,r.jsx)("span",{children:t.company_name})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Fund Size"}),(0,r.jsxs)("span",{children:["\xa3",t.fund_size,"M"]})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Risk Rating"}),(0,r.jsx)("span",{children:t.risk_rating})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Yield"}),(0,r.jsxs)("span",{children:[t.yield,"%"]})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Payment Type"}),(0,r.jsx)("span",{children:t.payment_type})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Payment Frequency"}),(0,r.jsx)("span",{children:t.payment_frequency})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Min Investment"}),(0,r.jsxs)("span",{children:["\xa3",t.lump_sum_min_inv]})]}),(0,r.jsxs)("div",{className:B().details__item,children:[(0,r.jsx)("strong",{children:"Launch Date"}),(0,r.jsx)("span",{children:t.launchdate})]})]}),t.description&&(0,r.jsxs)("div",{className:B().description,children:[(0,r.jsx)("div",{className:B().description__title,children:"Description"}),(0,r.jsx)("p",{className:B().description__text,children:t.description})]}),t.aims&&(0,r.jsxs)("div",{className:B().aims,children:[(0,r.jsx)("div",{className:B().aims__title,children:"Investment Aims"}),(0,r.jsx)("p",{className:B().aims__text,children:t.aims})]}),(0,r.jsxs)("div",{className:B().performance__grid,children:[(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Perf (3M)"}),(0,r.jsx)("span",{className:B()[c.className],children:c.value})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Perf (6M)"}),(0,r.jsx)("span",{className:B()[d.className],children:d.value})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Perf (1Y)"}),(0,r.jsx)("span",{className:B()[m.className],children:m.value})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Perf (3Y)"}),(0,r.jsx)("span",{className:B()[_.className],children:_.value})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Perf (5Y)"}),(0,r.jsx)("span",{className:B()[h.className],children:h.value})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Sharpe (1Y)"}),(0,r.jsx)("span",{children:t.fidelity_sharpeRatios_oneYear||"N/A"})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Sharpe (3Y)"}),(0,r.jsx)("span",{children:t.fidelity_sharpeRatios_threeYear||"N/A"})]}),(0,r.jsxs)("div",{className:B().performance__item,children:[(0,r.jsx)("strong",{children:"Sharpe (5Y)"}),(0,r.jsx)("span",{children:t.fidelity_sharpeRatios_fiveYear||"N/A"})]})]}),(0,r.jsxs)("div",{className:B().documents,children:[t.kiid_url&&(0,r.jsxs)("a",{href:t.kiid_url,target:"_blank",rel:"noopener noreferrer",className:"".concat(B().documents__link," ").concat(B()["documents__link--primary"]),children:[(0,r.jsx)(D.Z,{size:16}),"Fund Document"]}),t.fidelity_risk_rating_url&&(0,r.jsxs)("a",{href:t.fidelity_risk_rating_url,target:"_blank",rel:"noopener noreferrer",className:"".concat(B().documents__link," ").concat(B()["documents__link--success"]),children:[(0,r.jsx)(D.Z,{size:16}),"Risk Rating"]}),t.sedol&&(0,r.jsxs)("a",{href:"https://www.hl.co.uk/funds/fund-discounts,-prices--and--factsheets/search-results/".concat(t.sedol),target:"_blank",rel:"noopener noreferrer",className:"".concat(B().documents__link," ").concat(B()["documents__link--secondary"]),children:[(0,r.jsx)(D.Z,{size:16}),"HL Fund Page"]}),t.yahoo_symbol&&(0,r.jsxs)("a",{href:"https://finance.yahoo.com/quote/".concat(t.yahoo_symbol),target:"_blank",rel:"noopener noreferrer",className:"".concat(B().documents__link," ").concat(B()["documents__link--secondary"]),children:[(0,r.jsx)(D.Z,{size:16}),"Yahoo Finance"]})]}),(0,r.jsx)("button",{className:"".concat(B().action__button," ").concat(o?B()["action__button--disabled"]:""),onClick:()=>{o||(n(t.sedol),a(null))},disabled:l,children:o?"Already in Basket":"Add to Basket"})]})})},E=a(7706),I=a(5887),L=a(8873),Z=a.n(L),components_FundInfoBar=e=>{let{currentPage:t,totalPages:a,filteredCount:i,totalDisplayCount:s,searchMatchedButFilteredCount:n=0,searchTerm:l="",sortBy:o,sortOrder:c}=e,d=""!==l.trim()&&n>0;return(0,r.jsxs)("div",{className:Z()["fund-info-bar"],children:[(0,r.jsxs)("div",{className:Z()["fund-info-bar__main"],children:[(0,r.jsxs)("div",{className:Z()["fund-info-bar__results"],children:[(0,r.jsxs)("div",{className:Z()["fund-count"],children:[(0,r.jsx)(E.Z,{size:16}),(0,r.jsx)("span",{className:Z()["fund-count__number"],children:i}),(0,r.jsx)("span",{className:Z()["fund-count__label"],children:"available funds"})]}),d&&(0,r.jsxs)("div",{className:Z()["fund-count"],children:[(0,r.jsx)(I.Z,{size:16}),(0,r.jsx)("span",{className:Z()["fund-count__number--muted"],children:n}),(0,r.jsx)("span",{className:Z()["fund-count__label--muted"],children:"filtered out"})]}),(0,r.jsxs)("div",{className:Z()["fund-count"],children:[(0,r.jsx)("span",{className:Z()["fund-count__number"],children:s}),(0,r.jsx)("span",{className:Z()["fund-count__label"],children:"total shown"})]})]}),(0,r.jsx)("div",{className:Z()["fund-info-bar__sorting"],children:(0,r.jsxs)("span",{className:Z()["sorting-info"],children:["Sorted by ",(0,r.jsx)("strong",{children:{fund_name:"Name",annual_charge:"Annual Fee",fund_size:"Fund Size",yield:"Yield",perf3m:"3 months Performance",perf6m:"6 months Performance",perf12m:"1 year Performance",perf36m:"3 years Performance",perf60m:"5 years Performance",fidelity_sharpeRatios_oneYear:"1-Year Sharpe Ratio",fidelity_sharpeRatios_threeYear:"3-Year Sharpe Ratio",fidelity_sharpeRatios_fiveYear:"5-Year Sharpe Ratio",sector_name:"Sector"}[o]||o}),(0,r.jsxs)("span",{className:Z()["sort-order"],children:["(","asc"===c?"⇧":"⇩",")"]})]})}),(0,r.jsx)("div",{className:Z()["fund-info-bar__pagination"],children:(0,r.jsxs)("span",{children:["Page ",t," of ",a]})})]}),d&&(0,r.jsxs)("div",{className:Z()["fund-info-bar__filter-notice"],children:[(0,r.jsx)(R.Z,{size:14}),(0,r.jsxs)("span",{children:[n," fund",1!==n?"s":""," ","match your search but are hidden by filters"]})]})]})},K=a(7761),W=a.n(K),components_LoadingSpinner=e=>{let{header:t="Loading Funds...",paragraph:a="Please wait while we load the data."}=e;return(0,r.jsx)("div",{className:W()["step-picker__card"],children:(0,r.jsxs)("div",{className:W()["step-picker__loading"],children:[(0,r.jsx)("h2",{children:t}),(0,r.jsx)("p",{children:a})]})})},q=a(9638),V=a(9942),H=a.n(V),components_PaginationControls=e=>{let{currentPage:t,totalPages:a,goToPage:i}=e;if(a<=1)return null;let s=1===t,n=t===a;return(0,r.jsxs)("div",{className:H().pagination,children:[(0,r.jsx)("button",{onClick:()=>{t>1&&i(t-1)},disabled:s,className:"".concat(H().navigationButton," ").concat(s?H().disabled:""),"aria-label":"Previous page",children:(0,r.jsx)(q.Z,{className:H().icon})}),(()=>{let e=[],r=Math.max(1,t-Math.floor(2.5)),i=Math.min(a,r+5-1);i-r+1<5&&(r=Math.max(1,i-5+1));for(let t=r;t<=i;t++)e.push(t);return e})().map(e=>(0,r.jsx)("button",{onClick:()=>i(e),className:"".concat(H().pageButton," ").concat(e===t?H().active:""),"aria-label":"Go to page ".concat(e),"aria-current":e===t?"page":void 0,children:e},e)),(0,r.jsx)("button",{onClick:()=>{t<a&&i(t+1)},disabled:n,className:"".concat(H().navigationButton," ").concat(n?H().disabled:""),"aria-label":"Next page",children:(0,r.jsx)(x.Z,{className:H().icon})})]})},U=a(525),G=a.n(U),components_ProgressIndicator=e=>{let{isFiltering:t,filterProgress:a}=e;if(!t)return null;let i=a.total>0?Math.round(a.processed/a.total*100):0;return(0,r.jsxs)("div",{className:G()["step-picker__progress"],children:[(0,r.jsx)("div",{className:G()["step-picker__progress-bar"],children:(0,r.jsx)("div",{className:G()["step-picker__progress-fill"],style:{width:"".concat(i,"%")}})}),(0,r.jsxs)("p",{className:G()["step-picker__progress-text"],children:["Processed ",a.processed.toLocaleString()," of ",a.total.toLocaleString()," funds",a.currentResults>0&&(0,r.jsxs)("span",{children:[" • ",a.currentResults.toLocaleString()," matches found"]})]})]})},J=a(7119),X=a(1038),Q=a(1806),$=a(4326),ee=a.n($),components_SearchAndSortControls=e=>{let{searchTerm:t,onSearchChange:a,sortBy:i,onSortByChange:s,sortOrder:n,onToggleSortOrder:l,onShowFilters:o,sortOptions:c,showFilteredOutFunds:d=!1,onToggleShowFilteredOut:m,searchMatchedButFilteredCount:_=0}=e,h=t.trim()&&_>0;return(0,r.jsxs)("div",{className:ee().controls,children:[(0,r.jsxs)("div",{className:ee()["search-wrapper"],children:[(0,r.jsx)(J.Z,{size:20,className:ee()["search-icon"]}),(0,r.jsx)("input",{type:"text",placeholder:"Search funds by name, SEDOL, or code...",value:t,onChange:e=>a(e.target.value),className:ee()["search-input"]}),h&&(0,r.jsx)("button",{onClick:m,className:ee()["toggle-button"],title:d?"Hide ".concat(_," filtered out funds"):"Show ".concat(_," filtered out funds"),type:"button",children:d?(0,r.jsx)(I.Z,{size:16}):(0,r.jsx)(E.Z,{size:16})}),t&&(0,r.jsx)("button",{onClick:()=>{a("")},className:ee()["clear-button"],title:"Clear search",type:"button",children:(0,r.jsx)(N.Z,{size:16})})]}),(0,r.jsxs)("div",{className:ee()["sort-controls"],children:[(0,r.jsx)("select",{value:i,onChange:e=>s(e.target.value),className:ee()["sort-select"],children:c.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,r.jsx)("button",{onClick:l,className:ee()["sort-order-button"],title:"Sort ".concat("asc"===n?"Ascending":"Descending"),children:"asc"===n?(0,r.jsx)(X.Z,{size:18}):(0,r.jsx)(Q.Z,{size:18})})]}),(0,r.jsxs)("button",{onClick:o,className:ee()["filter-button"],children:[(0,r.jsx)(R.Z,{size:18}),"Filters"]})]})};let et=[{value:"fund_name",label:"Fund Name"},{value:"sector_name",label:"Sector"},{value:"annual_charge",label:"Annual Fee"},{value:"fund_size",label:"Fund Size"},{value:"lump_sum_min_inv",label:"Min Investment"},{value:"yield",label:"Yield"},{value:"perf3m",label:"Performance 3M"},{value:"perf6m",label:"Performance 6M"},{value:"perf12m",label:"Performance 1Y"},{value:"perf36m",label:"Performance 3Y"},{value:"perf60m",label:"Performance 5Y"},{value:"fidelity_sharpeRatios_oneYear",label:"Sharpe 1Y"},{value:"fidelity_sharpeRatios_threeYear",label:"Sharpe 3Y"},{value:"fidelity_sharpeRatios_fiveYear",label:"Sharpe 5Y"}];var components_StepPicker=e=>{let{onNext:t}=e,{funds:a,loading:s}=(0,f.W)(),[n,l]=(0,i.useState)([]),[o,c]=(0,i.useState)([]),[d,m]=(0,i.useState)(""),[_,h]=(0,i.useState)(!1),[u,v]=(0,i.useState)(!1),[g,j]=(0,i.useState)(null),[b,N]=(0,i.useState)(1),[S,C]=(0,i.useState)(!1),[k,F]=(0,i.useState)(!1),[z,M]=(0,i.useState)({processed:0,total:0,currentResults:0}),w=(0,i.useRef)(null),[A,R]=(0,i.useState)("fund_name"),[P,O]=(0,i.useState)("asc"),[T,D]=(0,i.useState)(!1),[Y,B]=(0,i.useState)(null),[E,I]=(0,i.useState)(null),{basket:L,addToBasket:Z,removeFromBasket:K,clearBasket:q,isInBasket:V}=useBasket();(0,i.useEffect)(()=>{if(a){let e=y.calculateBounds(a);I(e);let t=loadSavedFilters(),r=t?y.validateFilters(t,e):y.initialize(e);B(r)}},[a]),(0,i.useEffect)(()=>{D(!0);let{sortBy:e,sortOrder:t}=loadSortingPreferences();e&&R(e),t&&O(t)},[]),(0,i.useEffect)(()=>{applyFiltersOnly()},[a,d,Y]),(0,i.useEffect)(()=>{applySortingToFilteredResults()},[n,o,A,P]),(0,i.useEffect)(()=>{N(1)},[n,o,S]),(0,i.useEffect)(()=>{d.trim()||C(!1)},[d]);let applyFiltersOnly=async()=>{w.current&&w.current.abort(),w.current=new AbortController;try{let e=Object.keys(y.getActiveFilters(Y,E)).length,t=d.trim().length>0,r=a.length>500||e>2||t;if(console.log("Applying filters and search to funds",{funds:a.length,activeFiltersCount:e,hasSearch:t,useProgressive:r}),r){F(!0),M({processed:0,total:a.length,currentResults:0});let e=await y.filterAndSearch(a,d,Y,E,{useProgressive:!0,onProgressUpdate:e=>{console.log("Filter progress update:",e),M(e)},abortSignal:w.current.signal});w.current.signal.aborted||(l(e.funds),c(e.searchMatchedButFiltered),F(!1))}else{let e=await y.filterAndSearch(a,d,Y,E);l(e.funds),c(e.searchMatchedButFiltered)}}catch(e){if("AbortError"!==e.name&&"Operation aborted"!==e.message){console.error("Error applying filters:",e);let t=await y.filterAndSearch(a,d,Y,E);l(t.funds),c(t.searchMatchedButFiltered)}}finally{F(!1),M({processed:0,total:0,currentResults:0})}},applySortingToFilteredResults=()=>{if(k)return;console.log("Applying sorting to filtered results",{filteredFunds:n.length,searchMatchedButFiltered:o.length,sortBy:A,sortOrder:P});let e=y.sortFunds(n,A,P),t=y.sortFunds(o,A,P);JSON.stringify(e)!==JSON.stringify(n)&&l(e),JSON.stringify(t)!==JSON.stringify(o)&&c(t)},H=d.trim()&&S?[...n,...o]:n,U=d.trim()?o.length:0,G=Math.ceil(H.length/6),J=(b-1)*6,X=J+6,Q=H.slice(J,X);return s||!Y?(0,r.jsx)(components_LoadingSpinner,{header:"Loading Funds...",paragraph:"Please wait while we load the fund data."}):(0,r.jsxs)("div",{className:W()["step-picker"],children:[(0,r.jsxs)("div",{className:W()["step-picker__header"],children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:W()["step-picker__title"],children:"Step 1: Select Investment Funds"}),(0,r.jsx)("p",{className:W()["step-picker__description"],children:"Search and filter through available funds to build your portfolio."})]}),(0,r.jsxs)("button",{onClick:()=>v(!0),className:W()["step-picker__basket-button"],children:[(0,r.jsx)(p.Z,{size:18}),"Basket (",L.length,")"]})]}),(0,r.jsxs)("div",{className:W()["step-picker__layout"],children:[(0,r.jsx)(components_SearchAndSortControls,{searchTerm:d,onSearchChange:m,sortBy:A,onSortByChange:e=>{R(e),saveSortingPreferences(e,P)},sortOrder:P,onToggleSortOrder:()=>{let e="asc"===P?"desc":"asc";O(e),saveSortingPreferences(A,e)},onShowFilters:()=>h(!0),sortOptions:et,showFilteredOutFunds:S,onToggleShowFilteredOut:()=>{C(e=>!e)},searchMatchedButFilteredCount:U}),k&&(0,r.jsx)(components_ProgressIndicator,{isFiltering:k,filterProgress:z}),!k&&(0,r.jsx)(components_FundInfoBar,{currentPage:b,totalPages:G,filteredCount:n.length,totalDisplayCount:H.length,searchMatchedButFilteredCount:U,searchTerm:d,sortBy:A,sortOrder:P,isFiltering:k}),(0,r.jsx)("div",{className:W()["step-picker__funds-grid"],children:Q.map(e=>(0,r.jsx)(components_FundCard,{fund:e,isFilteredOut:e._filteredOut||!1,onViewDetails:()=>j(e)},e.sedol))}),(0,r.jsx)(components_PaginationControls,{currentPage:b,totalPages:G,goToPage:e=>{N(Math.max(1,Math.min(e,G)))},disabled:k})]}),(0,r.jsx)("div",{className:W()["step-picker__action-buttons"],children:(0,r.jsxs)("button",{className:"".concat(W()["step-picker__continue-button"]," ").concat(0===L.length?W().disabled:""),onClick:()=>{L.length>0&&t()},disabled:0===L.length||k,children:["Continue to Analysis ",(0,r.jsx)(x.Z,{size:16})]})}),_&&(0,r.jsx)(components_FilterModal,{showFilterModal:_,setShowFilterModal:h,filters:Y,setFilters:e=>{B(e),saveFilters(e)},dataBounds:E,getUniqueValues:e=>y.getUniqueValues(a,e),resetFilters:()=>{w.current&&w.current.abort();let e=y.resetFilters(E);B(e),saveFilters(e),y.clearCaches()},disabled:k}),u&&(0,r.jsx)(components_BasketModal,{showBasket:u,setShowBasket:v,funds:a,onViewFundDetails:e=>{j(e)}}),g&&(0,r.jsx)(components_FundDetailModal,{selectedFund:g,setSelectedFund:j})]})},ea=a(278),er=a(7783),ei=a(2946),es=a(342),en=a(2776),el=a.n(en),components_OverviewTab=e=>{let{data:t}=e;return(0,r.jsxs)("div",{className:el()["step-analyze__content"],children:[(0,r.jsx)("h3",{children:"Portfolio Overview"}),(0,r.jsxs)("div",{className:el()["step-analyze__overview-grid"],children:[(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Total Funds"}),(0,r.jsx)("div",{className:el()["step-analyze__metric-value"],children:t.totalFunds})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Combined Min Investment"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:["\xa3",t.totalMinInvestment.toLocaleString()]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Average Annual Fee"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.avgAnnualCharge,"%"]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Sectors Covered"}),(0,r.jsx)("div",{className:el()["step-analyze__metric-value"],children:t.sectors})]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__sectors"],children:[(0,r.jsx)("h4",{children:"Sector Breakdown"}),(0,r.jsx)("div",{className:el()["step-analyze__sector-list"],children:t.sectorList.map((e,t)=>(0,r.jsx)("span",{className:el()["step-analyze__sector-tag"],children:e},t))})]})]})},eo=a(3541),ec=a(9416),ed=a(2759),em=a.n(ed),components_PerformanceTab=e=>{var t,a,i,s,n,l;let{data:o}=e,{performanceData:c,performanceByFund:d,totalFunds:m}=o,getPerformanceIcon=e=>{if("N/A"===e)return(0,r.jsx)(eo.Z,{size:16,className:em()["performance-tab__icon--neutral"]});let t=parseFloat(e);return t>0?(0,r.jsx)(_.Z,{size:16,className:em()["performance-tab__icon--positive"]}):t<0?(0,r.jsx)(ec.Z,{size:16,className:em()["performance-tab__icon--negative"]}):(0,r.jsx)(eo.Z,{size:16,className:em()["performance-tab__icon--neutral"]})},getPerformanceClass=e=>{if("N/A"===e)return em()["performance-tab__value--neutral"];let t=parseFloat(e);return t>0?em()["performance-tab__value--positive"]:t<0?em()["performance-tab__value--negative"]:em()["performance-tab__value--neutral"]};return(0,r.jsxs)("div",{className:em()["performance-tab"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__header"],children:[(0,r.jsx)("h3",{children:"Portfolio Performance Analysis"}),(0,r.jsxs)("p",{children:["Historical performance across various time periods for ",m," funds"]})]}),(0,r.jsx)("div",{className:em()["performance-tab__summary"],children:(0,r.jsxs)("div",{className:em()["performance-tab__card"],children:[(0,r.jsx)("h4",{children:"Key Performance Highlights"}),(0,r.jsxs)("div",{className:em()["performance-tab__highlights"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__highlight"],children:[(0,r.jsx)("span",{className:em()["performance-tab__highlight-label"],children:"Best 12M Avg:"}),(0,r.jsxs)("span",{className:"".concat(em()["performance-tab__highlight-value"]," ").concat(getPerformanceClass(null===(t=c.perf12m)||void 0===t?void 0:t.average)),children:[getPerformanceIcon(null===(a=c.perf12m)||void 0===a?void 0:a.average),null===(i=c.perf12m)||void 0===i?void 0:i.average,"%"]})]}),(0,r.jsxs)("div",{className:em()["performance-tab__highlight"],children:[(0,r.jsx)("span",{className:em()["performance-tab__highlight-label"],children:"5Y Average:"}),(0,r.jsxs)("span",{className:"".concat(em()["performance-tab__highlight-value"]," ").concat(getPerformanceClass(null===(s=c.perf60m)||void 0===s?void 0:s.average)),children:[getPerformanceIcon(null===(n=c.perf60m)||void 0===n?void 0:n.average),null===(l=c.perf60m)||void 0===l?void 0:l.average,"%"]})]})]})]})}),(0,r.jsxs)("div",{className:em()["performance-tab__section"],children:[(0,r.jsx)("h4",{children:"Standard Performance Periods"}),(0,r.jsx)("div",{className:em()["performance-tab__grid"],children:[{key:"perf3m",label:"3 Months",shortLabel:"3M"},{key:"perf6m",label:"6 Months",shortLabel:"6M"},{key:"perf12m",label:"12 Months",shortLabel:"1Y"},{key:"perf36m",label:"36 Months",shortLabel:"3Y"},{key:"perf60m",label:"60 Months",shortLabel:"5Y"},{key:"perf120m",label:"120 Months",shortLabel:"10Y"}].map(e=>{let t=c[e.key];return t&&0!==t.count?(0,r.jsxs)("div",{className:em()["performance-tab__metric-card"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__metric-header"],children:[(0,r.jsx)("h5",{children:e.label}),(0,r.jsxs)("span",{className:em()["performance-tab__metric-count"],children:[t.count," funds"]})]}),(0,r.jsxs)("div",{className:em()["performance-tab__metric-values"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__metric-row"],children:[(0,r.jsx)("span",{children:"Average:"}),(0,r.jsxs)("span",{className:"".concat(em()["performance-tab__metric-value"]," ").concat(getPerformanceClass(t.average)),children:[getPerformanceIcon(t.average),t.average,"%"]})]}),(0,r.jsxs)("div",{className:em()["performance-tab__metric-row"],children:[(0,r.jsx)("span",{children:"Range:"}),(0,r.jsxs)("span",{className:em()["performance-tab__metric-range"],children:[t.min,"% to ",t.max,"%"]})]})]})]},e.key):null})})]}),(0,r.jsxs)("div",{className:em()["performance-tab__section"],children:[(0,r.jsx)("h4",{children:"Rolling Performance Periods"}),(0,r.jsx)("div",{className:em()["performance-tab__grid"],children:[{key:"perf0t12m",label:"0-12 Months Rolling",shortLabel:"0-12M"},{key:"perf12t24m",label:"12-24 Months Rolling",shortLabel:"12-24M"},{key:"perf24t36m",label:"24-36 Months Rolling",shortLabel:"24-36M"},{key:"perf36t48m",label:"36-48 Months Rolling",shortLabel:"36-48M"},{key:"perf48t60m",label:"48-60 Months Rolling",shortLabel:"48-60M"}].map(e=>{let t=c[e.key];return t&&0!==t.count?(0,r.jsxs)("div",{className:em()["performance-tab__metric-card"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__metric-header"],children:[(0,r.jsx)("h5",{children:e.label}),(0,r.jsxs)("span",{className:em()["performance-tab__metric-count"],children:[t.count," funds"]})]}),(0,r.jsxs)("div",{className:em()["performance-tab__metric-values"],children:[(0,r.jsxs)("div",{className:em()["performance-tab__metric-row"],children:[(0,r.jsx)("span",{children:"Average:"}),(0,r.jsxs)("span",{className:"".concat(em()["performance-tab__metric-value"]," ").concat(getPerformanceClass(t.average)),children:[getPerformanceIcon(t.average),t.average,"%"]})]}),(0,r.jsxs)("div",{className:em()["performance-tab__metric-row"],children:[(0,r.jsx)("span",{children:"Range:"}),(0,r.jsxs)("span",{className:em()["performance-tab__metric-range"],children:[t.min,"% to ",t.max,"%"]})]})]})]},e.key):null})})]}),(0,r.jsxs)("div",{className:em()["performance-tab__section"],children:[(0,r.jsx)("h4",{children:"Performance by Fund"}),(0,r.jsx)("div",{className:em()["performance-tab__table-container"],children:(0,r.jsxs)("table",{className:em()["performance-tab__table"],children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Fund Name"}),(0,r.jsx)("th",{children:"3M"}),(0,r.jsx)("th",{children:"6M"}),(0,r.jsx)("th",{children:"1Y"}),(0,r.jsx)("th",{children:"3Y"}),(0,r.jsx)("th",{children:"5Y"}),(0,r.jsx)("th",{children:"10Y"})]})}),(0,r.jsx)("tbody",{children:d.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:em()["performance-tab__fund-name"],children:e.name}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf3m),children:[getPerformanceIcon(e.perf3m),e.perf3m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf6m),children:[getPerformanceIcon(e.perf6m),e.perf6m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf12m),children:[getPerformanceIcon(e.perf12m),e.perf12m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf36m),children:[getPerformanceIcon(e.perf36m),e.perf36m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf60m),children:[getPerformanceIcon(e.perf60m),e.perf60m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf120m),children:[getPerformanceIcon(e.perf120m),e.perf120m,"%"]})]},t))})]})})]}),(0,r.jsxs)("div",{className:em()["performance-tab__section"],children:[(0,r.jsx)("h4",{children:"Rolling Performance by Fund"}),(0,r.jsx)("div",{className:em()["performance-tab__table-container"],children:(0,r.jsxs)("table",{className:em()["performance-tab__table"],children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Fund Name"}),(0,r.jsx)("th",{children:"0-12M"}),(0,r.jsx)("th",{children:"12-24M"}),(0,r.jsx)("th",{children:"24-36M"}),(0,r.jsx)("th",{children:"36-48M"}),(0,r.jsx)("th",{children:"48-60M"})]})}),(0,r.jsx)("tbody",{children:d.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:em()["performance-tab__fund-name"],children:e.name}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf0t12m),children:[getPerformanceIcon(e.perf0t12m),e.perf0t12m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf12t24m),children:[getPerformanceIcon(e.perf12t24m),e.perf12t24m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf24t36m),children:[getPerformanceIcon(e.perf24t36m),e.perf24t36m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf36t48m),children:[getPerformanceIcon(e.perf36t48m),e.perf36t48m,"%"]}),(0,r.jsxs)("td",{className:getPerformanceClass(e.perf48t60m),children:[getPerformanceIcon(e.perf48t60m),e.perf48t60m,"%"]})]},t))})]})})]})]})},e_=a(8937),eh=a(3900),eu=a(1836),ep=a(8212),ex=a.n(ep),components_FidelityMetricsTab=e=>{let{data:t}=e,[a,s]=(0,i.useState)("sharpeRatios"),{metricsData:n,metricsByFund:l,totalFunds:o}=t,d={alphas:{title:"Alpha",icon:c.Z,description:"Measures excess return relative to a benchmark. Positive alpha indicates outperformance.",interpretation:"Higher is better. Values > 0 indicate outperformance.",unit:"%"},betas:{title:"Beta",icon:ea.Z,description:"Measures sensitivity to market movements. Beta of 1 means moves with market.",interpretation:"Beta > 1: More volatile than market. Beta < 1: Less volatile than market.",unit:""},informationRatios:{title:"Information Ratio",icon:_.Z,description:"Risk-adjusted excess return relative to benchmark per unit of tracking error.",interpretation:"Higher is better. Values > 0.5 are considered good.",unit:""},rSquareds:{title:"R-Squared",icon:e_.Z,description:"Measures how much of the fund's movements are explained by benchmark movements.",interpretation:"Higher values (closer to 1) indicate stronger correlation with benchmark.",unit:""},sharpeRatios:{title:"Sharpe Ratio",icon:eh.Z,description:"Risk-adjusted return per unit of total risk (standard deviation).",interpretation:"Higher is better. Values > 1 are considered excellent.",unit:""},standardDeviations:{title:"Standard Deviation",icon:eu.Z,description:"Measures volatility or risk. Higher values indicate more price fluctuation.",interpretation:"Lower is generally better for risk-averse investors.",unit:"%"},trackingErrors:{title:"Tracking Error",icon:ec.Z,description:"Measures how closely fund performance follows its benchmark.",interpretation:"Lower values indicate closer tracking to benchmark.",unit:"%"}},getMetricColor=(e,t)=>{if("N/A"===t)return ex()["fidelity-metrics__value--neutral"];let a=parseFloat(t);switch(e){case"alphas":case"informationRatios":case"sharpeRatios":return a>0?ex()["fidelity-metrics__value--positive"]:ex()["fidelity-metrics__value--negative"];case"betas":return .2>Math.abs(a-1)?ex()["fidelity-metrics__value--neutral"]:a>1.2?ex()["fidelity-metrics__value--warning"]:ex()["fidelity-metrics__value--positive"];case"rSquareds":return a>.8?ex()["fidelity-metrics__value--positive"]:a>.6?ex()["fidelity-metrics__value--neutral"]:ex()["fidelity-metrics__value--warning"];case"standardDeviations":case"trackingErrors":return a<10?ex()["fidelity-metrics__value--positive"]:a<20?ex()["fidelity-metrics__value--neutral"]:ex()["fidelity-metrics__value--warning"];default:return ex()["fidelity-metrics__value--neutral"]}};return(0,r.jsxs)("div",{className:ex()["fidelity-metrics"],children:[(0,r.jsxs)("div",{className:ex()["fidelity-metrics__header"],children:[(0,r.jsx)("h3",{children:"Advanced Fidelity Metrics"}),(0,r.jsxs)("p",{children:["Comprehensive risk and performance metrics for ",o," funds"]})]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__selector"],children:[(0,r.jsx)("h4",{children:"Select Metric to Analyze"}),(0,r.jsx)("div",{className:ex()["fidelity-metrics__buttons"],children:Object.keys(d).map(e=>{let t=d[e],i=t.icon;return(0,r.jsxs)("button",{onClick:()=>s(e),className:"".concat(ex()["fidelity-metrics__button"]," ").concat(a===e?ex()["fidelity-metrics__button--active"]:""),children:[(0,r.jsx)(i,{size:16}),t.title]},e)})})]}),(()=>{let e=n[a],t=d[a],i=t.icon;return(0,r.jsxs)("div",{className:ex()["fidelity-metrics__overview"],children:[(0,r.jsxs)("div",{className:ex()["fidelity-metrics__overview-header"],children:[(0,r.jsxs)("div",{className:ex()["fidelity-metrics__overview-title"],children:[(0,r.jsx)(i,{size:24}),(0,r.jsx)("h4",{children:t.title})]}),(0,r.jsx)("p",{className:ex()["fidelity-metrics__overview-description"],children:t.description}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__overview-interpretation"],children:[(0,r.jsx)("strong",{children:"Interpretation:"})," ",t.interpretation]})]}),(0,r.jsx)("div",{className:ex()["fidelity-metrics__overview-stats"],children:["1Y","3Y","5Y"].map(i=>{let s=e[i];return s&&0!==s.count?(0,r.jsxs)("div",{className:ex()["fidelity-metrics__stat-card"],children:[(0,r.jsxs)("h5",{children:[i," Period"]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__stat-values"],children:[(0,r.jsxs)("div",{className:ex()["fidelity-metrics__stat-row"],children:[(0,r.jsx)("span",{children:"Average:"}),(0,r.jsxs)("span",{className:"".concat(ex()["fidelity-metrics__stat-value"]," ").concat(getMetricColor(a,s.average)),children:[s.average,t.unit]})]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__stat-row"],children:[(0,r.jsx)("span",{children:"Range:"}),(0,r.jsxs)("span",{className:ex()["fidelity-metrics__stat-range"],children:[s.min,t.unit," to ",s.max,t.unit]})]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__stat-row"],children:[(0,r.jsx)("span",{children:"Funds:"}),(0,r.jsx)("span",{className:ex()["fidelity-metrics__stat-count"],children:s.count})]})]})]},i):null})})]})})(),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__section"],children:[(0,r.jsxs)("h4",{children:[d[a].title," by Fund"]}),(0,r.jsx)("div",{className:ex()["fidelity-metrics__table-container"],children:(0,r.jsxs)("table",{className:ex()["fidelity-metrics__table"],children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Fund Name"}),(0,r.jsx)("th",{children:"1 Year"}),(0,r.jsx)("th",{children:"3 Year"}),(0,r.jsx)("th",{children:"5 Year"})]})}),(0,r.jsx)("tbody",{children:l.map((e,t)=>{let i=e[a];return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:ex()["fidelity-metrics__fund-name"],children:e.name}),(0,r.jsxs)("td",{className:getMetricColor(a,i.oneYear),children:[i.oneYear,d[a].unit]}),(0,r.jsxs)("td",{className:getMetricColor(a,i.threeYear),children:[i.threeYear,d[a].unit]}),(0,r.jsxs)("td",{className:getMetricColor(a,i.fiveYear),children:[i.fiveYear,d[a].unit]})]},t)})})]})})]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__section"],children:[(0,r.jsx)("h4",{children:"Complete Metrics Summary"}),(0,r.jsx)("div",{className:ex()["fidelity-metrics__summary-grid"],children:Object.keys(d).map(e=>{let t=d[e],a=n[e],i=t.icon,s=a["1Y"];return s&&0!==s.count?(0,r.jsxs)("div",{className:ex()["fidelity-metrics__summary-card"],children:[(0,r.jsxs)("div",{className:ex()["fidelity-metrics__summary-header"],children:[(0,r.jsx)(i,{size:20}),(0,r.jsx)("h5",{children:t.title})]}),(0,r.jsxs)("div",{className:ex()["fidelity-metrics__summary-value"],children:[(0,r.jsxs)("span",{className:"".concat(ex()["fidelity-metrics__summary-number"]," ").concat(getMetricColor(e,s.average)),children:[s.average,t.unit]}),(0,r.jsx)("span",{className:ex()["fidelity-metrics__summary-label"],children:"1Y Average"})]}),(0,r.jsx)("div",{className:ex()["fidelity-metrics__summary-info"],children:(0,r.jsxs)("span",{children:[s.count," funds"]})})]},e):null})})]})]})},components_RiskTab=e=>{let{data:t}=e;return(0,r.jsxs)("div",{className:el()["step-analyze__content"],children:[(0,r.jsx)("h3",{children:"Risk Analysis"}),(0,r.jsxs)("div",{className:el()["step-analyze__risk-summary"],children:[(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Risk Level"}),(0,r.jsx)("div",{className:"".concat(el()["step-analyze__metric-value"]," ").concat(el()["step-analyze__risk-".concat(t.riskLevel.toLowerCase())]),children:t.riskLevel})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Risk Score"}),(0,r.jsx)("div",{className:el()["step-analyze__metric-value"],children:t.riskScore})]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__unit-types"],children:[(0,r.jsx)("h4",{children:"Unit Type Distribution"}),(0,r.jsx)("div",{className:el()["step-analyze__distribution"],children:Object.entries(t.unitTypes).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:el()["step-analyze__distribution-item"],children:[(0,r.jsx)("span",{children:t}),(0,r.jsxs)("span",{children:[a," funds"]})]},t)})})]})]})},components_FeesTab=e=>{let{data:t}=e;return(0,r.jsxs)("div",{className:el()["step-analyze__content"],children:[(0,r.jsx)("h3",{children:"Fees & Costs Analysis"}),(0,r.jsxs)("div",{className:el()["step-analyze__fees-summary"],children:[(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Average Fee %"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.avgFeePercentage,"%"]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Highest Fee"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.highestFee,"%"]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Lowest Fee"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.lowestFee,"%"]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Fee Range"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.feeRange,"%"]})]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__fee-breakdown"],children:[(0,r.jsx)("h4",{children:"Fee Breakdown by Fund"}),(0,r.jsxs)("table",{className:el()["step-analyze__table"],children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Fund Name"}),(0,r.jsx)("th",{children:"Annual Charge %"}),(0,r.jsx)("th",{children:"Min Investment"})]})}),(0,r.jsx)("tbody",{children:t.feeBreakdown.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:el()["step-analyze__fund-name"],children:e.name}),(0,r.jsxs)("td",{children:[e.annualCharge,"%"]}),(0,r.jsxs)("td",{children:["\xa3",e.minInvestment.toLocaleString()]})]},t))})]})]})]})},components_DiversificationTab=e=>{let{data:t}=e;return(0,r.jsxs)("div",{className:el()["step-analyze__content"],children:[(0,r.jsx)("h3",{children:"Diversification Analysis"}),(0,r.jsxs)("div",{className:el()["step-analyze__diversification-summary"],children:[(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Diversification Score"}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-value"],children:[t.diversificationScore,"%"]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Diversification Level"}),(0,r.jsx)("div",{className:el()["step-analyze__metric-value"],children:t.diversificationLevel})]}),(0,r.jsxs)("div",{className:el()["step-analyze__metric-card"],children:[(0,r.jsx)("h4",{children:"Total Sectors"}),(0,r.jsx)("div",{className:el()["step-analyze__metric-value"],children:t.totalSectors})]})]}),(0,r.jsxs)("div",{className:el()["step-analyze__distribution-section"],children:[(0,r.jsx)("h4",{children:"Sector Distribution"}),(0,r.jsx)("div",{className:el()["step-analyze__distribution"],children:Object.entries(t.sectorDistribution).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:el()["step-analyze__distribution-item"],children:[(0,r.jsx)("span",{children:t}),(0,r.jsxs)("span",{children:[a," funds"]})]},t)})})]})]})},ef=a(9945),ev=a.n(ef),eg=a(9464),ey=a(8125),ej=a(2085),eb=a(6205);let calculatePearsonCorrelation=(e,t)=>{let a=Math.min(e.length,t.length),r=e.slice(0,a),i=t.slice(0,a);if(0===a)return 0;let s=r.reduce((e,t)=>e+t,0),n=i.reduce((e,t)=>e+t,0),l=r.reduce((e,t,a)=>e+t*i[a],0),o=r.reduce((e,t)=>e+t*t,0),c=i.reduce((e,t)=>e+t*t,0),d=a*l-s*n,m=Math.sqrt((a*o-s*s)*(a*c-n*n));return 0===m?0:d/m},calculateCorrelationMatrix=e=>{let t=e.length,a=Array(t).fill(null).map(()=>Array(t).fill(0)),r=e.map(e=>{let t=e.prices.map(e=>e.price);return t.slice(1).map((e,a)=>(e-t[a])/t[a])});for(let e=0;e<t;e++)for(let i=0;i<t;i++)e===i?a[e][i]=1:a[e][i]=calculatePearsonCorrelation(r[e],r[i]);return a},sortFundsByCorrelation=function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"avgCorrelation";e.length;let i=e.map((e,r)=>{let i=t[r].filter((e,t)=>r!==t).filter(e=>"number"==typeof e&&!isNaN(e)),s=i.reduce((e,t)=>e+t,0),n=i.reduce((e,t)=>e+Math.abs(t),0),l=i.length>0?s/i.length:0,o=i.length>0?n/i.length:0;return{originalIndex:r,avgSignedCorrelation:l,avgAbsoluteCorrelation:o,fund:e,priceData:a[r]}});"avgCorrelation"===r?i.sort((e,t)=>t.avgSignedCorrelation-e.avgSignedCorrelation):i.sort((e,t)=>t.avgAbsoluteCorrelation-e.avgAbsoluteCorrelation);let s=i.map(e=>e.fund),n=i.map(e=>e.priceData),l=i.map(e=>e.originalIndex),o=l.map(e=>l.map(a=>t[e][a])),c=i.map(e=>e.avgSignedCorrelation),d=i.map(e=>e.avgAbsoluteCorrelation);return{matrix:o,funds:s,priceData:n,sortedIndices:l,avgSignedCorrelations:c,avgAbsoluteCorrelations:d}},calculateFullCorrelationData=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"avgCorrelation";if(!e||0===e.length)throw Error("No funds provided for correlation analysis");try{let r=await eb.NV.fetchPriceData(e,t),i=calculateCorrelationMatrix(r),s=sortFundsByCorrelation(e,i,r,a);return{...s,range:t,originalFunds:e,originalMatrix:i,originalPriceData:r}}catch(e){throw console.error("Error in correlation calculation:",e),e}},getCorrelationClass=e=>{let t="correlation-matrix__correlation-value";return 1===e?"".concat(t,"--diagonal"):e>=.8?"".concat(t,"--very-strong-positive"):e>=.6?"".concat(t,"--strong-positive"):e>=.4?"".concat(t,"--moderate-positive"):e>=.2?"".concat(t,"--weak-positive"):e>-.2?"".concat(t,"--very-weak"):e>=-.4?"".concat(t,"--weak-negative"):e>=-.6?"".concat(t,"--moderate-negative"):e>=-.8?"".concat(t,"--strong-negative"):"".concat(t,"--very-strong-negative")};var eN=a(1299),eS=a.n(eN),CorrelationMatrix=e=>{var t,a;let{data:i,correlationData:s,loading:n,error:l,selectedRange:o,sortMethod:c,validRanges:m}=e,getCurrentAvgCorrelation=e=>s?"avgCorrelation"===c?s.avgSignedCorrelations?s.avgSignedCorrelations[e]:0:s.avgAbsoluteCorrelations?s.avgAbsoluteCorrelations[e]:0:0;return(null==i?void 0:i.funds)&&0!==i.funds.length?(0,r.jsxs)("div",{className:eS()["correlation-matrix__container"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__header"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__header-top"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__header-title-section"],children:[(0,r.jsx)(_.Z,{className:eS()["correlation-matrix__header-icon"]}),(0,r.jsx)("h3",{className:eS()["correlation-matrix__header-title"],children:"Correlation Matrix (Sorted)"})]}),s&&(0,r.jsxs)("button",{onClick:()=>{if(!s)return;let e="avgCorrelation"===c?s.avgSignedCorrelations:s.avgAbsoluteCorrelations,t=[["Fund","avgCorrelation"===c?"Avg Signed Correlation":"Avg Absolute Correlation","Sort Method","Time Range",...s.funds.map(e=>e.fund_name)],...s.funds.map((t,a)=>{var r;return[t.fund_name,e?e[a].toFixed(3):"N/A","avgCorrelation"===c?"Signed Average":"Absolute Average",(null===(r=m.find(e=>e.value===o))||void 0===r?void 0:r.label)||o,...s.matrix[a].map(e=>e.toFixed(3))]})].map(e=>e.join(",")).join("\n"),a=new Blob([t],{type:"text/csv"}),r=window.URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download="correlation-matrix-".concat(c,"-").concat(o,".csv"),i.click(),window.URL.revokeObjectURL(r)},className:eS()["correlation-matrix__export-button"],children:[(0,r.jsx)(eg.Z,{}),(0,r.jsx)("span",{children:"Export CSV"})]})]}),(0,r.jsx)("p",{className:eS()["correlation-matrix__header-description"],children:"Funds are sorted by their average correlation with other funds. Choose between signed values (preserving positive/negative) or absolute values (correlation strength only)."})]}),n&&(0,r.jsxs)("div",{className:eS()["correlation-matrix__loading"],children:[(0,r.jsx)(ey.Z,{className:eS()["correlation-matrix__loading-spinner"]}),(0,r.jsx)("h3",{className:eS()["correlation-matrix__loading-title"],children:"Calculating Correlations"}),(0,r.jsxs)("p",{className:eS()["correlation-matrix__loading-description"],children:["Fetching price data for ",o," range and computing correlation matrix..."]})]}),l&&(0,r.jsx)("div",{className:eS()["correlation-matrix__error"],children:(0,r.jsxs)("div",{className:eS()["correlation-matrix__error-content"],children:[(0,r.jsx)(ej.Z,{className:eS()["correlation-matrix__error-icon"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:eS()["correlation-matrix__error-title"],children:"Error Loading Data"}),(0,r.jsx)("p",{className:eS()["correlation-matrix__error-message"],children:l})]})]})}),s&&!n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__sorting-info"],children:(0,r.jsxs)("div",{className:eS()["correlation-matrix__sorting-info-content"],children:[(0,r.jsx)("strong",{children:"Current Sort:"})," ","avgCorrelation"===c?"Signed":"Absolute"," average correlation over ",null===(t=m.find(e=>e.value===o))||void 0===t?void 0:t.label.toLowerCase()," period.","avgCorrelation"===c?" Funds with high positive correlations appear first, then negative correlations.":" Funds with strongest correlations (regardless of direction) appear first."]})}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__matrix-card"],children:[(0,r.jsxs)("h4",{className:eS()["correlation-matrix__matrix-title"],children:["Correlation Matrix (",null===(a=m.find(e=>e.value===o))||void 0===a?void 0:a.label,") - Sorted by ","avgCorrelation"===c?"Signed":"Absolute"," Average"]}),(0,r.jsx)("div",{className:eS()["correlation-matrix__matrix-container"],children:(0,r.jsxs)("table",{className:eS()["correlation-matrix__matrix-table"],children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"".concat(eS()["correlation-matrix__matrix-header-cell"]," ").concat(eS()["correlation-matrix__matrix-header-cell--corner"]),children:"Fund Name"}),(0,r.jsx)("th",{className:"".concat(eS()["correlation-matrix__matrix-header-cell"]," ").concat(eS()["correlation-matrix__matrix-header-cell--avg"]),children:"Avg Corr"}),s.funds.map((e,t)=>(0,r.jsx)("th",{className:"".concat(eS()["correlation-matrix__matrix-header-cell"]," ").concat(eS()["correlation-matrix__matrix-header-cell--fund"]),children:(0,r.jsx)("div",{className:eS()["correlation-matrix__matrix-header-text"],children:e.fund_name.length>12?e.fund_name.substring(0,12)+"...":e.fund_name})},t))]})}),(0,r.jsx)("tbody",{children:s.funds.map((e,t)=>(0,r.jsxs)("tr",{className:eS()["correlation-matrix__matrix-row"],children:[(0,r.jsx)("td",{className:eS()["correlation-matrix__matrix-row-header"],children:(0,r.jsxs)("div",{className:eS()["correlation-matrix__fund-info"],children:[(0,r.jsx)("span",{className:eS()["correlation-matrix__fund-name"],children:e.fund_name}),(0,r.jsxs)("span",{className:eS()["correlation-matrix__fund-rank"],children:["#",t+1]})]})}),(0,r.jsx)("td",{className:eS()["correlation-matrix__matrix-avg-cell"],children:(0,r.jsx)("div",{className:eS()["correlation-matrix__avg-correlation"],children:getCurrentAvgCorrelation(t).toFixed(3)})}),s.matrix[t].map((e,t)=>(0,r.jsx)("td",{className:eS()["correlation-matrix__matrix-cell"],children:(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__correlation-value"]," ").concat(eS()[getCorrelationClass(e)]),title:"Correlation: ".concat(e.toFixed(3)),children:e.toFixed(2)})},t))]},t))})]})})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__ranking"],children:[(0,r.jsxs)("h4",{className:eS()["correlation-matrix__ranking-title"],children:["Fund Correlation Ranking (","avgCorrelation"===c?"Signed":"Absolute"," Average)"]}),(0,r.jsx)("div",{className:eS()["correlation-matrix__ranking-grid"],children:s.funds.map((e,t)=>{let a=getCurrentAvgCorrelation(t),i=a<0,s=Math.abs(a);return(0,r.jsxs)("div",{className:eS()["correlation-matrix__ranking-item"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__ranking-position"],children:["#",t+1]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__ranking-details"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__ranking-fund-name"],children:e.fund_name}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__ranking-correlation"],children:["Avg Correlation: ",a.toFixed(3),"avgCorrelation"===c&&i&&" (Negative)"]})]}),(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__ranking-badge"]," ").concat(s>.7?eS()["correlation-matrix__ranking-badge--high"]:s>.4?eS()["correlation-matrix__ranking-badge--medium"]:eS()["correlation-matrix__ranking-badge--low"]),children:s>.7?"High ".concat("avgCorrelation"===c&&i?"Negative ":"","Correlation"):s>.4?"Medium ".concat("avgCorrelation"===c&&i?"Negative ":"","Correlation"):"Low ".concat("avgCorrelation"===c&&i?"Negative ":"","Correlation")})]},t)})})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend"],children:[(0,r.jsx)("h4",{className:eS()["correlation-matrix__legend-title"],children:"Interpretation Guide"}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-grid"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-section"],children:[(0,r.jsx)("h5",{children:"Correlation Strength"}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-items"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--very-strong-positive"])}),(0,r.jsx)("span",{children:"Very Strong Positive (≥0.8)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--strong-positive"])}),(0,r.jsx)("span",{children:"Strong Positive (0.6-0.8)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--moderate-positive"])}),(0,r.jsx)("span",{children:"Moderate Positive (0.4-0.6)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--weak-positive"])}),(0,r.jsx)("span",{children:"Weak Positive (0.2-0.4)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--very-weak"]," ").concat(eS()["correlation-matrix__legend-color--border"])}),(0,r.jsx)("span",{children:"Very Weak (0-0.2)"})]})]})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-section"],children:[(0,r.jsx)("h5",{children:"Negative Correlations"}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-items"],children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--very-strong-negative"])}),(0,r.jsx)("span",{children:"Very Strong Negative (≤-0.8)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--strong-negative"])}),(0,r.jsx)("span",{children:"Strong Negative (-0.6 to -0.8)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--moderate-negative"])}),(0,r.jsx)("span",{children:"Moderate Negative (-0.4 to -0.6)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__legend-item"],children:[(0,r.jsx)("div",{className:"".concat(eS()["correlation-matrix__legend-color"]," ").concat(eS()["correlation-matrix__correlation-value--weak-negative"])}),(0,r.jsx)("span",{children:"Weak Negative (-0.2 to -0.4)"})]})]})]})]}),(0,r.jsx)("div",{className:eS()["correlation-matrix__legend-tip"],children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Diversification Tip:"}),"avgCorrelation"===c?" Funds with low or negative average correlations provide better diversification. Highly positively correlated funds (>0.7) may provide less diversification benefit.":" Funds with lower absolute average correlations (at the bottom) provide better diversification benefits regardless of correlation direction."]})})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary"],children:[(0,r.jsxs)("h4",{className:eS()["correlation-matrix__summary-title"],children:["Correlation Summary (",o,")"]}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-grid"],children:(()=>{let e=s.matrix.flatMap((e,t)=>e.slice(t+1).map(e=>e)),t=e.reduce((e,t)=>e+t,0)/e.length,a=e.reduce((e,t)=>e+Math.abs(t),0)/e.length,i=e.filter(e=>Math.abs(e)>.7).length,n=e.filter(e=>e<0).length;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:t.toFixed(3)}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Average Correlation (Signed)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:a.toFixed(3)}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Average Correlation (Absolute)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:Math.max(...e).toFixed(3)}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Highest Correlation"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:Math.min(...e).toFixed(3)}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Lowest Correlation"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:i}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Strong Correlation Pairs (|r|>0.7)"})]}),(0,r.jsxs)("div",{className:eS()["correlation-matrix__summary-stat"],children:[(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-value"],children:n}),(0,r.jsx)("div",{className:eS()["correlation-matrix__summary-stat-label"],children:"Negative Correlation Pairs"})]})]})})()})]})]})]}):(0,r.jsxs)("div",{className:eS()["correlation-matrix__empty"],children:[(0,r.jsx)(d.Z,{className:eS()["correlation-matrix__empty-icon"]}),(0,r.jsx)("h3",{className:eS()["correlation-matrix__empty-title"],children:"No Fund Data Available"}),(0,r.jsx)("p",{className:eS()["correlation-matrix__empty-description"],children:"Select funds with Yahoo symbols to calculate correlations."})]})},eC=a(6386),components_ChordDiagram=e=>{var t;let{correlationData:a,selectedRange:s,sortMethod:n,onHover:l,onMouseLeave:o}=e,c=(0,i.useRef)(),d=(0,i.useRef)(null),[m,_]=(0,i.useState)({width:600,height:600}),[h,u]=(0,i.useState)(null),[p,x]=(0,i.useState)(.3),[f,v]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let handleResize=()=>{var e;let t=null===(e=c.current)||void 0===e?void 0:e.parentElement;if(t){let e=t.clientWidth,a=Math.min(e-40,600);_({width:a,height:a})}};return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),(0,i.useEffect)(()=>{a&&a.matrix&&c.current&&drawChordDiagram()},[a,m,p,h,f]),(0,i.useEffect)(()=>()=>{d.current&&(d.current.remove(),d.current=null)},[]);let createTooltip=()=>(d.current&&d.current.remove(),d.current=eC.Ys("body").append("div").attr("class","chord-tooltip").style("position","absolute").style("background","rgba(0, 0, 0, 0.9)").style("color","white").style("padding","10px").style("border-radius","6px").style("font-size","12px").style("line-height","1.4").style("pointer-events","none").style("z-index","10000").style("box-shadow","0 4px 12px rgba(0,0,0,0.3)").style("opacity","0"),d.current),hideTooltip=()=>{d.current&&d.current.transition().duration(200).style("opacity","0").on("end",()=>{d.current&&(d.current.remove(),d.current=null)})},showTooltip=(e,t)=>{let a=createTooltip();a.html(e).style("left",t.pageX+15+"px").style("top",t.pageY-10+"px").transition().duration(200).style("opacity","1")},updateTooltipPosition=e=>{d.current&&d.current.style("left",e.pageX+15+"px").style("top",e.pageY-10+"px")},drawChordDiagram=()=>{let e;if(!(null==a?void 0:a.matrix)||!(null==a?void 0:a.funds)){console.warn("Invalid correlation data provided to ChordDiagram");return}let t=eC.Ys(c.current);t.selectAll("*").remove();let{width:r,height:i}=m,s=Math.min(r,i)/2-60,d=s-30,_=t.attr("width",r).attr("height",i).append("g").attr("transform","translate(".concat(r/2,", ").concat(i/2,")"));if(!Array.isArray(a.matrix)||0===a.matrix.length){_.append("text").attr("text-anchor","middle").attr("dy","0em").style("font-size","16px").style("fill","#666").text("Invalid correlation matrix data");return}let x=a.matrix.map((e,t)=>Array.isArray(e)?e.map((e,a)=>{if(f&&t===a)return 0;let r=Math.abs(e||0);return r>=p?r:0}):(console.warn("Invalid row in correlation matrix:",e),Array(a.funds.length).fill(0))),v=a.funds,g=v.length;if(0===g||x.length!==g){_.append("text").attr("text-anchor","middle").attr("dy","0em").style("font-size","16px").style("fill","#666").text("Insufficient correlation data");return}let y=eC.fFo().padAngle(.05).sortSubgroups(eC.$1i);try{e=y(x)}catch(e){console.error("Error creating chord layout:",e),_.append("text").attr("text-anchor","middle").attr("dy","0em").style("font-size","16px").style("fill","#666").text("Error processing correlation data");return}let j=eC.PKp().domain(eC.w6H(g)).range(eC.Cn1.concat(eC.UCG)),b=eC.Nb1().innerRadius(d).outerRadius(s),N=eC.N22().radius(d),S=_.append("g").selectAll("g").data(e.groups).enter().append("g").attr("class","group");S.append("path").style("fill",e=>j(e.index)).style("stroke",e=>eC.B8C(j(e.index)).darker()).style("stroke-width",1).style("opacity",e=>null===h||h===e.index?.8:.3).attr("d",b).on("mouseover",(e,t)=>{if(u(t.index),l&&v[t.index]){var r,i;l({fund:v[t.index],index:t.index,avgCorrelation:"avgCorrelation"===n?null===(r=a.avgSignedCorrelations)||void 0===r?void 0:r[t.index]:null===(i=a.avgAbsoluteCorrelations)||void 0===i?void 0:i[t.index]})}}).on("mouseout",()=>{u(null),o&&o()}),S.append("text").each(e=>{e.angle=(e.startAngle+e.endAngle)/2}).attr("dy",".35em").attr("transform",e=>"\n        rotate(".concat(180*e.angle/Math.PI-90,")\n        translate(").concat(s+10,")\n        ").concat(e.angle>Math.PI?"rotate(180)":"","\n      ")).style("text-anchor",e=>e.angle>Math.PI?"end":null).style("font-size","10px").style("font-weight",e=>h===e.index?"bold":"normal").style("fill",e=>null===h||h===e.index?"#333":"#999").text(e=>{let t=v[e.index];if(!t||!t.fund_name)return"Fund ".concat(e.index+1);let a=t.fund_name;return a.length>15?a.substring(0,15)+"...":a}),_.append("g").selectAll("path").data(e.filter(e=>!f||e.source.index!==e.target.index)).enter().append("path").attr("class","ribbon").attr("d",N).style("fill",e=>{var t;let r=(null===(t=a.matrix[e.source.index])||void 0===t?void 0:t[e.target.index])||0;return r>0?eC.bc$(Math.abs(r)):eC.sY$(Math.abs(r))}).style("stroke",e=>{var t;let r=(null===(t=a.matrix[e.source.index])||void 0===t?void 0:t[e.target.index])||0;return r>0?"#d32f2f":"#1976d2"}).style("stroke-width",.5).style("opacity",e=>null===h?.6:h===e.source.index||h===e.target.index?.8:.1).on("mouseover",(e,t)=>{var r;let i=(null===(r=a.matrix[t.source.index])||void 0===r?void 0:r[t.target.index])||0,s=v[t.source.index],n=v[t.target.index],l='\n          <div style="margin-bottom: 6px;"><strong>'.concat((null==s?void 0:s.fund_name)||"Fund ".concat(t.source.index+1),'</strong></div>\n          <div style="margin-bottom: 6px;"><strong>').concat((null==n?void 0:n.fund_name)||"Fund ".concat(t.target.index+1),'</strong></div>\n          <div style="margin-bottom: 4px;">Correlation: <strong>').concat(i.toFixed(3),"</strong></div>\n          <div>Strength: <strong>").concat(getCorrelationStrength(Math.abs(i)),"</strong></div>\n          ").concat(t.source.index===t.target.index?'<div style="margin-top: 4px; color: #ffa726;">Self-correlation</div>':"","\n        ");showTooltip(l,e)}).on("mousemove",e=>{updateTooltipPosition(e)}).on("mouseout",()=>{hideTooltip()}),_.append("text").attr("text-anchor","middle").attr("dy","-0.5em").style("font-size","14px").style("font-weight","bold").style("fill","#666").text("Fund Correlations"),_.append("text").attr("text-anchor","middle").attr("dy","1em").style("font-size","12px").style("fill","#888").text("Threshold: ≥".concat(p))},getCorrelationStrength=e=>e>=.8?"Very Strong":e>=.6?"Strong":e>=.4?"Moderate":e>=.2?"Weak":"Very Weak";if(!a||!a.matrix||!a.funds)return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"400px",color:"#666",fontSize:"16px",flexDirection:"column",gap:"10px"},children:[(0,r.jsx)("div",{children:"No correlation data available"}),(0,r.jsx)("div",{style:{fontSize:"14px",color:"#999"},children:"Please ensure funds are selected and correlation analysis is complete."})]});if(!Array.isArray(a.matrix)||!Array.isArray(a.funds))return(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"400px",color:"#666",fontSize:"16px"},children:"Invalid correlation data format"});let g=(()=>{if(!(null==a?void 0:a.matrix)||!Array.isArray(a.matrix))return 0;try{return a.matrix.flatMap((e,t)=>Array.isArray(e)?e.slice(t+1).filter(e=>"number"==typeof e&&Math.abs(e)>=p):[]).length}catch(e){return console.warn("Error calculating visible connections:",e),0}})(),y=(()=>{if(!(null==a?void 0:a.matrix)||!Array.isArray(a.matrix))return 0;try{let e=a.matrix.flatMap((e,t)=>Array.isArray(e)?e.slice(t+1).filter(e=>"number"==typeof e):[]);if(0===e.length)return 0;return e.reduce((e,t)=>e+t,0)/e.length}catch(e){return console.warn("Error calculating average correlation:",e),0}})();return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,r.jsxs)("div",{style:{marginBottom:"20px",display:"flex",alignItems:"center",gap:"15px",flexWrap:"wrap",justifyContent:"center"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("label",{style:{fontSize:"14px",fontWeight:"500"},children:"Correlation Threshold:"}),(0,r.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:p,onChange:e=>{x(parseFloat(e.target.value))},style:{width:"100px"}}),(0,r.jsx)("span",{style:{fontSize:"12px",color:"#666",minWidth:"30px"},children:p.toFixed(1)})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("input",{type:"checkbox",id:"hideSelfCorrelation",checked:f,onChange:e=>{v(e.target.checked)},style:{cursor:"pointer"}}),(0,r.jsx)("label",{htmlFor:"hideSelfCorrelation",style:{fontSize:"14px",fontWeight:"500",cursor:"pointer",userSelect:"none"},children:"Hide Self-Correlations"})]}),(0,r.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:["Range: ",s||"N/A"," | Sort: ","avgCorrelation"===n?"Signed":"Absolute"]})]}),(0,r.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,r.jsx)("svg",{ref:c})}),(0,r.jsxs)("div",{style:{marginTop:"20px",display:"flex",gap:"30px",flexWrap:"wrap",justifyContent:"center",fontSize:"12px"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("div",{style:{width:"20px",height:"4px",background:"linear-gradient(to right, #fee5d9, #de2d26)",borderRadius:"2px"}}),(0,r.jsx)("span",{children:"Positive Correlation"})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)("div",{style:{width:"20px",height:"4px",background:"linear-gradient(to right, #deebf7, #3182bd)",borderRadius:"2px"}}),(0,r.jsx)("span",{children:"Negative Correlation"})]}),(0,r.jsx)("div",{style:{color:"#666"},children:"Hover over segments and connections for details"})]}),(0,r.jsxs)("div",{style:{marginTop:"15px",display:"flex",gap:"20px",flexWrap:"wrap",justifyContent:"center",fontSize:"11px",color:"#666"},children:[(0,r.jsxs)("div",{children:["Funds: ",(null===(t=a.funds)||void 0===t?void 0:t.length)||0]}),(0,r.jsxs)("div",{children:["Visible Connections: ",g]}),(0,r.jsxs)("div",{children:["Avg Correlation: ",y.toFixed(3)]}),(0,r.jsxs)("div",{children:["Self-Correlations: ",f?"Hidden":"Shown"]})]})]})},components_CorrelationTab=e=>{var t,a,s,n;let{data:l}=e,[o,c]=(0,i.useState)("matrix"),[d,m]=(0,i.useState)("1y"),[_,h]=(0,i.useState)("avgCorrelation"),[u,p]=(0,i.useState)(null),[x,f]=(0,i.useState)(null),[v,g]=(0,i.useState)(!1),[y,j]=(0,i.useState)(null),b=[{value:"1mo",label:"1 Month"},{value:"3mo",label:"3 Months"},{value:"6mo",label:"6 Months"},{value:"ytd",label:"Year to Date"},{value:"1y",label:"1 Year"},{value:"2y",label:"2 Years"},{value:"5y",label:"5 Years"},{value:"10y",label:"10 Years"},{value:"max",label:"Maximum"}];(0,i.useEffect)(()=>{l&&l.funds&&fetchCorrelationData()},[d,l]),(0,i.useEffect)(()=>{if(x){let e=sortFundsByCorrelation(x.originalFunds,x.originalMatrix,x.originalPriceData,_);f({...x,...e,range:d})}},[_]);let fetchCorrelationData=async()=>{if((null==l?void 0:l.funds)&&0!==l.funds.length){g(!0),j(null);try{let e=await calculateFullCorrelationData(l.funds,d,_);f(e)}catch(e){j(e.message)}finally{g(!1)}}},handleRangeChange=e=>{m(e)},handleSortChange=e=>{h(e)};return l?(0,r.jsxs)("div",{className:ev()["correlation-enhanced-tab"],children:[(0,r.jsxs)("div",{className:ev()["correlation-header"],children:[(0,r.jsxs)("div",{className:ev()["correlation-title-section"],children:[(0,r.jsx)("h3",{children:"Correlation Analysis"}),(0,r.jsx)("p",{children:"Explore relationships between your selected funds using different visualization methods."})]}),(0,r.jsx)("div",{className:ev()["correlation-controls"],children:(0,r.jsxs)("div",{className:ev()["view-toggle"],children:[(0,r.jsx)("button",{className:"".concat(ev()["toggle-btn"]," ").concat("matrix"===o?ev().active:""),onClick:()=>c("matrix"),children:"Matrix View"}),(0,r.jsx)("button",{className:"".concat(ev()["toggle-btn"]," ").concat("chord"===o?ev().active:""),onClick:()=>c("chord"),children:"Chord Diagram"})]})})]}),(0,r.jsxs)("div",{className:ev()["correlation-shared-controls"],children:[(0,r.jsxs)("div",{className:ev()["correlation-sort-selector"],children:[(0,r.jsx)("label",{children:"Sort Method:"}),(0,r.jsxs)("div",{className:ev()["correlation-sort-buttons"],children:[(0,r.jsx)("button",{onClick:()=>handleSortChange("avgCorrelation"),className:"".concat(ev()["correlation-sort-button"]," ").concat("avgCorrelation"===_?ev()["correlation-sort-button--active"]:ev()["correlation-sort-button--inactive"]),children:"Signed Average (with +/-)"}),(0,r.jsx)("button",{onClick:()=>handleSortChange("avgAbsCorrelation"),className:"".concat(ev()["correlation-sort-button"]," ").concat("avgAbsCorrelation"===_?ev()["correlation-sort-button--active"]:ev()["correlation-sort-button--inactive"]),children:"Absolute Average (strength only)"})]})]}),(0,r.jsxs)("div",{className:ev()["correlation-range-selector"],children:[(0,r.jsx)("label",{children:"Time Range:"}),(0,r.jsx)("div",{className:ev()["correlation-range-buttons"],children:b.map(e=>(0,r.jsx)("button",{onClick:()=>handleRangeChange(e.value),className:"".concat(ev()["correlation-range-button"]," ").concat(d===e.value?ev()["correlation-range-button--active"]:ev()["correlation-range-button--inactive"]),children:e.label},e.value))})]})]}),(0,r.jsx)("div",{className:ev()["correlation-content"],children:"matrix"===o?(0,r.jsx)("div",{className:ev()["matrix-container"],children:(0,r.jsx)(CorrelationMatrix,{data:l,correlationData:x,loading:v,error:y,selectedRange:d,sortMethod:_,validRanges:b})}):(0,r.jsx)("div",{className:ev()["chord-container"],children:(0,r.jsx)(components_ChordDiagram,{data:l,correlationData:x,loading:v,error:y,selectedRange:d,sortMethod:_,validRanges:b,onHover:e=>{p(e)},onMouseLeave:()=>{p(null)}})})}),u&&(0,r.jsx)("div",{className:ev()["fund-details-panel"],children:(0,r.jsxs)("div",{className:ev()["fund-details-content"],children:[(0,r.jsx)("h4",{children:(null===(t=u.fund)||void 0===t?void 0:t.fund_name)||"Fund Details"}),(0,r.jsxs)("div",{className:ev()["fund-stats"],children:[(0,r.jsxs)("div",{className:ev()["stat-item"],children:[(0,r.jsx)("span",{className:ev()["stat-label"],children:"Average Correlation:"}),(0,r.jsx)("span",{className:ev()["stat-value"],children:(null===(a=u.avgCorrelation)||void 0===a?void 0:a.toFixed(3))||"N/A"})]}),(null===(s=u.fund)||void 0===s?void 0:s.category)&&(0,r.jsxs)("div",{className:ev()["stat-item"],children:[(0,r.jsx)("span",{className:ev()["stat-label"],children:"Category:"}),(0,r.jsx)("span",{className:ev()["stat-value"],children:u.fund.category})]}),(null===(n=u.fund)||void 0===n?void 0:n.expense_ratio)&&(0,r.jsxs)("div",{className:ev()["stat-item"],children:[(0,r.jsx)("span",{className:ev()["stat-label"],children:"Expense Ratio:"}),(0,r.jsxs)("span",{className:ev()["stat-value"],children:[u.fund.expense_ratio,"%"]})]})]})]})})]}):null},components_RecommendationsTab=e=>{let{data:t}=e;return(0,r.jsxs)("div",{className:el()["step-analyze__content"],children:[(0,r.jsx)("h3",{children:"Recommendations"}),(0,r.jsx)("div",{className:el()["step-analyze__recommendations"],children:t.map((e,t)=>(0,r.jsxs)("div",{className:"".concat(el()["step-analyze__recommendation"]," ").concat(el()["step-analyze__recommendation--".concat(e.type)]),children:[(0,r.jsx)("h4",{children:e.title}),(0,r.jsx)("p",{children:e.message})]},t))})]})};let calculateOverview=e=>{let t=e.length,a=e.reduce((e,t)=>e+(t.annual_charge||0),0)/t,r=e.reduce((e,t)=>e+(t.lump_sum_min_inv||0),0),i=[...new Set(e.map(e=>e.sector_name).filter(Boolean))];return{totalFunds:t,avgAnnualCharge:a.toFixed(2),totalMinInvestment:r,sectors:i.length,sectorList:i}},calculatePerformance=e=>{let t={};["perf3m","perf6m","perf12m","perf36m","perf60m","perf120m","perf0t12m","perf12t24m","perf24t36m","perf36t48m","perf48t60m"].forEach(a=>{let r=e.map(e=>e[a]).filter(e=>null!=e&&!isNaN(e));t[a]={average:r.length>0?(r.reduce((e,t)=>e+t,0)/r.length).toFixed(2):"N/A",min:r.length>0?Math.min(...r).toFixed(2):"N/A",max:r.length>0?Math.max(...r).toFixed(2):"N/A",count:r.length}});let a=e.map(e=>{var t,a,r,i,s,n,l,o,c,d,m;return{name:e.fund_name,perf3m:(null===(t=e.perf3m)||void 0===t?void 0:t.toFixed(2))||"N/A",perf6m:(null===(a=e.perf6m)||void 0===a?void 0:a.toFixed(2))||"N/A",perf12m:(null===(r=e.perf12m)||void 0===r?void 0:r.toFixed(2))||"N/A",perf36m:(null===(i=e.perf36m)||void 0===i?void 0:i.toFixed(2))||"N/A",perf60m:(null===(s=e.perf60m)||void 0===s?void 0:s.toFixed(2))||"N/A",perf120m:(null===(n=e.perf120m)||void 0===n?void 0:n.toFixed(2))||"N/A",perf0t12m:(null===(l=e.perf0t12m)||void 0===l?void 0:l.toFixed(2))||"N/A",perf12t24m:(null===(o=e.perf12t24m)||void 0===o?void 0:o.toFixed(2))||"N/A",perf24t36m:(null===(c=e.perf24t36m)||void 0===c?void 0:c.toFixed(2))||"N/A",perf36t48m:(null===(d=e.perf36t48m)||void 0===d?void 0:d.toFixed(2))||"N/A",perf48t60m:(null===(m=e.perf48t60m)||void 0===m?void 0:m.toFixed(2))||"N/A"}});return{performanceData:t,performanceByFund:a,totalFunds:e.length}},calculateFidelityMetrics=e=>{let t={alphas:["fidelity_alphas_oneYear","fidelity_alphas_threeYear","fidelity_alphas_fiveYear"],betas:["fidelity_betas_oneYear","fidelity_betas_threeYear","fidelity_betas_fiveYear"],informationRatios:["fidelity_informationRatios_oneYear","fidelity_informationRatios_threeYear","fidelity_informationRatios_fiveYear"],rSquareds:["fidelity_rSquareds_oneYear","fidelity_rSquareds_threeYear","fidelity_rSquareds_fiveYear"],sharpeRatios:["fidelity_sharpeRatios_oneYear","fidelity_sharpeRatios_threeYear","fidelity_sharpeRatios_fiveYear"],standardDeviations:["fidelity_standardDeviations_oneYear","fidelity_standardDeviations_threeYear","fidelity_standardDeviations_fiveYear"],trackingErrors:["fidelity_trackingErrors_oneYear","fidelity_trackingErrors_threeYear","fidelity_trackingErrors_fiveYear"]},a={};Object.keys(t).forEach(r=>{a[r]={},t[r].forEach(t=>{let i=e.map(e=>e[t]).filter(e=>null!=e&&!isNaN(e)),s=t.includes("oneYear")?"1Y":t.includes("threeYear")?"3Y":"5Y";a[r][s]={average:i.length>0?(i.reduce((e,t)=>e+t,0)/i.length).toFixed(3):"N/A",min:i.length>0?Math.min(...i).toFixed(3):"N/A",max:i.length>0?Math.max(...i).toFixed(3):"N/A",count:i.length}})});let r=e.map(e=>{var t,a,r,i,s,n,l,o,c,d,m,_,h,u,p,x,f,v,g,y,j;return{name:e.fund_name,alphas:{oneYear:(null===(t=e.fidelity_alphas_oneYear)||void 0===t?void 0:t.toFixed(3))||"N/A",threeYear:(null===(a=e.fidelity_alphas_threeYear)||void 0===a?void 0:a.toFixed(3))||"N/A",fiveYear:(null===(r=e.fidelity_alphas_fiveYear)||void 0===r?void 0:r.toFixed(3))||"N/A"},betas:{oneYear:(null===(i=e.fidelity_betas_oneYear)||void 0===i?void 0:i.toFixed(3))||"N/A",threeYear:(null===(s=e.fidelity_betas_threeYear)||void 0===s?void 0:s.toFixed(3))||"N/A",fiveYear:(null===(n=e.fidelity_betas_fiveYear)||void 0===n?void 0:n.toFixed(3))||"N/A"},informationRatios:{oneYear:(null===(l=e.fidelity_informationRatios_oneYear)||void 0===l?void 0:l.toFixed(3))||"N/A",threeYear:(null===(o=e.fidelity_informationRatios_threeYear)||void 0===o?void 0:o.toFixed(3))||"N/A",fiveYear:(null===(c=e.fidelity_informationRatios_fiveYear)||void 0===c?void 0:c.toFixed(3))||"N/A"},rSquareds:{oneYear:(null===(d=e.fidelity_rSquareds_oneYear)||void 0===d?void 0:d.toFixed(3))||"N/A",threeYear:(null===(m=e.fidelity_rSquareds_threeYear)||void 0===m?void 0:m.toFixed(3))||"N/A",fiveYear:(null===(_=e.fidelity_rSquareds_fiveYear)||void 0===_?void 0:_.toFixed(3))||"N/A"},sharpeRatios:{oneYear:(null===(h=e.fidelity_sharpeRatios_oneYear)||void 0===h?void 0:h.toFixed(3))||"N/A",threeYear:(null===(u=e.fidelity_sharpeRatios_threeYear)||void 0===u?void 0:u.toFixed(3))||"N/A",fiveYear:(null===(p=e.fidelity_sharpeRatios_fiveYear)||void 0===p?void 0:p.toFixed(3))||"N/A"},standardDeviations:{oneYear:(null===(x=e.fidelity_standardDeviations_oneYear)||void 0===x?void 0:x.toFixed(3))||"N/A",threeYear:(null===(f=e.fidelity_standardDeviations_threeYear)||void 0===f?void 0:f.toFixed(3))||"N/A",fiveYear:(null===(v=e.fidelity_standardDeviations_fiveYear)||void 0===v?void 0:v.toFixed(3))||"N/A"},trackingErrors:{oneYear:(null===(g=e.fidelity_trackingErrors_oneYear)||void 0===g?void 0:g.toFixed(3))||"N/A",threeYear:(null===(y=e.fidelity_trackingErrors_threeYear)||void 0===y?void 0:y.toFixed(3))||"N/A",fiveYear:(null===(j=e.fidelity_trackingErrors_fiveYear)||void 0===j?void 0:j.toFixed(3))||"N/A"}}});return{metricsData:a,metricsByFund:r,totalFunds:e.length}},calculateRisk=e=>{let t=e.reduce((e,t)=>{let a=t.unit_type||"Unknown";return e[a]=(e[a]||0)+1,e},{}),a=e.map(e=>e.fidelity_standardDeviations_oneYear).filter(e=>null!=e&&!isNaN(e)),r=a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0,i=e.map(e=>e.fidelity_betas_oneYear).filter(e=>null!=e&&!isNaN(e)),s=i.length>0?i.reduce((e,t)=>e+t,0)/i.length:1;return{unitTypes:t,avgStandardDeviation:r.toFixed(2),avgBeta:s.toFixed(3),riskLevel:r<10?"Low":r<20?"Medium":"High",volatilityIndicators:e.map(e=>{var t,a;return{name:e.fund_name,standardDeviation:(null===(t=e.fidelity_standardDeviations_oneYear)||void 0===t?void 0:t.toFixed(2))||"N/A",beta:(null===(a=e.fidelity_betas_oneYear)||void 0===a?void 0:a.toFixed(3))||"N/A",unitType:e.unit_type||"N/A"}})}},calculateFees=e=>{let t=e.reduce((e,t)=>e+(t.annual_charge||0),0)/e.length,a=e.map(e=>({name:e.fund_name,annualCharge:e.annual_charge||0,minInvestment:e.lump_sum_min_inv||0})),r=Math.max(...e.map(e=>e.annual_charge||0)),i=Math.min(...e.map(e=>e.annual_charge||0).filter(e=>e>0));return{avgFeePercentage:t.toFixed(2),highestFee:r.toFixed(2),lowestFee:i.toFixed(2),feeBreakdown:a,feeRange:(r-i).toFixed(2)}},calculateDiversification=e=>{let t=e.reduce((e,t)=>{let a=t.sector_name||"Unknown";return e[a]=(e[a]||0)+1,e},{}),a=e.reduce((e,t)=>{let a=t.payment_type||"Unknown";return e[a]=(e[a]||0)+1,e},{}),r=Object.keys(t).length/e.length;return{sectorDistribution:t,paymentTypes:a,diversificationScore:(100*r).toFixed(1),diversificationLevel:r>.7?"Excellent":r>.5?"Good":r>.3?"Fair":"Poor",totalSectors:Object.keys(t).length}},calculateCorrelation=e=>{let t=e.filter(e=>e.yahoo_symbol);return{funds:t,totalFunds:e.length,fundsWithSymbols:t.length,validRanges:["1mo","3mo","6mo","ytd","1y","2y","5y","10y","max"]}},generateRecommendations=e=>{var t,a,r;let i=[],s={overview:calculateOverview(e),performance:calculatePerformance(e),fidelityMetrics:calculateFidelityMetrics(e),risk:calculateRisk(e),fees:calculateFees(e),diversification:calculateDiversification(e)};parseFloat(s.fees.avgFeePercentage)>1.5&&i.push({type:"warning",title:"High Fees Detected",message:"Your average annual fee of ".concat(s.fees.avgFeePercentage,"% is above the recommended 1.5%. Consider reviewing funds with lower fees.")});let n=parseFloat((null===(t=s.performance.performanceData.perf12m)||void 0===t?void 0:t.average)||0);n<0&&i.push({type:"warning",title:"Negative 12-Month Performance",message:"Your portfolio shows negative average 12-month performance. Consider reviewing underperforming funds."});let l=parseFloat((null===(r=s.fidelityMetrics.metricsData.sharpeRatios)||void 0===r?void 0:null===(a=r["1Y"])||void 0===a?void 0:a.average)||0);l<.5&&i.push({type:"warning",title:"Low Risk-Adjusted Returns",message:"Your portfolio has low Sharpe ratios, indicating poor risk-adjusted returns. Consider funds with better risk-return profiles."});let o=parseFloat(s.risk.avgBeta);o>1.3&&i.push({type:"warning",title:"High Market Sensitivity",message:"Your portfolio has a high beta of ".concat(s.risk.avgBeta,", making it more sensitive to market movements. Consider adding defensive funds.")}),s.diversification.totalSectors<3&&i.push({type:"warning",title:"Limited Diversification",message:"Consider adding funds from different sectors to improve diversification and reduce risk."});let c=calculateCorrelation(e);return c.fundsWithSymbols<c.totalFunds&&i.push({type:"info",title:"Limited Correlation Analysis",message:"Only ".concat(c.fundsWithSymbols," of ").concat(c.totalFunds," funds have Yahoo symbols for correlation analysis. Consider funds with better data availability.")}),s.diversification.totalSectors>=5&&i.push({type:"success",title:"Excellent Diversification",message:"Your portfolio shows good sector diversification, which helps manage risk."}),1>parseFloat(s.fees.avgFeePercentage)&&i.push({type:"success",title:"Low-Cost Portfolio",message:"Your average fees are below 1%, which will help maximize long-term returns."}),l>1&&i.push({type:"success",title:"Strong Risk-Adjusted Performance",message:"Your portfolio shows excellent risk-adjusted returns based on Sharpe ratios."}),n>10&&i.push({type:"success",title:"Strong 12-Month Performance",message:"Your portfolio shows strong 12-month average performance of ".concat(n,"%.")}),i};var components_StepAnalyze=e=>{let{onNext:t,onPrev:a}=e,[s,n]=(0,i.useState)("overview"),[l,o]=(0,i.useState)(null),[m,h]=(0,i.useState)(!0),{funds:u}=(0,f.W)(),{basket:p}=useBasket(),v=u.filter(e=>p.some(t=>t===e.sedol));(0,i.useEffect)(()=>{p.length>0&&performAnalysis()},[p]);let performAnalysis=async()=>{h(!0);let e={overview:calculateOverview(v),performance:calculatePerformance(v),fidelityMetrics:calculateFidelityMetrics(v),risk:calculateRisk(v),fees:calculateFees(v),diversification:calculateDiversification(v),correlation:calculateCorrelation(v),recommendations:generateRecommendations(v)};o(e),h(!1)},g=[{id:"overview",label:"Overview",icon:S.Z},{id:"performance",label:"Performance",icon:_.Z},{id:"fidelityMetrics",label:"Advanced Metrics",icon:ea.Z},{id:"risk",label:"Risk Analysis",icon:er.Z},{id:"fees",label:"Fees & Costs",icon:ei.Z},{id:"diversification",label:"Diversification",icon:es.Z},{id:"correlation",label:"Correlation Analysis",icon:d.Z},{id:"recommendations",label:"Recommendations",icon:c.Z}];return 0===p.length?(0,r.jsx)("div",{className:el()["step-analyze__card"],children:(0,r.jsxs)("div",{className:el()["step-analyze__empty"],children:[(0,r.jsx)("h2",{children:"No Funds Selected"}),(0,r.jsx)("p",{children:"Please go back to Step 1 and select some funds to analyze."}),(0,r.jsxs)("button",{onClick:a,className:el()["step-analyze__back-button"],children:[(0,r.jsx)(q.Z,{size:16}),"Back to Fund Selection"]})]})}):(0,r.jsxs)("div",{className:el()["step-analyze"],children:[(0,r.jsx)("div",{className:el()["step-analyze__header"],children:(0,r.jsxs)("div",{className:el()["step-analyze__header-content"],children:[(0,r.jsx)("h2",{className:el()["step-analyze__title"],children:"Step 2: Portfolio Analysis"}),(0,r.jsx)("p",{className:el()["step-analyze__description"],children:"Analyze your selected funds across multiple dimensions to understand your portfolio's characteristics."})]})}),(0,r.jsxs)("div",{className:el()["step-analyze__layout"],children:[(0,r.jsx)("div",{className:el()["step-analyze__sidebar"],children:(0,r.jsx)("nav",{className:el()["step-analyze__tabs"],children:g.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>n(e.id),className:"".concat(el()["step-analyze__tab"]," ").concat(s===e.id?el()["step-analyze__tab--active"]:""),children:[(0,r.jsx)(t,{size:16}),(0,r.jsx)("span",{children:e.label})]},e.id)})})}),(0,r.jsx)("div",{className:el()["step-analyze__main"],children:(()=>{if(m)return(0,r.jsxs)("div",{className:el()["step-analyze__loading"],children:[(0,r.jsx)("div",{className:el()["step-analyze__spinner"]}),(0,r.jsx)("h3",{children:"Analyzing Your Portfolio..."}),(0,r.jsx)("p",{children:"Please wait while we crunch the numbers."})]});if(!l)return null;switch(s){case"overview":return(0,r.jsx)(components_OverviewTab,{data:l.overview});case"performance":return(0,r.jsx)(components_PerformanceTab,{data:l.performance});case"fidelityMetrics":return(0,r.jsx)(components_FidelityMetricsTab,{data:l.fidelityMetrics});case"risk":return(0,r.jsx)(components_RiskTab,{data:l.risk});case"fees":return(0,r.jsx)(components_FeesTab,{data:l.fees});case"diversification":return(0,r.jsx)(components_DiversificationTab,{data:l.diversification});case"correlation":return(0,r.jsx)(components_CorrelationTab,{data:l.correlation});case"recommendations":return(0,r.jsx)(components_RecommendationsTab,{data:l.recommendations});default:return null}})()})]}),(0,r.jsxs)("div",{className:el()["step-analyze__action-buttons"],children:[(0,r.jsxs)("button",{onClick:a,className:el()["step-analyze__back-button"],children:[(0,r.jsx)(q.Z,{size:16}),"Back to Fund Selection"]}),(0,r.jsxs)("button",{onClick:t,className:el()["step-analyze__continue-button"],children:["Continue to Optimization ",(0,r.jsx)(x.Z,{size:16})]})]})]})},ek=a(4318),eF=a(3855),ez=a.n(eF),eM=class{calculateReturns(){let e={};return this.priceData.forEach(t=>{let a=t.prices.map(e=>e.price),r=[];for(let e=1;e<a.length;e++)a[e]>0&&a[e-1]>0&&r.push(Math.log(a[e]/a[e-1]));e[t.symbol]=r}),e}calculateCorrelationMatrix(){let e=Object.keys(this.returns),t=e.length,a=Array(t).fill().map(()=>Array(t).fill(0));for(let r=0;r<t;r++)for(let i=0;i<t;i++)r===i?a[r][i]=1:a[r][i]=this.calculateCorrelation(this.returns[e[r]],this.returns[e[i]]);return{symbols:e,matrix:a}}calculateCovarianceMatrix(){let e=Object.keys(this.returns),t=e.length,a=Array(t).fill().map(()=>Array(t).fill(0));for(let r=0;r<t;r++)for(let i=0;i<t;i++)a[r][i]=this.calculateCovariance(this.returns[e[r]],this.returns[e[i]]);return{symbols:e,matrix:a}}calculateDistanceMatrix(){let e=this.correlationMatrix.matrix.length,t=Array(e).fill().map(()=>Array(e).fill(0));for(let a=0;a<e;a++)for(let r=0;r<e;r++)if(a===r)t[a][r]=0;else{let e=Math.max(-.9999,Math.min(.9999,this.correlationMatrix.matrix[a][r]));t[a][r]=Math.sqrt(.5*(1-e))}return t}calculateCorrelation(e,t){let a=Math.min(e.length,t.length),r=e.slice(-a),i=t.slice(-a);if(a<2)return 0;let s=r.reduce((e,t)=>e+t,0)/a,n=i.reduce((e,t)=>e+t,0)/a,l=0,o=0,c=0;for(let e=0;e<a;e++){let t=r[e]-s,a=i[e]-n;l+=t*a,o+=t*t,c+=a*a}let d=Math.sqrt(o*c);return 0===d?0:Math.max(-.9999,Math.min(.9999,l/d))}calculateCovariance(e,t){let a=Math.min(e.length,t.length),r=e.slice(-a),i=t.slice(-a);if(a<2)return 0;let s=r.reduce((e,t)=>e+t,0)/a,n=i.reduce((e,t)=>e+t,0)/a,l=0;for(let e=0;e<a;e++)l+=(r[e]-s)*(i[e]-n);return l/(a-1)}performClustering(){let e=this.distanceMatrix.length,t=[];for(let a=0;a<e;a++)t.push({id:a,items:[a],height:0,left:null,right:null,isLeaf:!0});let a=[],r=e;for(;t.length>1;){let e=1/0,i=-1,s=-1;for(let a=0;a<t.length;a++)for(let r=a+1;r<t.length;r++){let n=this.getSingleLinkageDistance(t[a],t[r]);n<e&&(e=n,i=a,s=r)}let n=t[i],l=t[s],o={id:r++,items:[...n.items,...l.items],height:e,left:n,right:l,isLeaf:!1};a.push([n.id,l.id,e,o.items.length]),t.splice(Math.max(i,s),1),t.splice(Math.min(i,s),1),t.push(o)}return{tree:t[0],linkageMatrix:a}}getSingleLinkageDistance(e,t){let a=1/0;for(let r of e.items)for(let e of t.items)a=Math.min(a,this.distanceMatrix[r][e]);return a}getQuasiDiagonalOrder(e){let t=[],traverseTree=e=>{e.isLeaf?t.push(e.id):(e.left&&traverseTree(e.left),e.right&&traverseTree(e.right))};return traverseTree(e),t}calculateHRPWeights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"single",t=this.performClusteringWithMethod(e),a=this.getQuasiDiagonalOrder(t.tree),r=Array(a.length).fill(1);this.recursiveBisection(t.tree,r,a);let i={},s=this.correlationMatrix.symbols;for(let e=0;e<a.length;e++){let t=a[e],n=s[t],l=a.indexOf(t);i[n]=r[l]}return i}recursiveBisection(e,t,a){if(e.isLeaf)return;let r=this.getTreeItems(e.left),i=this.getTreeItems(e.right),s=r.map(e=>a.indexOf(e)),n=i.map(e=>a.indexOf(e)),l=this.getClusterVariance(r),o=this.getClusterVariance(i),c=l+o,d=c>0?1-l/c:.5;s.forEach(e=>{t[e]*=d}),n.forEach(e=>{t[e]*=1-d}),this.recursiveBisection(e.left,t,a),this.recursiveBisection(e.right,t,a)}getTreeItems(e){if(e.isLeaf)return[e.id];let t=[];return e.left&&t.push(...this.getTreeItems(e.left)),e.right&&t.push(...this.getTreeItems(e.right)),t}getClusterVariance(e){if(1===e.length){let t=e[0];return Math.max(this.covarianceMatrix.matrix[t][t],1e-8)}let t=e.length,a=Array(t).fill().map(()=>Array(t).fill(0));for(let r=0;r<t;r++)for(let i=0;i<t;i++)a[r][i]=this.covarianceMatrix.matrix[e[r]][e[i]];let r=Array(t),i=0;for(let e=0;e<t;e++){let t=Math.max(a[e][e],1e-8);r[e]=1/t,i+=r[e]}if(i>0)for(let e=0;e<t;e++)r[e]/=i;else for(let e=0;e<t;e++)r[e]=1/t;let s=0;for(let e=0;e<t;e++)for(let i=0;i<t;i++)s+=r[e]*r[i]*a[e][i];return Math.max(s,1e-8)}calculatePortfolioMetrics(e){let t=Object.keys(e),a=t.map(t=>e[t]),r=0;t.forEach(t=>{let a=this.returns[t],i=a.reduce((e,t)=>e+t,0)/a.length;r+=e[t]*i*252});let i=0,s={};this.covarianceMatrix.symbols.forEach((e,t)=>{s[e]=t}),t.forEach(a=>{t.forEach(t=>{let r=s[a],n=s[t];void 0!==r&&void 0!==n&&(i+=e[a]*e[t]*this.covarianceMatrix.matrix[r][n]*252)})});let n=Math.sqrt(Math.max(i,0)),l=n>0?(r-.02)/n:0,o=a.reduce((e,t)=>e+t*t,0),c=[...a].sort((e,t)=>t-e),d=c.slice(0,Math.min(5,c.length)).reduce((e,t)=>e+t,0);return{expectedReturn:100*r,volatility:100*n,sharpeRatio:l,maxWeight:100*Math.max(...a),effectiveAssets:o>0?1/o:0,concentrationRatio:100*d}}calculateRiskContribution(e){let t=Object.keys(e),a={},r=this.calculatePortfolioMetrics(e),i=r.volatility/100;if(0===i)return t.forEach(e=>{a[e]={absolute:0,relative:100/t.length}}),a;let s={};return this.covarianceMatrix.symbols.forEach((e,t)=>{s[e]=t}),t.forEach(r=>{let n=0;t.forEach(t=>{let a=s[r],i=s[t];void 0!==a&&void 0!==i&&(n+=e[t]*this.covarianceMatrix.matrix[a][i]*252)});let l=Math.pow(i,2),o=l>0?e[r]*n/l*i*100:0;a[r]={absolute:o,relative:i>0?o/(100*i)*100:0}}),a}calculateHRPWeightsWithMethod(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"single",t=this.performClusteringWithMethod(e),a=this.getQuasiDiagonalOrder(t.tree),r=Array(a.length).fill(1);this.recursiveBisection(t.tree,r,a);let i={},s=this.correlationMatrix.symbols;for(let e=0;e<a.length;e++){let t=a[e],n=s[t],l=a.indexOf(t);i[n]=r[l]}return i}performClusteringWithMethod(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"single",t=this.distanceMatrix.length,a=[];for(let e=0;e<t;e++)a.push({id:e,items:[e],height:0,left:null,right:null,isLeaf:!0});let r=[],i=t;for(;a.length>1;){let t=1/0,s=-1,n=-1;for(let r=0;r<a.length;r++)for(let i=r+1;i<a.length;i++){let l;switch(e){case"single":default:l=this.getSingleLinkageDistance(a[r],a[i]);break;case"complete":l=this.getCompleteLinkageDistance(a[r],a[i]);break;case"average":l=this.getAverageLinkageDistance(a[r],a[i]);break;case"ward":l=this.getWardLinkageDistance(a[r],a[i])}l<t&&(t=l,s=r,n=i)}if(-1===s||-1===n)throw Error("No valid clusters to merge. This usually means a bug in the clustering logic or all distances are infinite/NaN.");let l=a[s],o=a[n],c={id:i++,items:[...l.items,...o.items],height:t,left:l,right:o,isLeaf:!1};r.push([l.id,o.id,t,c.items.length]),a.splice(Math.max(s,n),1),a.splice(Math.min(s,n),1),a.push(c)}return{tree:a[0],linkageMatrix:r}}getCompleteLinkageDistance(e,t){let a=-1/0;for(let r of e.items)for(let e of t.items)a=Math.max(a,this.distanceMatrix[r][e]);return a}getAverageLinkageDistance(e,t){let a=0,r=0;for(let i of e.items)for(let e of t.items)a+=this.distanceMatrix[i][e],r++;return r>0?a/r:0}getWardLinkageDistance(e,t){let a=e.items.length,r=t.items.length;if(0===a||0===r)return 1/0;let i=this.calculateClusterCentroid(e.items),s=this.calculateClusterCentroid(t.items);if(!i||!s)return 1/0;let n=0,l=Math.min(i.length,s.length);for(let e=0;e<l;e++){let t=i[e]-s[e];n+=t*t}if(!isFinite(n))return 1/0;let o=Math.sqrt(n),c=Math.sqrt(a*r/(a+r))*o;return isFinite(c)&&c>=0?c:1/0}calculateClusterCentroid(e){if(0===e.length)return null;let t=this.correlationMatrix.symbols,a=e.map(e=>{let a=t[e];return this.returns[a]||[]}),r=Math.min(...a.map(e=>e.length));if(0===r)return null;let i=Array(r).fill(0);for(let e=0;e<r;e++){let t=0,r=0;for(let i of a)e<i.length&&isFinite(i[e])&&(t+=i[e],r++);i[e]=r>0?t/r:0}return i}getWardLinkageDistanceSimple(e,t){let a=e.items.length,r=t.items.length;if(0===a||0===r)return 1/0;let i=this.getAverageLinkageDistance(e,t);if(!isFinite(i))return 1/0;let s=Math.sqrt(2*a*r/(a+r))*i;return isFinite(s)&&s>=0?s:1/0}constructor(e){this.priceData=e,this.returns=this.calculateReturns(),this.correlationMatrix=this.calculateCorrelationMatrix(),this.covarianceMatrix=this.calculateCovarianceMatrix(),this.distanceMatrix=this.calculateDistanceMatrix()}},components_StepOptimize=e=>{let{onNext:t,onPrev:a}=e,[s,n]=(0,i.useState)("optimization"),[l,o]=(0,i.useState)(null),[m,h]=(0,i.useState)(!1),[u,p]=(0,i.useState)("1y"),[v,g]=(0,i.useState)("ward"),[y,j]=(0,i.useState)(null),{basket:b}=useBasket(),{funds:N}=(0,f.W)(),S=(0,i.useCallback)(async()=>{h(!0),j(null),console.log("Performing optimization with basket:",b,"for range:",u,"using clustering method:",v);try{let e=N.filter(e=>b.some(t=>t===e.sedol)),t=await eb.NV.fetchPriceData(e,u),a=new eM(t),r=a.calculateHRPWeights(v),i=a.calculatePortfolioMetrics(r),s=a.calculateRiskContribution(r),n={};e.forEach(t=>{n[t.yahoo_symbol]=1/e.length});let l=a.calculatePortfolioMetrics(n),c=a.calculateRiskContribution(n);o({hrp:{weights:r,metrics:i,riskContributions:s},equalWeight:{weights:n,metrics:l,riskContributions:c},correlationMatrix:a.correlationMatrix,covarianceMatrix:a.covarianceMatrix,priceData:t,range:u,clusteringMethod:v})}catch(e){j(e.message),console.error("Optimization error:",e)}finally{h(!1)}},[b,N,u,v]);(0,i.useEffect)(()=>{b.length>0&&S()},[b,u,v,S]);let C=[{id:"optimization",label:"Enhanced HRP",icon:c.Z},{id:"comparison",label:"Portfolio Comparison",icon:d.Z},{id:"risk",label:"Risk Analysis",icon:er.Z},{id:"correlation",label:"Correlation Matrix",icon:ea.Z},{id:"allocation",label:"Asset Allocation",icon:es.Z}],renderOptimizationTab=()=>{if(!l)return null;let{hrp:e,equalWeight:t}=l;return(0,r.jsxs)("div",{className:ez()["optimization-tab"],children:[(0,r.jsxs)("div",{className:ez()["optimization-header"],children:[(0,r.jsx)("h3",{children:"Enhanced Hierarchical Risk Parity Results"}),(0,r.jsxs)("p",{children:["Advanced portfolio optimization using ",v," clustering and risk parity principles."]})]}),(0,r.jsx)("div",{className:ez()["optimization-controls"],children:(0,r.jsxs)("div",{className:ez()["method-selector"],children:[(0,r.jsx)("label",{htmlFor:"clustering-method",children:"Clustering Method:"}),(0,r.jsxs)("select",{id:"clustering-method",value:v,onChange:e=>g(e.target.value),className:ez()["method-select"],children:[(0,r.jsx)("option",{value:"ward",children:"Ward's Method"}),(0,r.jsx)("option",{value:"single",children:"Single Linkage"}),(0,r.jsx)("option",{value:"complete",children:"Complete Linkage"}),(0,r.jsx)("option",{value:"average",children:"Average Linkage"})]})]})}),(0,r.jsxs)("div",{className:ez()["metrics-grid"],children:[(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(_.Z,{size:20}),(0,r.jsx)("h4",{children:"Expected Return"})]}),(0,r.jsxs)("div",{className:ez()["metric-value"],children:[e.metrics.expectedReturn.toFixed(2),"%"]}),(0,r.jsxs)("div",{className:ez()["metric-comparison"],children:["Equal Weight: ",t.metrics.expectedReturn.toFixed(2),"%"]})]}),(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(er.Z,{size:20}),(0,r.jsx)("h4",{children:"Volatility"})]}),(0,r.jsxs)("div",{className:ez()["metric-value"],children:[e.metrics.volatility.toFixed(2),"%"]}),(0,r.jsxs)("div",{className:ez()["metric-comparison"],children:["Equal Weight: ",t.metrics.volatility.toFixed(2),"%"]})]}),(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(ei.Z,{size:20}),(0,r.jsx)("h4",{children:"Sharpe Ratio"})]}),(0,r.jsx)("div",{className:ez()["metric-value"],children:e.metrics.sharpeRatio.toFixed(3)}),(0,r.jsxs)("div",{className:ez()["metric-comparison"],children:["Equal Weight: ",t.metrics.sharpeRatio.toFixed(3)]})]}),(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(c.Z,{size:20}),(0,r.jsx)("h4",{children:"Risk Reduction"})]}),(0,r.jsxs)("div",{className:ez()["metric-value"],children:[((t.metrics.volatility-e.metrics.volatility)/t.metrics.volatility*100).toFixed(1),"%"]}),(0,r.jsx)("div",{className:ez()["metric-comparison"],children:"vs Equal Weight"})]}),(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(es.Z,{size:20}),(0,r.jsx)("h4",{children:"Max Weight"})]}),(0,r.jsxs)("div",{className:ez()["metric-value"],children:[e.metrics.maxWeight.toFixed(1),"%"]}),(0,r.jsxs)("div",{className:ez()["metric-comparison"],children:["Effective Assets: ",e.metrics.effectiveAssets.toFixed(1)]})]}),(0,r.jsxs)("div",{className:ez()["metric-card"],children:[(0,r.jsxs)("div",{className:ez()["metric-header"],children:[(0,r.jsx)(d.Z,{size:20}),(0,r.jsx)("h4",{children:"Concentration"})]}),(0,r.jsxs)("div",{className:ez()["metric-value"],children:[e.metrics.concentrationRatio.toFixed(1),"%"]}),(0,r.jsx)("div",{className:ez()["metric-comparison"],children:"Top 5 Holdings"})]})]}),(0,r.jsxs)("div",{className:ez()["weights-section"],children:[(0,r.jsx)("h4",{children:"Optimized Asset Allocation"}),(0,r.jsx)("div",{className:ez()["weights-list"],children:Object.entries(e.weights).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).map(e=>{let[t,a]=e,i=N.find(e=>e.yahoo_symbol===t);return(0,r.jsxs)("div",{className:ez()["weight-item"],children:[(0,r.jsxs)("div",{className:ez()["weight-info"],children:[(0,r.jsx)("span",{className:ez()["weight-name"],children:(null==i?void 0:i.fund_name)||t}),(0,r.jsx)("span",{className:ez()["weight-symbol"],children:t})]}),(0,r.jsxs)("div",{className:ez()["weight-value"],children:[(100*a).toFixed(1),"%"]}),(0,r.jsx)("div",{className:ez()["weight-bar"],children:(0,r.jsx)("div",{className:ez()["weight-fill"],style:{width:"".concat(100*a,"%")}})})]},t)})})]})]})},renderComparisonTab=()=>{if(!l)return null;let{hrp:e,equalWeight:t}=l;return(0,r.jsxs)("div",{className:ez()["comparison-tab"],children:[(0,r.jsxs)("div",{className:ez()["comparison-header"],children:[(0,r.jsx)("h3",{children:"Portfolio Performance Comparison"}),(0,r.jsxs)("p",{children:["Enhanced HRP optimization vs equal weight allocation using ",v," clustering."]})]}),(0,r.jsx)("div",{className:ez()["comparison-table"],children:(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Metric"}),(0,r.jsx)("th",{children:"Enhanced HRP"}),(0,r.jsx)("th",{children:"Equal Weight"}),(0,r.jsx)("th",{children:"Improvement"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Expected Return"}),(0,r.jsxs)("td",{children:[e.metrics.expectedReturn.toFixed(2),"%"]}),(0,r.jsxs)("td",{children:[t.metrics.expectedReturn.toFixed(2),"%"]}),(0,r.jsxs)("td",{className:e.metrics.expectedReturn>t.metrics.expectedReturn?ez().positive:ez().negative,children:[(e.metrics.expectedReturn-t.metrics.expectedReturn).toFixed(2),"%"]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Volatility"}),(0,r.jsxs)("td",{children:[e.metrics.volatility.toFixed(2),"%"]}),(0,r.jsxs)("td",{children:[t.metrics.volatility.toFixed(2),"%"]}),(0,r.jsxs)("td",{className:e.metrics.volatility<t.metrics.volatility?ez().positive:ez().negative,children:[(e.metrics.volatility-t.metrics.volatility).toFixed(2),"%"]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Sharpe Ratio"}),(0,r.jsx)("td",{children:e.metrics.sharpeRatio.toFixed(3)}),(0,r.jsx)("td",{children:t.metrics.sharpeRatio.toFixed(3)}),(0,r.jsx)("td",{className:e.metrics.sharpeRatio>t.metrics.sharpeRatio?ez().positive:ez().negative,children:(e.metrics.sharpeRatio-t.metrics.sharpeRatio).toFixed(3)})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Max Weight"}),(0,r.jsxs)("td",{children:[e.metrics.maxWeight.toFixed(1),"%"]}),(0,r.jsxs)("td",{children:[t.metrics.maxWeight.toFixed(1),"%"]}),(0,r.jsxs)("td",{className:e.metrics.maxWeight<t.metrics.maxWeight?ez().positive:ez().negative,children:[(e.metrics.maxWeight-t.metrics.maxWeight).toFixed(1),"%"]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Effective Assets"}),(0,r.jsx)("td",{children:e.metrics.effectiveAssets.toFixed(1)}),(0,r.jsx)("td",{children:t.metrics.effectiveAssets.toFixed(1)}),(0,r.jsx)("td",{className:e.metrics.effectiveAssets>t.metrics.effectiveAssets?ez().positive:ez().negative,children:(e.metrics.effectiveAssets-t.metrics.effectiveAssets).toFixed(1)})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Concentration Ratio"}),(0,r.jsxs)("td",{children:[e.metrics.concentrationRatio.toFixed(1),"%"]}),(0,r.jsxs)("td",{children:[t.metrics.concentrationRatio.toFixed(1),"%"]}),(0,r.jsxs)("td",{className:e.metrics.concentrationRatio<t.metrics.concentrationRatio?ez().positive:ez().negative,children:[(e.metrics.concentrationRatio-t.metrics.concentrationRatio).toFixed(1),"%"]})]})]})]})}),(0,r.jsxs)("div",{className:ez()["allocation-comparison"],children:[(0,r.jsxs)("div",{className:ez()["allocation-column"],children:[(0,r.jsx)("h4",{children:"Enhanced HRP Allocation"}),(0,r.jsx)("div",{className:ez()["allocation-chart"],children:Object.entries(e.weights).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).map(e=>{var t;let[a,i]=e,s=N.find(e=>e.yahoo_symbol===a);return(0,r.jsxs)("div",{className:ez()["allocation-bar"],children:[(0,r.jsx)("span",{className:ez()["allocation-label"],children:(null==s?void 0:null===(t=s.fund_name)||void 0===t?void 0:t.substring(0,20))||a}),(0,r.jsxs)("div",{className:ez()["allocation-visual"],children:[(0,r.jsx)("div",{className:ez()["allocation-fill"],style:{width:"".concat(100*i,"%")}}),(0,r.jsxs)("span",{className:ez()["allocation-percent"],children:[(100*i).toFixed(1),"%"]})]})]},a)})})]}),(0,r.jsxs)("div",{className:ez()["allocation-column"],children:[(0,r.jsx)("h4",{children:"Equal Weight Allocation"}),(0,r.jsx)("div",{className:ez()["allocation-chart"],children:Object.entries(t.weights).map(e=>{var t;let[a,i]=e,s=N.find(e=>e.yahoo_symbol===a);return(0,r.jsxs)("div",{className:ez()["allocation-bar"],children:[(0,r.jsx)("span",{className:ez()["allocation-label"],children:(null==s?void 0:null===(t=s.fund_name)||void 0===t?void 0:t.substring(0,20))||a}),(0,r.jsxs)("div",{className:ez()["allocation-visual"],children:[(0,r.jsx)("div",{className:ez()["allocation-fill"],style:{width:"".concat(100*i,"%")}}),(0,r.jsxs)("span",{className:ez()["allocation-percent"],children:[(100*i).toFixed(1),"%"]})]})]},a)})})]})]})]})},renderRiskTab=()=>{if(!l)return null;let{hrp:e,equalWeight:t}=l;return(0,r.jsxs)("div",{className:ez()["risk-tab"],children:[(0,r.jsxs)("div",{className:ez()["risk-header"],children:[(0,r.jsx)("h3",{children:"Risk Decomposition Analysis"}),(0,r.jsx)("p",{children:"Detailed analysis of risk contributions by asset in both portfolio strategies."})]}),(0,r.jsxs)("div",{className:ez()["risk-comparison"],children:[(0,r.jsxs)("div",{className:ez()["risk-column"],children:[(0,r.jsx)("h4",{children:"Enhanced HRP Risk Contributions"}),(0,r.jsx)("div",{className:ez()["risk-contributions"],children:Object.entries(e.riskContributions).sort((e,t)=>{let[,a]=e,[,r]=t;return r.absolute-a.absolute}).map(t=>{var a;let[i,s]=t,n=N.find(e=>e.yahoo_symbol===i),l=100*e.weights[i];return(0,r.jsxs)("div",{className:ez()["risk-item"],children:[(0,r.jsxs)("div",{className:ez()["risk-info"],children:[(0,r.jsx)("span",{className:ez()["risk-name"],children:(null==n?void 0:null===(a=n.fund_name)||void 0===a?void 0:a.substring(0,20))||i}),(0,r.jsxs)("span",{className:ez()["risk-details"],children:["Weight: ",l.toFixed(1),"%"]})]}),(0,r.jsxs)("div",{className:ez()["risk-metrics"],children:[(0,r.jsxs)("div",{className:ez()["risk-absolute"],children:["Risk: ",s.absolute.toFixed(2),"%"]}),(0,r.jsxs)("div",{className:ez()["risk-relative"],children:["Relative: ",s.relative.toFixed(1),"%"]})]}),(0,r.jsx)("div",{className:ez()["risk-bar"],children:(0,r.jsx)("div",{className:ez()["risk-fill"],style:{width:"".concat(s.relative,"%")}})})]},i)})})]}),(0,r.jsxs)("div",{className:ez()["risk-column"],children:[(0,r.jsx)("h4",{children:"Equal Weight Risk Contributions"}),(0,r.jsx)("div",{className:ez()["risk-contributions"],children:Object.entries(t.riskContributions).sort((e,t)=>{let[,a]=e,[,r]=t;return r.absolute-a.absolute}).map(e=>{var a;let[i,s]=e,n=N.find(e=>e.yahoo_symbol===i),l=100*t.weights[i];return(0,r.jsxs)("div",{className:ez()["risk-item"],children:[(0,r.jsxs)("div",{className:ez()["risk-info"],children:[(0,r.jsx)("span",{className:ez()["risk-name"],children:(null==n?void 0:null===(a=n.fund_name)||void 0===a?void 0:a.substring(0,20))||i}),(0,r.jsxs)("span",{className:ez()["risk-details"],children:["Weight: ",l.toFixed(1),"%"]})]}),(0,r.jsxs)("div",{className:ez()["risk-metrics"],children:[(0,r.jsxs)("div",{className:ez()["risk-absolute"],children:["Risk: ",s.absolute.toFixed(2),"%"]}),(0,r.jsxs)("div",{className:ez()["risk-relative"],children:["Relative: ",s.relative.toFixed(1),"%"]})]}),(0,r.jsx)("div",{className:ez()["risk-bar"],children:(0,r.jsx)("div",{className:ez()["risk-fill"],style:{width:"".concat(s.relative,"%")}})})]},i)})})]})]}),(0,r.jsxs)("div",{className:ez()["risk-insights"],children:[(0,r.jsx)("h4",{children:"Risk Analysis Insights"}),(0,r.jsxs)("div",{className:ez()["insights-grid"],children:[(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Enhanced HRP Risk Efficiency"}),(0,r.jsxs)("p",{children:["The Enhanced HRP portfolio achieves ",((t.metrics.volatility-e.metrics.volatility)/t.metrics.volatility*100).toFixed(1),"% risk reduction compared to equal weighting through superior diversification and risk balancing."]})]}),(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Concentration Analysis"}),(0,r.jsxs)("p",{children:["Maximum single asset weight is ",e.metrics.maxWeight.toFixed(1),"% with ",e.metrics.effectiveAssets.toFixed(1),"effective assets providing robust diversification across the portfolio."]})]}),(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Risk Parity Achievement"}),(0,r.jsx)("p",{children:"The Enhanced HRP optimization successfully balances risk contributions more evenly across assets compared to naive equal weighting, resulting in improved risk-adjusted returns."})]})]})]})]})},renderCorrelationTab=()=>{if(!l)return null;let{correlationMatrix:e}=l;return(0,r.jsxs)("div",{className:ez()["correlation-tab"],children:[(0,r.jsxs)("div",{className:ez()["correlation-header"],children:[(0,r.jsx)("h3",{children:"Asset Correlation Matrix"}),(0,r.jsxs)("p",{children:["Correlation relationships used in Enhanced HRP optimization with ",v," clustering method."]})]}),(0,r.jsx)("div",{className:ez()["correlation-matrix"],children:(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{}),e.symbols.map(e=>(0,r.jsx)("th",{className:ez()["correlation-symbol"],children:e},e))]})}),(0,r.jsx)("tbody",{children:e.matrix.map((t,a)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:ez()["correlation-symbol"],children:e.symbols[a]}),t.map((e,t)=>(0,r.jsx)("td",{className:ez()["correlation-cell"],style:{backgroundColor:"rgba(".concat(e>0?"34, 197, 94":"239, 68, 68",", ").concat(.5*Math.abs(e),")")},children:e.toFixed(3)},t))]},a))})]})}),(0,r.jsxs)("div",{className:ez()["correlation-insights"],children:[(0,r.jsx)("h4",{children:"Correlation Insights"}),(0,r.jsxs)("div",{className:ez()["insights-grid"],children:[(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Highest Correlation"}),(0,r.jsx)("p",{children:(()=>{let t=-1,a=["",""];for(let r=0;r<e.matrix.length;r++)for(let i=r+1;i<e.matrix[r].length;i++)e.matrix[r][i]>t&&(t=e.matrix[r][i],a=[e.symbols[r],e.symbols[i]]);return"".concat(a[0]," & ").concat(a[1],": ").concat(t.toFixed(3))})()})]}),(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Lowest Correlation"}),(0,r.jsx)("p",{children:(()=>{let t=1,a=["",""];for(let r=0;r<e.matrix.length;r++)for(let i=r+1;i<e.matrix[r].length;i++)e.matrix[r][i]<t&&(t=e.matrix[r][i],a=[e.symbols[r],e.symbols[i]]);return"".concat(a[0]," & ").concat(a[1],": ").concat(t.toFixed(3))})()})]}),(0,r.jsxs)("div",{className:ez()["insight-card"],children:[(0,r.jsx)("h5",{children:"Portfolio Correlation"}),(0,r.jsx)("p",{children:(()=>{let t=0,a=0;for(let r=0;r<e.matrix.length;r++)for(let i=r+1;i<e.matrix[r].length;i++)t+=e.matrix[r][i],a++;let r=a>0?t/a:0;return"Average correlation: ".concat(r.toFixed(3))})()})]})]})]})]})},renderAllocationTab=()=>{if(!l)return null;let{hrp:e}=l;return(0,r.jsxs)("div",{className:ez()["allocation-tab"],children:[(0,r.jsxs)("div",{className:ez()["allocation-header"],children:[(0,r.jsx)("h3",{children:"Enhanced HRP Asset Allocation"}),(0,r.jsxs)("p",{children:["Comprehensive breakdown of your optimized portfolio allocation using ",v," clustering."]})]}),(0,r.jsxs)("div",{className:ez()["allocation-summary"],children:[(0,r.jsx)("div",{className:ez()["allocation-pie"],children:(0,r.jsx)("div",{className:ez()["pie-chart"],children:Object.entries(e.weights).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).map((e,t)=>{let[a,i]=e,s=["#22c55e","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#ec4899"];return(0,r.jsx)("div",{className:ez()["pie-slice"],style:{"--weight":i,"--color":s[t%s.length]}},a)})})}),(0,r.jsx)("div",{className:ez()["allocation-legend"],children:Object.entries(e.weights).sort((e,t)=>{let[,a]=e,[,r]=t;return r-a}).map((t,a)=>{let[i,s]=t,n=N.find(e=>e.yahoo_symbol===i),l=["#22c55e","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#ec4899"],o=e.riskContributions[i];return(0,r.jsxs)("div",{className:ez()["legend-item"],children:[(0,r.jsx)("div",{className:ez()["legend-color"],style:{backgroundColor:l[a%l.length]}}),(0,r.jsxs)("div",{className:ez()["legend-info"],children:[(0,r.jsx)("span",{className:ez()["legend-name"],children:(null==n?void 0:n.fund_name)||i}),(0,r.jsxs)("div",{className:ez()["legend-details"],children:[(0,r.jsxs)("span",{className:ez()["legend-weight"],children:["Weight: ",(100*s).toFixed(1),"%"]}),o&&(0,r.jsxs)("span",{className:ez()["legend-risk"],children:["Risk: ",o.relative.toFixed(1),"%"]})]})]})]},i)})})]}),(0,r.jsxs)("div",{className:ez()["allocation-stats"],children:[(0,r.jsxs)("div",{className:ez()["stat-card"],children:[(0,r.jsx)("h5",{children:"Portfolio Efficiency"}),(0,r.jsx)("div",{className:ez()["stat-value"],children:e.metrics.sharpeRatio.toFixed(3)}),(0,r.jsx)("div",{className:ez()["stat-label"],children:"Sharpe Ratio"})]}),(0,r.jsxs)("div",{className:ez()["stat-card"],children:[(0,r.jsx)("h5",{children:"Diversification"}),(0,r.jsx)("div",{className:ez()["stat-value"],children:e.metrics.effectiveAssets.toFixed(1)}),(0,r.jsx)("div",{className:ez()["stat-label"],children:"Effective Assets"})]}),(0,r.jsxs)("div",{className:ez()["stat-card"],children:[(0,r.jsx)("h5",{children:"Risk Level"}),(0,r.jsxs)("div",{className:ez()["stat-value"],children:[e.metrics.volatility.toFixed(1),"%"]}),(0,r.jsx)("div",{className:ez()["stat-label"],children:"Annual Volatility"})]}),(0,r.jsxs)("div",{className:ez()["stat-card"],children:[(0,r.jsx)("h5",{children:"Expected Return"}),(0,r.jsxs)("div",{className:ez()["stat-value"],children:[e.metrics.expectedReturn.toFixed(1),"%"]}),(0,r.jsx)("div",{className:ez()["stat-label"],children:"Annual Return"})]})]}),(0,r.jsx)("div",{className:ez()["allocation-actions"],children:(0,r.jsxs)("button",{className:ez()["export-button"],children:[(0,r.jsx)(eg.Z,{size:16}),"Export Allocation"]})})]})};return 0===b.length?(0,r.jsx)("div",{className:ez()["step-optimize__card"],children:(0,r.jsxs)("div",{className:ez()["step-optimize__empty"],children:[(0,r.jsx)("h2",{children:"No Funds Selected"}),(0,r.jsx)("p",{children:"Please go back and select some funds to optimize."}),(0,r.jsxs)("button",{onClick:a,className:ez()["step-optimize__back-button"],children:[(0,r.jsx)(q.Z,{size:16}),"Back to Analysis"]})]})}):(0,r.jsxs)("div",{className:ez()["step-optimize"],children:[(0,r.jsxs)("div",{className:ez()["step-optimize__header"],children:[(0,r.jsxs)("div",{className:ez()["step-optimize__header-content"],children:[(0,r.jsx)("h2",{className:ez()["step-optimize__title"],children:"Step 3: Portfolio Optimization"}),(0,r.jsx)("p",{className:ez()["step-optimize__description"],children:"Advanced portfolio optimization using Hierarchical Risk Parity (HRP) to maximize risk-adjusted returns."})]}),(0,r.jsx)("div",{className:ez()["step-optimize__controls"],children:(0,r.jsxs)("div",{className:ez()["range-selector"],children:[(0,r.jsx)(ek.Z,{size:16}),(0,r.jsx)("label",{htmlFor:"range-select",children:"Time Range:"}),(0,r.jsxs)("select",{id:"range-select",value:u,onChange:e=>p(e.target.value),className:ez()["range-select"],children:[(0,r.jsx)("option",{value:"1mo",children:"1 Month"}),(0,r.jsx)("option",{value:"3mo",children:"3 Months"}),(0,r.jsx)("option",{value:"6mo",children:"6 Months"}),(0,r.jsx)("option",{value:"ytd",children:"Year to Date"}),(0,r.jsx)("option",{value:"1y",children:"1 Year"}),(0,r.jsx)("option",{value:"2y",children:"2 Years"}),(0,r.jsx)("option",{value:"5y",children:"5 Years"}),(0,r.jsx)("option",{value:"10y",children:"10 Years"}),(0,r.jsx)("option",{value:"max",children:"Maximum"})]})]})})]}),(0,r.jsxs)("div",{className:ez()["step-optimize__layout"],children:[(0,r.jsx)("div",{className:ez()["step-optimize__sidebar"],children:(0,r.jsx)("nav",{className:ez()["step-optimize__tabs"],children:C.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>n(e.id),className:"".concat(ez()["step-optimize__tab"]," ").concat(s===e.id?ez()["step-optimize__tab--active"]:""),children:[(0,r.jsx)(t,{size:16}),(0,r.jsx)("span",{children:e.label})]},e.id)})})}),(0,r.jsx)("div",{className:ez()["step-optimize__main"],children:(()=>{if(console.log("Rendering tab content for active tab:",s),m)return(0,r.jsxs)("div",{className:ez()["step-optimize__loading"],children:[(0,r.jsx)("div",{className:ez()["step-optimize__spinner"]}),(0,r.jsx)("h3",{children:"Optimizing Your Portfolio..."}),(0,r.jsxs)("p",{children:["Performing Enhanced Hierarchical Risk Parity optimization using ",u," data with ",v," clustering."]})]});if(y)return(0,r.jsxs)("div",{className:ez()["step-optimize__error"],children:[(0,r.jsx)(er.Z,{size:48}),(0,r.jsx)("h3",{children:"Optimization Failed"}),(0,r.jsx)("p",{children:y}),(0,r.jsx)("button",{onClick:S,className:ez()["retry-button"],children:"Try Again"})]});if(!l)return null;switch(s){case"optimization":return renderOptimizationTab();case"comparison":return renderComparisonTab();case"risk":return renderRiskTab();case"correlation":return renderCorrelationTab();case"allocation":return renderAllocationTab();default:return null}})()})]}),(0,r.jsxs)("div",{className:ez()["step-optimize__action-buttons"],children:[(0,r.jsxs)("button",{onClick:a,className:ez()["step-optimize__back-button"],children:[(0,r.jsx)(q.Z,{size:16}),"Back to Analysis"]}),(0,r.jsxs)("button",{onClick:t,className:ez()["step-optimize__continue-button"],children:["Continue to Results ",(0,r.jsx)(x.Z,{size:16})]})]})]})},ew=a(5379),eA=a.n(ew),eR=a(4498),eP=a(705),eO=a(9009),eT=a(6888),eD=a(4195),eY=a(3023),eB=a(5358),eE=a(6050),eI=a(3558),eL=a(6108),eZ=a(6880),eK=a(4831),eW=a(483),components_StepSummary=e=>{let{portfolioData:t,onPrev:a}=e,[s,n]=(0,i.useState)(null),[l,o]=(0,i.useState)(!0),[d,m]=(0,i.useState)(10),[_,h]=(0,i.useState)(80),[u,p]=(0,i.useState)(!1);(0,i.useEffect)(()=>{t.optimizedPortfolio?runMonteCarloSimulation():o(!1)},[t,d,_]);let runMonteCarloSimulation=()=>{o(!0),setTimeout(()=>{let e=calculateMonteCarloResults();n(e),o(!1)},2e3)},calculateMonteCarloResults=()=>{let e=t.optimizedPortfolio,a=t.totalAmount,r=e.metrics.expectedReturn/100,i=.05*Math.sqrt(e.metrics.riskScore),s=[],n=[];for(let e=0;e<1e4;e++){let t=a,l=[{year:0,value:t,simulation:e}];for(let a=1;a<=d;a++){let s=generateNormalRandom(r,i);t*=1+s,e<100&&l.push({year:a,value:t,simulation:e})}s.push(t),e<100&&n.push(...l)}s.sort((e,t)=>e-t);let l=Math.floor((100-_)/2/100*1e4),o=Math.floor((100-(100-_)/2)/100*1e4),c={p5:s[Math.floor(500)],p10:s[Math.floor(1e3)],p25:s[Math.floor(2500)],p50:s[Math.floor(5e3)],p75:s[Math.floor(7500)],p90:s[Math.floor(9e3)],p95:s[Math.floor(9500)]},m=s.reduce((e,t)=>e+t,0)/1e4,h=s.reduce((e,t)=>e+Math.pow(t-m,2),0)/1e4,u=[{label:"Conservative Target",value:1.5*a},{label:"Moderate Target",value:2*a},{label:"Aggressive Target",value:3*a}],p=u.map(e=>({...e,probability:s.filter(t=>t>=e.value).length/1e4*100})),x=s[0],f=calculateMaxDrawdown(n),v=s.filter(e=>e<a).length/1e4*100,g=[];for(let e=1;e<=d;e++){let t=[];for(let s=0;s<1e3;s++){let s=a;for(let t=1;t<=e;t++){let e=generateNormalRandom(r,i);s*=1+e}t.push(s)}t.sort((e,t)=>e-t);let s=t.reduce((e,t)=>e+t,0)/t.length;g.push({year:e,mean:s,p10:t[Math.floor(.1*t.length)],p25:t[Math.floor(.25*t.length)],p50:t[Math.floor(.5*t.length)],p75:t[Math.floor(.75*t.length)],p90:t[Math.floor(.9*t.length)]})}return{percentiles:c,mean:m,standardDeviation:Math.sqrt(h),confidenceInterval:{lower:s[l],upper:s[o],confidence:_},goalProbabilities:p,riskMetrics:{worstCase:x,maxDrawdown:f,probabilityOfLoss:v,valueAtRisk:c.p5,expectedShortfall:s.slice(0,Math.floor(500)).reduce((e,t)=>e+t,0)/Math.floor(500)},yearlyStats:g,paths:n,annualizedReturn:Math.pow(m/a,1/d)-1}},generateNormalRandom=(e,t)=>{let a=0,r=0;for(;0===a;)a=Math.random();for(;0===r;)r=Math.random();let i=Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*r);return e+t*i},calculateMaxDrawdown=e=>{let a=0,r={};e.forEach(e=>{r[e.year]||(r[e.year]=[]),r[e.year].push(e.value)});for(let e=0;e<100;e++){let i=t.totalAmount,s=0;for(let t=0;t<=d;t++){let a=r[t];if(a&&a[e]){let t=a[e];t>i&&(i=t);let r=(i-t)/i;r>s&&(s=r)}}s>a&&(a=s)}return 100*a},x=s?Object.entries(s.percentiles).map(e=>{let[t,a]=e;return{percentile:t.toUpperCase(),value:a,probability:parseInt(t.substring(1))}}):[],f=s?s.yearlyStats.map(e=>({year:e.year,mean:e.mean,p10:e.p10,p25:e.p25,p75:e.p75,p90:e.p90})):[];if(!t.optimizedPortfolio)return(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h2",{children:"Portfolio Summary"}),(0,r.jsx)("p",{children:"Please complete the optimization step first."}),(0,r.jsxs)("button",{className:"btn btn-secondary",onClick:a,children:[(0,r.jsx)(q.Z,{size:16})," Go Back"]})]});let v=t.optimizedPortfolio,g=t.totalAmount;return(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63 card",children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h2",{className:"jsx-ff161281ed666c63",children:"Portfolio Summary & Analysis"}),(0,r.jsx)("p",{className:"jsx-ff161281ed666c63",children:"Comprehensive overview with Monte Carlo projections and risk analysis"})]}),(0,r.jsxs)("button",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},className:"jsx-ff161281ed666c63 btn btn-primary",children:[(0,r.jsx)(eg.Z,{size:16}),"Export Report"]})]}),(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",padding:"2rem",borderRadius:"12px",marginBottom:"2rem",border:"1px solid #bae6fd"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem",color:"#0369a1"},className:"jsx-ff161281ed666c63",children:"Executive Summary"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#0c4a6e"},className:"jsx-ff161281ed666c63",children:["\xa3",g.toLocaleString()]}),(0,r.jsx)("div",{style:{color:"#075985"},className:"jsx-ff161281ed666c63",children:"Total Investment"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#0c4a6e"},className:"jsx-ff161281ed666c63",children:[v.metrics.expectedReturn.toFixed(1),"%"]}),(0,r.jsx)("div",{style:{color:"#075985"},className:"jsx-ff161281ed666c63",children:"Expected Annual Return"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#0c4a6e"},className:"jsx-ff161281ed666c63",children:v.metrics.sharpeRatio.toFixed(2)}),(0,r.jsx)("div",{style:{color:"#075985"},className:"jsx-ff161281ed666c63",children:"Sharpe Ratio"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#0c4a6e"},className:"jsx-ff161281ed666c63",children:v.metrics.diversificationScore.toFixed(0)}),(0,r.jsx)("div",{style:{color:"#075985"},className:"jsx-ff161281ed666c63",children:"Diversification Score"})]})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem",padding:"1rem",background:"#f8fafc",borderRadius:"8px",alignItems:"center"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},className:"jsx-ff161281ed666c63",children:"Time Horizon (Years)"}),(0,r.jsx)("select",{value:d,onChange:e=>m(parseInt(e.target.value)),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #d1d5db"},className:"jsx-ff161281ed666c63",children:[5,10,15,20,25,30].map(e=>(0,r.jsxs)("option",{value:e,className:"jsx-ff161281ed666c63",children:[e," years"]},e))})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},className:"jsx-ff161281ed666c63",children:"Confidence Level"}),(0,r.jsx)("select",{value:_,onChange:e=>h(parseInt(e.target.value)),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #d1d5db"},className:"jsx-ff161281ed666c63",children:[70,80,90,95].map(e=>(0,r.jsxs)("option",{value:e,className:"jsx-ff161281ed666c63",children:[e,"%"]},e))})]}),(0,r.jsxs)("button",{onClick:runMonteCarloSimulation,disabled:l,style:{display:"flex",alignItems:"center",gap:"0.5rem"},className:"jsx-ff161281ed666c63 btn btn-secondary",children:[(0,r.jsx)(eR.Z,{size:16,className:l?"animate-spin":""}),l?"Running...":"Refresh Analysis"]})]}),l?(0,r.jsxs)("div",{style:{textAlign:"center",padding:"4rem",background:"#f8fafc",borderRadius:"8px",marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("div",{style:{display:"inline-block",width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #2563eb",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"1rem"},className:"jsx-ff161281ed666c63"}),(0,r.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"bold",marginBottom:"0.5rem"},className:"jsx-ff161281ed666c63",children:"Running Monte Carlo Analysis"}),(0,r.jsxs)("div",{style:{color:"#64748b"},className:"jsx-ff161281ed666c63",children:["Simulating ",d,"-year projections with 10,000 scenarios..."]})]}):s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Key Insights"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{padding:"1.5rem",background:"#f0fdf4",borderRadius:"8px",border:"1px solid #bbf7d0"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)(c.Z,{size:20,color:"#059669"}),(0,r.jsx)("strong",{style:{color:"#047857"},className:"jsx-ff161281ed666c63",children:"Expected Outcome"})]}),(0,r.jsxs)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#047857"},className:"jsx-ff161281ed666c63",children:["\xa3",s.mean.toLocaleString()]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#065f46"},className:"jsx-ff161281ed666c63",children:["Average portfolio value after ",d," years"]}),(0,r.jsxs)("div",{style:{fontSize:"0.75rem",color:"#16a34a",marginTop:"0.25rem"},className:"jsx-ff161281ed666c63",children:[(100*s.annualizedReturn).toFixed(1),"% annualized return"]})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",background:"#eff6ff",borderRadius:"8px",border:"1px solid #bfdbfe"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)(eu.Z,{size:20,color:"#2563eb"}),(0,r.jsxs)("strong",{style:{color:"#1d4ed8"},className:"jsx-ff161281ed666c63",children:[_,"% Confidence Range"]})]}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#1d4ed8"},className:"jsx-ff161281ed666c63",children:["\xa3",s.confidenceInterval.lower.toLocaleString()," - \xa3",s.confidenceInterval.upper.toLocaleString()]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#1e40af"},className:"jsx-ff161281ed666c63",children:[_,"% probability of falling within this range"]})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",background:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)(er.Z,{size:20,color:"#dc2626"}),(0,r.jsx)("strong",{style:{color:"#b91c1c"},className:"jsx-ff161281ed666c63",children:"Risk Metrics"})]}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#b91c1c"},className:"jsx-ff161281ed666c63",children:[s.riskMetrics.probabilityOfLoss.toFixed(1),"%"]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#991b1b"},className:"jsx-ff161281ed666c63",children:["Probability of loss after ",d," years"]}),(0,r.jsxs)("div",{style:{fontSize:"0.75rem",color:"#dc2626",marginTop:"0.25rem"},className:"jsx-ff161281ed666c63",children:["Max drawdown: ",s.riskMetrics.maxDrawdown.toFixed(1),"%"]})]})]})]}),(0,r.jsxs)("div",{style:{marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Goal Achievement Probabilities"}),(0,r.jsx)("div",{style:{display:"grid",gap:"1rem"},className:"jsx-ff161281ed666c63",children:s.goalProbabilities.map((e,t)=>(0,r.jsxs)("div",{style:{padding:"1rem",border:"1px solid #e2e8f0",borderRadius:"8px",background:e.probability>70?"#f0fdf4":e.probability>40?"#fffbeb":"#fef2f2"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("div",{style:{fontWeight:"bold"},className:"jsx-ff161281ed666c63",children:e.label}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:["Target: \xa3",e.value.toLocaleString()]})]}),(0,r.jsxs)("div",{style:{textAlign:"right"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:e.probability>70?"#059669":e.probability>40?"#d97706":"#dc2626"},className:"jsx-ff161281ed666c63",children:[e.probability.toFixed(1),"%"]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:"Probability"})]})]}),(0,r.jsx)("div",{style:{marginTop:"0.5rem",height:"4px",background:"#e2e8f0",borderRadius:"2px",overflow:"hidden"},className:"jsx-ff161281ed666c63",children:(0,r.jsx)("div",{style:{width:"".concat(e.probability,"%"),height:"100%",background:e.probability>70?"#059669":e.probability>40?"#d97706":"#dc2626",transition:"width 0.3s ease"},className:"jsx-ff161281ed666c63"})})]},t))})]}),(0,r.jsxs)("div",{style:{display:"grid",gap:"2rem",marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Portfolio Value Projections"}),(0,r.jsx)(eO.h,{width:"100%",height:400,children:(0,r.jsxs)(eT.T,{data:f,children:[(0,r.jsx)(eD.q,{strokeDasharray:"3 3"}),(0,r.jsx)(eY.K,{dataKey:"year"}),(0,r.jsx)(eB.B,{tickFormatter:e=>"\xa3".concat((e/1e3).toFixed(0),"k")}),(0,r.jsx)(eE.u,{formatter:e=>["\xa3".concat(e.toLocaleString()),""],labelFormatter:e=>"Year ".concat(e)}),(0,r.jsx)(eI.D,{}),(0,r.jsx)(eL.u,{type:"monotone",dataKey:"p90",stackId:"1",stroke:"#dc2626",fill:"#fee2e2",name:"90th Percentile",fillOpacity:.3}),(0,r.jsx)(eL.u,{type:"monotone",dataKey:"p75",stackId:"2",stroke:"#f59e0b",fill:"#fef3c7",name:"75th Percentile",fillOpacity:.4}),(0,r.jsx)(eZ.x,{type:"monotone",dataKey:"mean",stroke:"#2563eb",strokeWidth:3,name:"Expected Value",dot:{fill:"#2563eb",r:4}}),(0,r.jsx)(eL.u,{type:"monotone",dataKey:"p25",stackId:"3",stroke:"#f59e0b",fill:"#fef3c7",name:"25th Percentile",fillOpacity:.4}),(0,r.jsx)(eL.u,{type:"monotone",dataKey:"p10",stackId:"4",stroke:"#dc2626",fill:"#fee2e2",name:"10th Percentile",fillOpacity:.3})]})})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:["Outcome Distribution (Year ",d,")"]}),(0,r.jsx)(eO.h,{width:"100%",height:300,children:(0,r.jsxs)(eK.v,{data:x,children:[(0,r.jsx)(eD.q,{strokeDasharray:"3 3"}),(0,r.jsx)(eY.K,{dataKey:"percentile"}),(0,r.jsx)(eB.B,{tickFormatter:e=>"\xa3".concat((e/1e3).toFixed(0),"k")}),(0,r.jsx)(eE.u,{formatter:e=>["\xa3".concat(e.toLocaleString()),"Portfolio Value"]}),(0,r.jsx)(eW.$,{dataKey:"value",fill:"#2563eb"})]})})]})]}),(0,r.jsxs)("button",{onClick:()=>p(!u),style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63 btn btn-secondary",children:[u?"Hide":"Show"," Advanced Risk Metrics"]}),u&&(0,r.jsxs)("div",{style:{padding:"1.5rem",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0",marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h4",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Advanced Risk Analysis"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Value at Risk (5%)"}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",color:"#dc2626"},className:"jsx-ff161281ed666c63",children:["\xa3",s.riskMetrics.valueAtRisk.toLocaleString()]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:"5% chance of worse outcome"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Expected Shortfall"}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",color:"#dc2626"},className:"jsx-ff161281ed666c63",children:["\xa3",s.riskMetrics.expectedShortfall.toLocaleString()]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:"Average of worst 5% outcomes"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Worst Case Scenario"}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",color:"#dc2626"},className:"jsx-ff161281ed666c63",children:["\xa3",s.riskMetrics.worstCase.toLocaleString()]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:"Lowest simulated outcome"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Standard Deviation"}),(0,r.jsxs)("div",{style:{fontSize:"1.25rem",color:"#2563eb"},className:"jsx-ff161281ed666c63",children:["\xa3",s.standardDeviation.toLocaleString()]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:"Portfolio volatility"})]})]})]})]}),(0,r.jsxs)("div",{style:{marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Final Portfolio Composition"}),(0,r.jsx)("div",{style:{display:"grid",gap:"1rem"},className:"jsx-ff161281ed666c63",children:t.selectedFunds.map((e,t)=>{let a=v.allocations[e.id];return(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",border:"1px solid #e2e8f0",borderRadius:"8px",background:"#ffffff"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("div",{style:{fontWeight:"bold"},className:"jsx-ff161281ed666c63",children:e.name}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:[e.type," • ",e.risk," Risk • ",e.fee,"% Fee"]})]}),(0,r.jsxs)("div",{style:{textAlign:"right"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},className:"jsx-ff161281ed666c63",children:[a.toFixed(1),"%"]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#64748b"},className:"jsx-ff161281ed666c63",children:["\xa3",(g*a/100).toLocaleString()]})]})]},e.id)})})]}),(0,r.jsxs)("div",{style:{marginBottom:"2rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:"Ongoing Management"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},className:"jsx-ff161281ed666c63",children:(0,r.jsxs)("div",{style:{padding:"1.5rem",background:"#f0f9ff",borderRadius:"8px",border:"1px solid #bfdbfe"},className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},className:"jsx-ff161281ed666c63",children:[(0,r.jsx)(eP.Z,{size:20,color:"#2563eb"}),(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Rebalancing Schedule"})]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Frequency:"})," ",v.rebalancing.frequency]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Next Rebalance:"})," ",v.rebalancing.nextRebalance]}),(0,r.jsxs)("div",{className:"jsx-ff161281ed666c63",children:[(0,r.jsx)("strong",{className:"jsx-ff161281ed666c63",children:"Estimated Annual Cost:"})," ",v.rebalancing.estimatedCost.toFixed(2),"%"]})]})]})})]}),(0,r.jsxs)("div",{style:{marginTop:"2rem"},className:"jsx-ff161281ed666c63 action-buttons",children:[(0,r.jsxs)("button",{onClick:a,className:"jsx-ff161281ed666c63 btn btn-secondary",children:[(0,r.jsx)(q.Z,{size:16})," Back to Optimization"]}),(0,r.jsxs)("button",{onClick:()=>window.print(),className:"jsx-ff161281ed666c63 btn btn-primary",children:[(0,r.jsx)(eg.Z,{size:16})," Print Report"]})]})]}),(0,r.jsx)(eA(),{id:"ff161281ed666c63",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})};function Home(e){let{}=e,t=(0,s.useRouter)(),[a,n]=(0,i.useState)(1),[l,o]=(0,i.useState)(!1),{basket:c}=useBasket();(0,i.useEffect)(()=>{let{step:e}=t.query;if(e){let t=parseInt(e);t>=1&&t<=4&&n(t)}},[t.query]);let nextStep=()=>{if(a<4){let e=a+1;n(e),t.push("/?step=".concat(e),void 0,{shallow:!0})}},prevStep=()=>{if(a>1){let e=a-1;n(e),t.push("/?step=".concat(e),void 0,{shallow:!0})}};return(0,r.jsxs)("div",{className:"app",children:[(0,r.jsx)(components_Navigation,{currentStep:a,onStepChange:e=>{n(e),t.push("/?step=".concat(e),void 0,{shallow:!0})},basket:c}),(0,r.jsx)("main",{className:"main-content",children:(()=>{switch(a){case 1:return(0,r.jsx)(components_StepPicker,{onNext:nextStep});case 2:return(0,r.jsx)(components_StepAnalyze,{onNext:nextStep,onPrev:prevStep});case 3:return(0,r.jsx)(components_StepOptimize,{onNext:nextStep,onPrev:prevStep});case 4:return(0,r.jsx)(components_StepSummary,{onPrev:prevStep});default:return null}})()})]})}},5227:function(e){e.exports={overlay:"BasketModal_overlay__QYw3s",modal:"BasketModal_modal__5xlR5",header:"BasketModal_header__X1BdQ",headerActions:"BasketModal_headerActions__YYRnc",title:"BasketModal_title__RNEVg",copyContainer:"BasketModal_copyContainer__w126G",copyButton:"BasketModal_copyButton__hx2ld",copyMenu:"BasketModal_copyMenu__OTnpU",copyMenuItem:"BasketModal_copyMenuItem__tT3nl",copySuccess:"BasketModal_copySuccess__f9nE7",fadeInOut:"BasketModal_fadeInOut__ODXbn",closeButton:"BasketModal_closeButton__1w_8I",emptyState:"BasketModal_emptyState__whas3",fundsList:"BasketModal_fundsList__J_K17",fundItem:"BasketModal_fundItem__4ooMt",fundInfo:"BasketModal_fundInfo__3OoYL",fundName:"BasketModal_fundName__AeERR",fundDetails:"BasketModal_fundDetails__JLjlx",separator:"BasketModal_separator__IwhPG",fee:"BasketModal_fee__JViv3",fundActions:"BasketModal_fundActions__SP0vj",infoButton:"BasketModal_infoButton__rcuVG",copyItemButton:"BasketModal_copyItemButton__Fu_cJ",copiedIndicator:"BasketModal_copiedIndicator__WVSKq",removeButton:"BasketModal_removeButton__skSZC",modalFadeIn:"BasketModal_modalFadeIn__w47v2"}},1299:function(e){e.exports={"correlation-matrix__container":"CorrelationMatrix_correlation-matrix__container__0bzrM","correlation-matrix__header":"CorrelationMatrix_correlation-matrix__header__PYyn_","correlation-matrix__header-top":"CorrelationMatrix_correlation-matrix__header-top__Mdv8n","correlation-matrix__header-title-section":"CorrelationMatrix_correlation-matrix__header-title-section__vioD_","correlation-matrix__header-title":"CorrelationMatrix_correlation-matrix__header-title__WWSxV","correlation-matrix__header-icon":"CorrelationMatrix_correlation-matrix__header-icon__xJfcS","correlation-matrix__header-description":"CorrelationMatrix_correlation-matrix__header-description__nB5ED","correlation-matrix__export-button":"CorrelationMatrix_correlation-matrix__export-button__gOjkB",disabled:"CorrelationMatrix_disabled__BRWgV","correlation-matrix__range-selector":"CorrelationMatrix_correlation-matrix__range-selector__frGU7","correlation-matrix__range-button":"CorrelationMatrix_correlation-matrix__range-button__4X68G","correlation-matrix__range-button--active":"CorrelationMatrix_correlation-matrix__range-button--active__e9VR_","correlation-matrix__range-button--inactive":"CorrelationMatrix_correlation-matrix__range-button--inactive__MbYuZ","correlation-matrix__loading":"CorrelationMatrix_correlation-matrix__loading__WpXR0","correlation-matrix__loading-spinner":"CorrelationMatrix_correlation-matrix__loading-spinner___3ki4",spin:"CorrelationMatrix_spin__X1wy4","correlation-matrix__loading-title":"CorrelationMatrix_correlation-matrix__loading-title____koQ","correlation-matrix__loading-description":"CorrelationMatrix_correlation-matrix__loading-description__vuCi6","correlation-matrix__error":"CorrelationMatrix_correlation-matrix__error__Dk2SK","correlation-matrix__error-content":"CorrelationMatrix_correlation-matrix__error-content__1UwTr","correlation-matrix__error-icon":"CorrelationMatrix_correlation-matrix__error-icon__wjjCm","correlation-matrix__error-title":"CorrelationMatrix_correlation-matrix__error-title__ccxS6","correlation-matrix__error-message":"CorrelationMatrix_correlation-matrix__error-message__wolAK","correlation-matrix__empty":"CorrelationMatrix_correlation-matrix__empty__NnYom","correlation-matrix__empty-icon":"CorrelationMatrix_correlation-matrix__empty-icon__qh0ID","correlation-matrix__empty-title":"CorrelationMatrix_correlation-matrix__empty-title__RmXI3","correlation-matrix__empty-description":"CorrelationMatrix_correlation-matrix__empty-description__xx_3V","correlation-matrix__sorting-info":"CorrelationMatrix_correlation-matrix__sorting-info__3douy","correlation-matrix__sorting-info-content":"CorrelationMatrix_correlation-matrix__sorting-info-content__rpssx","correlation-matrix__matrix-card":"CorrelationMatrix_correlation-matrix__matrix-card__Yuapl","correlation-matrix__matrix-title":"CorrelationMatrix_correlation-matrix__matrix-title__JckhZ","correlation-matrix__matrix-container":"CorrelationMatrix_correlation-matrix__matrix-container__nYXYg","correlation-matrix__matrix-table":"CorrelationMatrix_correlation-matrix__matrix-table__QmjvK","correlation-matrix__matrix-header-cell":"CorrelationMatrix_correlation-matrix__matrix-header-cell__Y2HDw","correlation-matrix__matrix-header-cell--corner":"CorrelationMatrix_correlation-matrix__matrix-header-cell--corner__QuNV5","correlation-matrix__matrix-header-cell--avg":"CorrelationMatrix_correlation-matrix__matrix-header-cell--avg__gMKGi","correlation-matrix__matrix-header-cell--fund":"CorrelationMatrix_correlation-matrix__matrix-header-cell--fund__MpcG3","correlation-matrix__matrix-header-text":"CorrelationMatrix_correlation-matrix__matrix-header-text__L_oaR","correlation-matrix__matrix-row":"CorrelationMatrix_correlation-matrix__matrix-row__Vy4PI","correlation-matrix__matrix-row-header":"CorrelationMatrix_correlation-matrix__matrix-row-header__IkCq7","correlation-matrix__fund-info":"CorrelationMatrix_correlation-matrix__fund-info__eqBCt","correlation-matrix__fund-name":"CorrelationMatrix_correlation-matrix__fund-name__yfz91","correlation-matrix__fund-rank":"CorrelationMatrix_correlation-matrix__fund-rank__EFOI4","correlation-matrix__matrix-avg-cell":"CorrelationMatrix_correlation-matrix__matrix-avg-cell__0akD2","correlation-matrix__avg-correlation":"CorrelationMatrix_correlation-matrix__avg-correlation__vfWTF","correlation-matrix__matrix-cell":"CorrelationMatrix_correlation-matrix__matrix-cell__rrmfZ","correlation-matrix__correlation-value":"CorrelationMatrix_correlation-matrix__correlation-value__ApgYa","correlation-matrix__correlation-value--diagonal":"CorrelationMatrix_correlation-matrix__correlation-value--diagonal__i66tq","correlation-matrix__correlation-value--very-strong-positive":"CorrelationMatrix_correlation-matrix__correlation-value--very-strong-positive__Wlbar","correlation-matrix__correlation-value--strong-positive":"CorrelationMatrix_correlation-matrix__correlation-value--strong-positive__BeCJr","correlation-matrix__correlation-value--moderate-positive":"CorrelationMatrix_correlation-matrix__correlation-value--moderate-positive__9pSIP","correlation-matrix__correlation-value--weak-positive":"CorrelationMatrix_correlation-matrix__correlation-value--weak-positive__34XYo","correlation-matrix__correlation-value--very-weak":"CorrelationMatrix_correlation-matrix__correlation-value--very-weak__XIO6K","correlation-matrix__correlation-value--very-strong-negative":"CorrelationMatrix_correlation-matrix__correlation-value--very-strong-negative__BHy6P","correlation-matrix__correlation-value--strong-negative":"CorrelationMatrix_correlation-matrix__correlation-value--strong-negative__90t6U","correlation-matrix__correlation-value--moderate-negative":"CorrelationMatrix_correlation-matrix__correlation-value--moderate-negative__ApQyG","correlation-matrix__correlation-value--weak-negative":"CorrelationMatrix_correlation-matrix__correlation-value--weak-negative__uJKTz","correlation-matrix__ranking":"CorrelationMatrix_correlation-matrix__ranking__vUp43","correlation-matrix__ranking-title":"CorrelationMatrix_correlation-matrix__ranking-title___f_Su","correlation-matrix__ranking-grid":"CorrelationMatrix_correlation-matrix__ranking-grid__OE1Pu","correlation-matrix__ranking-item":"CorrelationMatrix_correlation-matrix__ranking-item__fjOvd","correlation-matrix__ranking-position":"CorrelationMatrix_correlation-matrix__ranking-position__XDM1o","correlation-matrix__ranking-details":"CorrelationMatrix_correlation-matrix__ranking-details__DCOcn","correlation-matrix__ranking-fund-name":"CorrelationMatrix_correlation-matrix__ranking-fund-name__kATtr","correlation-matrix__ranking-correlation":"CorrelationMatrix_correlation-matrix__ranking-correlation__f7zfQ","correlation-matrix__ranking-badge":"CorrelationMatrix_correlation-matrix__ranking-badge__FlYwx","correlation-matrix__ranking-badge--high":"CorrelationMatrix_correlation-matrix__ranking-badge--high__ZkTKl","correlation-matrix__ranking-badge--medium":"CorrelationMatrix_correlation-matrix__ranking-badge--medium__COKyV","correlation-matrix__ranking-badge--low":"CorrelationMatrix_correlation-matrix__ranking-badge--low__5rzKT","correlation-matrix__legend":"CorrelationMatrix_correlation-matrix__legend__sn6BQ","correlation-matrix__legend-title":"CorrelationMatrix_correlation-matrix__legend-title__wVwWq","correlation-matrix__legend-grid":"CorrelationMatrix_correlation-matrix__legend-grid__5cIUz","correlation-matrix__legend-section":"CorrelationMatrix_correlation-matrix__legend-section__oYp_k","correlation-matrix__legend-items":"CorrelationMatrix_correlation-matrix__legend-items__QYFSu","correlation-matrix__legend-item":"CorrelationMatrix_correlation-matrix__legend-item__rKF_U","correlation-matrix__legend-color":"CorrelationMatrix_correlation-matrix__legend-color__5glNM","correlation-matrix__legend-color--border":"CorrelationMatrix_correlation-matrix__legend-color--border__AcmdT","correlation-matrix__legend-tip":"CorrelationMatrix_correlation-matrix__legend-tip__nZ_Ub","correlation-matrix__summary":"CorrelationMatrix_correlation-matrix__summary__a_du_","correlation-matrix__summary-title":"CorrelationMatrix_correlation-matrix__summary-title__rbFeK","correlation-matrix__summary-grid":"CorrelationMatrix_correlation-matrix__summary-grid__d6DNl","correlation-matrix__summary-stat":"CorrelationMatrix_correlation-matrix__summary-stat__S2wmu","correlation-matrix__summary-stat-value":"CorrelationMatrix_correlation-matrix__summary-stat-value__CdGRZ","correlation-matrix__summary-stat-label":"CorrelationMatrix_correlation-matrix__summary-stat-label__Vq1Do","correlation-matrix__sort-selector":"CorrelationMatrix_correlation-matrix__sort-selector__SHhXJ","correlation-matrix__sort-buttons":"CorrelationMatrix_correlation-matrix__sort-buttons__xNb0X","correlation-matrix__sort-button":"CorrelationMatrix_correlation-matrix__sort-button__GaIzU"}},9945:function(e){e.exports={"correlation-enhanced-tab":"CorrelationTab_correlation-enhanced-tab__y60DV","correlation-header":"CorrelationTab_correlation-header__yOkGd","correlation-title-section":"CorrelationTab_correlation-title-section__JSexO","correlation-controls":"CorrelationTab_correlation-controls__JnvfN","view-toggle":"CorrelationTab_view-toggle__Ufa_s","toggle-btn":"CorrelationTab_toggle-btn__2tCk6",active:"CorrelationTab_active__VvXjY","correlation-shared-controls":"CorrelationTab_correlation-shared-controls__10P5q","correlation-sort-selector":"CorrelationTab_correlation-sort-selector__ocANC","correlation-sort-buttons":"CorrelationTab_correlation-sort-buttons__oDGrR","correlation-sort-button":"CorrelationTab_correlation-sort-button__nkQHV","correlation-sort-button--active":"CorrelationTab_correlation-sort-button--active__P2Q72","correlation-sort-button--inactive":"CorrelationTab_correlation-sort-button--inactive__raO3k","correlation-range-selector":"CorrelationTab_correlation-range-selector__ejDjo","correlation-range-buttons":"CorrelationTab_correlation-range-buttons__g_7jE","correlation-range-button":"CorrelationTab_correlation-range-button__G5rXl","correlation-range-button--active":"CorrelationTab_correlation-range-button--active___vvys","correlation-range-button--inactive":"CorrelationTab_correlation-range-button--inactive__dT_6f","correlation-content":"CorrelationTab_correlation-content__bDbb0","matrix-container":"CorrelationTab_matrix-container__AfLY8","chord-container":"CorrelationTab_chord-container__RfEhd","fund-details-panel":"CorrelationTab_fund-details-panel__DNbgj","fund-details-content":"CorrelationTab_fund-details-content__SUHT4","fund-stats":"CorrelationTab_fund-stats__3PtqD","stat-item":"CorrelationTab_stat-item__F76pF","stat-label":"CorrelationTab_stat-label__aDKe7","stat-value":"CorrelationTab_stat-value__0qUpL"}},8212:function(e){e.exports={"fidelity-metrics":"FidelityMetricsTab_fidelity-metrics__Y3oce","fidelity-metrics__header":"FidelityMetricsTab_fidelity-metrics__header__oxsKq","fidelity-metrics__selector":"FidelityMetricsTab_fidelity-metrics__selector__0LGP_","fidelity-metrics__buttons":"FidelityMetricsTab_fidelity-metrics__buttons__lFDQS","fidelity-metrics__button":"FidelityMetricsTab_fidelity-metrics__button__WlAsf","fidelity-metrics__button--active":"FidelityMetricsTab_fidelity-metrics__button--active__PH86p","fidelity-metrics__overview":"FidelityMetricsTab_fidelity-metrics__overview__82gD9","fidelity-metrics__overview-header":"FidelityMetricsTab_fidelity-metrics__overview-header___Y3GD","fidelity-metrics__overview-title":"FidelityMetricsTab_fidelity-metrics__overview-title__SYrOC","fidelity-metrics__overview-description":"FidelityMetricsTab_fidelity-metrics__overview-description__IdLNq","fidelity-metrics__overview-interpretation":"FidelityMetricsTab_fidelity-metrics__overview-interpretation__lbDjs","fidelity-metrics__overview-stats":"FidelityMetricsTab_fidelity-metrics__overview-stats__0vmGc","fidelity-metrics__stat-card":"FidelityMetricsTab_fidelity-metrics__stat-card__IUzO7","fidelity-metrics__stat-values":"FidelityMetricsTab_fidelity-metrics__stat-values__AkuSa","fidelity-metrics__stat-row":"FidelityMetricsTab_fidelity-metrics__stat-row__74pN7","fidelity-metrics__stat-value":"FidelityMetricsTab_fidelity-metrics__stat-value__tlg_H","fidelity-metrics__stat-range":"FidelityMetricsTab_fidelity-metrics__stat-range__oQ1kG","fidelity-metrics__stat-count":"FidelityMetricsTab_fidelity-metrics__stat-count__fiNij","fidelity-metrics__section":"FidelityMetricsTab_fidelity-metrics__section__h5g3_","fidelity-metrics__table-container":"FidelityMetricsTab_fidelity-metrics__table-container__mbZlf","fidelity-metrics__table":"FidelityMetricsTab_fidelity-metrics__table__E6pD7","fidelity-metrics__fund-name":"FidelityMetricsTab_fidelity-metrics__fund-name__1iCxP","fidelity-metrics__value--positive":"FidelityMetricsTab_fidelity-metrics__value--positive__fI5h_","fidelity-metrics__value--negative":"FidelityMetricsTab_fidelity-metrics__value--negative__CfsWY","fidelity-metrics__value--neutral":"FidelityMetricsTab_fidelity-metrics__value--neutral__xM2ku","fidelity-metrics__value--warning":"FidelityMetricsTab_fidelity-metrics__value--warning__HQAFC","fidelity-metrics__summary-grid":"FidelityMetricsTab_fidelity-metrics__summary-grid__20JKv","fidelity-metrics__summary-card":"FidelityMetricsTab_fidelity-metrics__summary-card__W6gdG","fidelity-metrics__summary-header":"FidelityMetricsTab_fidelity-metrics__summary-header__8vS6y","fidelity-metrics__summary-value":"FidelityMetricsTab_fidelity-metrics__summary-value__qOv0x","fidelity-metrics__summary-number":"FidelityMetricsTab_fidelity-metrics__summary-number__QdUM7","fidelity-metrics__summary-label":"FidelityMetricsTab_fidelity-metrics__summary-label__4VNeX","fidelity-metrics__summary-info":"FidelityMetricsTab_fidelity-metrics__summary-info___MRf5"}},2205:function(e){e.exports={"modal-overlay":"FilterModal_modal-overlay__8c5jd",fadeIn:"FilterModal_fadeIn__v_uri","modal-container":"FilterModal_modal-container__DwPpH",slideUp:"FilterModal_slideUp__qE5Nk","modal-header":"FilterModal_modal-header__mkBmD","modal-header__title":"FilterModal_modal-header__title__yYK5e","modal-header__close-button":"FilterModal_modal-header__close-button__lwbvX","filter-grid":"FilterModal_filter-grid__nG9XQ","filter-section":"FilterModal_filter-section__s52ea","filter-section__title":"FilterModal_filter-section__title__6pxs4","form-group":"FilterModal_form-group__0VsNU","form-group__label":"FilterModal_form-group__label__b9KyP","form-group__select":"FilterModal_form-group__select__kO_CL","modal-footer":"FilterModal_modal-footer__oR9G3","modal-footer__reset-button":"FilterModal_modal-footer__reset-button__CyuUC",disabled:"FilterModal_disabled__SN6cT","modal-footer__apply-button":"FilterModal_modal-footer__apply-button__GAfsq","slider-values":"FilterModal_slider-values__BjhJD","range-slider-container":"FilterModal_range-slider-container__r393F","custom-slider":"FilterModal_custom-slider__v_qu9","slider-track":"FilterModal_slider-track__0u9WR","slider-thumb":"FilterModal_slider-thumb__YnfEy","slider-scale":"FilterModal_slider-scale__4iQL0","scale-label":"FilterModal_scale-label__Ezu10"}},8109:function(e){e.exports={"fund-card":"FundCard_fund-card__aNVsH","fund-card--filtered":"FundCard_fund-card--filtered__gAQco","fund-name":"FundCard_fund-name__zDn3o","fund-sector":"FundCard_fund-sector__eww4_","fund-sedol":"FundCard_fund-sedol__5LBfy","fund-details":"FundCard_fund-details__iGISc","fund-detail-item":"FundCard_fund-detail-item__rlwjM","fee-text":"FundCard_fee-text__3lX4W","add-button":"FundCard_add-button__GXYj0","view-details-button":"FundCard_view-details-button__tZvX2","filtered-badge":"FundCard_filtered-badge__Fws4O","fund-card-header":"FundCard_fund-card-header__7tA2O","fund-info":"FundCard_fund-info__cdTWt","add-button--disabled":"FundCard_add-button--disabled__dg91s"}},1628:function(e){e.exports={modal:"FundDetailModal_modal__OhUlc",modal__content:"FundDetailModal_modal__content__qWZ6k",modal__header:"FundDetailModal_modal__header__S2NSB",modal__close:"FundDetailModal_modal__close__rpYS_",details__grid:"FundDetailModal_details__grid__WY4tj",details__item:"FundDetailModal_details__item__HxAMK",description:"FundDetailModal_description__3FNjx",description__title:"FundDetailModal_description__title__CxEsn",description__text:"FundDetailModal_description__text___DB0K",aims:"FundDetailModal_aims__rd5It",aims__title:"FundDetailModal_aims__title__zDtCu",aims__text:"FundDetailModal_aims__text__PDHqw",performance__grid:"FundDetailModal_performance__grid__Bpb3l",performance__item:"FundDetailModal_performance__item__DB2Ci",positive:"FundDetailModal_positive__2nJHX",negative:"FundDetailModal_negative__NT9rH",documents:"FundDetailModal_documents__i3NJX",documents__link:"FundDetailModal_documents__link__kc9qH","documents__link--primary":"FundDetailModal_documents__link--primary__ipg9y","documents__link--success":"FundDetailModal_documents__link--success__eHJs5","documents__link--secondary":"FundDetailModal_documents__link--secondary__tECZ2",action__button:"FundDetailModal_action__button__NWLGT",disabled:"FundDetailModal_disabled___CvnL","action__button--disabled":"FundDetailModal_action__button--disabled__m7tYh","sr-only":"FundDetailModal_sr-only__PAA2O",modalFadeIn:"FundDetailModal_modalFadeIn__X6H4y"}},8873:function(e){e.exports={"fund-info-bar":"FundInfoBar_fund-info-bar__creA2","fund-info-bar__main":"FundInfoBar_fund-info-bar__main__TLGWq","fund-info-bar__results":"FundInfoBar_fund-info-bar__results__vPnMG","fund-count":"FundInfoBar_fund-count__WNPWw","fund-count__number":"FundInfoBar_fund-count__number___q9mD","fund-count__number--muted":"FundInfoBar_fund-count__number--muted__VCc8e","fund-count__label":"FundInfoBar_fund-count__label__zSV8J","fund-count__label--muted":"FundInfoBar_fund-count__label--muted__PWz24","fund-info-bar__pagination":"FundInfoBar_fund-info-bar__pagination__Oo27C","fund-info-bar__sorting":"FundInfoBar_fund-info-bar__sorting__pG9cW","sorting-info":"FundInfoBar_sorting-info__F_Z7D","sort-order":"FundInfoBar_sort-order__r0RgZ","fund-info-bar__filter-notice":"FundInfoBar_fund-info-bar__filter-notice__N01BQ"}},6243:function(e){e.exports={"step-nav":"Navigation_step-nav__8mYA7","nav-steps":"Navigation_nav-steps__AghZ9",step:"Navigation_step__C5zi8",active:"Navigation_active__XUJxu",disabled:"Navigation_disabled__QbzId","step-number":"Navigation_step-number__Uiukl","step-connector":"Navigation_step-connector__8pf4p",completed:"Navigation_completed__89d_J"}},9942:function(e){e.exports={pagination:"PaginationControls_pagination__232N3",navigationButton:"PaginationControls_navigationButton__9jxu7",disabled:"PaginationControls_disabled__kD58M",pageButton:"PaginationControls_pageButton__4kB_7",active:"PaginationControls_active__g6NhM",icon:"PaginationControls_icon__Q186l"}},2759:function(e){e.exports={"performance-tab":"PerformanceTab_performance-tab__q564C","performance-tab__header":"PerformanceTab_performance-tab__header__tnjRO","performance-tab__summary":"PerformanceTab_performance-tab__summary__RsvLL","performance-tab__card":"PerformanceTab_performance-tab__card__pzIua","performance-tab__highlights":"PerformanceTab_performance-tab__highlights__Li50h","performance-tab__highlight":"PerformanceTab_performance-tab__highlight___Tu64","performance-tab__highlight-label":"PerformanceTab_performance-tab__highlight-label__S8ACl","performance-tab__highlight-value":"PerformanceTab_performance-tab__highlight-value__DOmjs","performance-tab__section":"PerformanceTab_performance-tab__section___rTru","performance-tab__grid":"PerformanceTab_performance-tab__grid__RO2DI","performance-tab__metric-card":"PerformanceTab_performance-tab__metric-card__oHQrU","performance-tab__metric-header":"PerformanceTab_performance-tab__metric-header__kiJNp","performance-tab__metric-count":"PerformanceTab_performance-tab__metric-count__Hdyof","performance-tab__metric-values":"PerformanceTab_performance-tab__metric-values__aUDjk","performance-tab__metric-row":"PerformanceTab_performance-tab__metric-row__s8Aki","performance-tab__metric-value":"PerformanceTab_performance-tab__metric-value__eegvW","performance-tab__metric-range":"PerformanceTab_performance-tab__metric-range__Ikx6r","performance-tab__table-container":"PerformanceTab_performance-tab__table-container__8Vfz7","performance-tab__table":"PerformanceTab_performance-tab__table__ZEqXQ","performance-tab__fund-name":"PerformanceTab_performance-tab__fund-name__qHGf3","performance-tab__value--positive":"PerformanceTab_performance-tab__value--positive__kSRyt","performance-tab__value--negative":"PerformanceTab_performance-tab__value--negative__68Mkr","performance-tab__value--neutral":"PerformanceTab_performance-tab__value--neutral__HD25n","performance-tab__icon--positive":"PerformanceTab_performance-tab__icon--positive__KAn0F","performance-tab__icon--negative":"PerformanceTab_performance-tab__icon--negative__nyf7D","performance-tab__icon--neutral":"PerformanceTab_performance-tab__icon--neutral__Qr3uF",fadeInUp:"PerformanceTab_fadeInUp___qW8s"}},525:function(e){e.exports={"step-picker__progress":"ProgressIndicator_step-picker__progress__23JPw","step-picker__progress-bar":"ProgressIndicator_step-picker__progress-bar__6MD_n","step-picker__progress-fill":"ProgressIndicator_step-picker__progress-fill__oZI9b","progress-shimmer":"ProgressIndicator_progress-shimmer__Yiuyb","step-picker__progress-text":"ProgressIndicator_step-picker__progress-text__Ljy9S","step-picker__funds-grid":"ProgressIndicator_step-picker__funds-grid__tBg1x","fund-card--loading":"ProgressIndicator_fund-card--loading__0_avy"}},6513:function(e){e.exports={"range-slider-container":"RangeSlider_range-slider-container__UkTMn","slider-label":"RangeSlider_slider-label__Cw2lk","slider-values":"RangeSlider_slider-values__pxOIf","value-display":"RangeSlider_value-display__xHgt9","custom-slider":"RangeSlider_custom-slider__qjX7D","slider-scale":"RangeSlider_slider-scale__NjV9c","scale-mark":"RangeSlider_scale-mark__4wh2k","scale-tick":"RangeSlider_scale-tick__piK1N","scale-label":"RangeSlider_scale-label__7DWyx","slider-track":"RangeSlider_slider-track__Ghqth","slider-range":"RangeSlider_slider-range__6bsGS","slider-thumb":"RangeSlider_slider-thumb__gOpo3",dragging:"RangeSlider_dragging__Y4Glz","thumb-tooltip":"RangeSlider_thumb-tooltip__l5a9i"}},4326:function(e){e.exports={controls:"SearchAndSortControls_controls__9ghY5","search-wrapper":"SearchAndSortControls_search-wrapper__B9JYL","search-icon":"SearchAndSortControls_search-icon__QUc0Q","search-input":"SearchAndSortControls_search-input__viCwu","toggle-button":"SearchAndSortControls_toggle-button__1HWFH","clear-button":"SearchAndSortControls_clear-button__LKUEf","filter-button":"SearchAndSortControls_filter-button__4po6_","sort-controls":"SearchAndSortControls_sort-controls__rQ7av","sort-select":"SearchAndSortControls_sort-select__qc8x6","sort-order-button":"SearchAndSortControls_sort-order-button__ZEzB9"}},2776:function(e){e.exports={"step-analyze":"StepAnalyze_step-analyze__S7Eon","step-analyze__header":"StepAnalyze_step-analyze__header__uVHf6","step-analyze__title":"StepAnalyze_step-analyze__title__ICmbA","step-analyze__description":"StepAnalyze_step-analyze__description__5EzLg","step-analyze__layout":"StepAnalyze_step-analyze__layout__d3vcb","step-analyze__sidebar":"StepAnalyze_step-analyze__sidebar__JwJGg","step-analyze__tabs":"StepAnalyze_step-analyze__tabs__Fm_Nt","step-analyze__tab":"StepAnalyze_step-analyze__tab__BY1AE","step-analyze__tab--active":"StepAnalyze_step-analyze__tab--active__YpfAW","step-analyze__main":"StepAnalyze_step-analyze__main__LGyQp","step-analyze__content":"StepAnalyze_step-analyze__content__9BUDV","step-analyze__content__header-content":"StepAnalyze_step-analyze__content__header-content__vxbR_","step-analyze__loading":"StepAnalyze_step-analyze__loading__6BNgF","step-analyze__spinner":"StepAnalyze_step-analyze__spinner__BZGPA",spin:"StepAnalyze_spin__L2_W6","step-analyze__overview-grid":"StepAnalyze_step-analyze__overview-grid__Pc7gH","step-analyze__metric-card":"StepAnalyze_step-analyze__metric-card__lPNvR","step-analyze__metric-value":"StepAnalyze_step-analyze__metric-value__3AAWq","step-analyze__risk-low":"StepAnalyze_step-analyze__risk-low__4ilrf","step-analyze__risk-medium":"StepAnalyze_step-analyze__risk-medium__TeRFu","step-analyze__risk-high":"StepAnalyze_step-analyze__risk-high__Uh03W","step-analyze__sectors":"StepAnalyze_step-analyze__sectors__tlr20","step-analyze__sector-list":"StepAnalyze_step-analyze__sector-list__fFut8","step-analyze__sector-tag":"StepAnalyze_step-analyze__sector-tag__rZhoN","step-analyze__performance-summary":"StepAnalyze_step-analyze__performance-summary__7t3yO","step-analyze__performance-table":"StepAnalyze_step-analyze__performance-table__Pkjnq","step-analyze__fee-breakdown":"StepAnalyze_step-analyze__fee-breakdown__Gf8z0","step-analyze__table":"StepAnalyze_step-analyze__table__hUF82","step-analyze__fund-name":"StepAnalyze_step-analyze__fund-name__SjM_O","step-analyze__risk-summary":"StepAnalyze_step-analyze__risk-summary__ykgfk","step-analyze__unit-types":"StepAnalyze_step-analyze__unit-types__Fo_Gl","step-analyze__distribution":"StepAnalyze_step-analyze__distribution__Dn6kt","step-analyze__distribution-item":"StepAnalyze_step-analyze__distribution-item__GFjHT","step-analyze__fees-summary":"StepAnalyze_step-analyze__fees-summary__A4GOC","step-analyze__diversification-summary":"StepAnalyze_step-analyze__diversification-summary__545PS","step-analyze__distribution-section":"StepAnalyze_step-analyze__distribution-section__C9nss","step-analyze__recommendations":"StepAnalyze_step-analyze__recommendations__lekbo","step-analyze__recommendation":"StepAnalyze_step-analyze__recommendation__mBGG6","step-analyze__recommendation--warning":"StepAnalyze_step-analyze__recommendation--warning__s2vur","step-analyze__recommendation--info":"StepAnalyze_step-analyze__recommendation--info__cBraP","step-analyze__recommendation--success":"StepAnalyze_step-analyze__recommendation--success__iJGy0","step-analyze__action-buttons":"StepAnalyze_step-analyze__action-buttons__v5MEh","step-analyze__back-button":"StepAnalyze_step-analyze__back-button__UmSzy",disabled:"StepAnalyze_disabled__oBUrI","step-analyze__continue-button":"StepAnalyze_step-analyze__continue-button__dmZuK","step-analyze__empty":"StepAnalyze_step-analyze__empty__3SaXL"}},3855:function(e){e.exports={"step-optimize":"StepOptimize_step-optimize__JM3LH","step-optimize__header":"StepOptimize_step-optimize__header__EUEI6","step-optimize__title":"StepOptimize_step-optimize__title__EcvKs","step-optimize__header__header-content":"StepOptimize_step-optimize__header__header-content__uReCd","step-optimize__description":"StepOptimize_step-optimize__description__VbnJm","step-optimize__controls":"StepOptimize_step-optimize__controls__RGsFl","range-selector":"StepOptimize_range-selector__Awp8V",disabled:"StepOptimize_disabled__3CfkC","range-select":"StepOptimize_range-select__GuGe1","step-optimize__layout":"StepOptimize_step-optimize__layout__CYnO7","step-optimize__sidebar":"StepOptimize_step-optimize__sidebar__yxgS2","step-optimize__tabs":"StepOptimize_step-optimize__tabs__RHAIb","step-optimize__tab":"StepOptimize_step-optimize__tab__PCpUK","step-optimize__tab--active":"StepOptimize_step-optimize__tab--active__U4MNS","step-optimize__main":"StepOptimize_step-optimize__main__RSROD","step-optimize__loading":"StepOptimize_step-optimize__loading__n3_fg","step-optimize__spinner":"StepOptimize_step-optimize__spinner__CNn30",spin:"StepOptimize_spin__2yyOK","step-optimize__error":"StepOptimize_step-optimize__error__VSLpn","retry-button":"StepOptimize_retry-button__LVueT","step-optimize__empty":"StepOptimize_step-optimize__empty__DAZc1","step-optimize__action-buttons":"StepOptimize_step-optimize__action-buttons__4vP3h","step-optimize__back-button":"StepOptimize_step-optimize__back-button__NwZ1H","step-optimize__continue-button":"StepOptimize_step-optimize__continue-button__CTPTk","optimization-tab":"StepOptimize_optimization-tab__yxGck","optimization-header":"StepOptimize_optimization-header__uXaCU","metrics-grid":"StepOptimize_metrics-grid__4d_81","metric-card":"StepOptimize_metric-card__fqDbo","metric-header":"StepOptimize_metric-header__YncIV","metric-value":"StepOptimize_metric-value__Xje7N","metric-comparison":"StepOptimize_metric-comparison__HpSUF","weights-section":"StepOptimize_weights-section__qu9cB","weights-list":"StepOptimize_weights-list__0qJcK","weight-item":"StepOptimize_weight-item__otWsK","weight-info":"StepOptimize_weight-info__ywUOU","weight-name":"StepOptimize_weight-name__9uhV1","weight-symbol":"StepOptimize_weight-symbol__Blcs3","weight-value":"StepOptimize_weight-value__rxIV1","weight-bar":"StepOptimize_weight-bar__WQJVy","weight-fill":"StepOptimize_weight-fill__IiX3i","comparison-tab":"StepOptimize_comparison-tab__xVjjJ","comparison-header":"StepOptimize_comparison-header__Bk672","comparison-table":"StepOptimize_comparison-table__BBYZE",positive:"StepOptimize_positive__ng6u_",negative:"StepOptimize_negative__PDexH","allocation-comparison":"StepOptimize_allocation-comparison__R9GuT","allocation-column":"StepOptimize_allocation-column__cb1S9","allocation-chart":"StepOptimize_allocation-chart__e_v8Z","allocation-bar":"StepOptimize_allocation-bar__covga","allocation-label":"StepOptimize_allocation-label__jl8yT","allocation-visual":"StepOptimize_allocation-visual__1cXfR","allocation-fill":"StepOptimize_allocation-fill__1SmIG","allocation-percent":"StepOptimize_allocation-percent__WQMpb","correlation-tab":"StepOptimize_correlation-tab__EHQlb","correlation-header":"StepOptimize_correlation-header__bLRNh","correlation-matrix":"StepOptimize_correlation-matrix__LWI50","correlation-symbol":"StepOptimize_correlation-symbol__qeBsm","correlation-cell":"StepOptimize_correlation-cell__WpySu","correlation-insights":"StepOptimize_correlation-insights__oPhpY","insights-grid":"StepOptimize_insights-grid__Cj2vN","insight-card":"StepOptimize_insight-card__FXIjA","allocation-tab":"StepOptimize_allocation-tab__EZshj","allocation-header":"StepOptimize_allocation-header__Cpg9l","allocation-summary":"StepOptimize_allocation-summary__E7rW8","allocation-pie":"StepOptimize_allocation-pie__UqKUV","pie-chart":"StepOptimize_pie-chart__MInZj","allocation-legend":"StepOptimize_allocation-legend__toLwF","legend-item":"StepOptimize_legend-item__IclQ3","legend-color":"StepOptimize_legend-color__J6Thl","legend-info":"StepOptimize_legend-info__6Vroe","legend-name":"StepOptimize_legend-name__r3ZMi","legend-weight":"StepOptimize_legend-weight__Re9k_","allocation-actions":"StepOptimize_allocation-actions__UX6xb","export-button":"StepOptimize_export-button__7JhEI"}},7761:function(e){e.exports={"step-picker":"StepPicker_step-picker__hMOdn","step-picker__header":"StepPicker_step-picker__header__ZwoVX","step-picker__title":"StepPicker_step-picker__title__azQV4","step-picker__description":"StepPicker_step-picker__description__4bkAm","step-picker__basket-button":"StepPicker_step-picker__basket-button__WEw_g",disabled:"StepPicker_disabled__3_3m2","step-picker__layout":"StepPicker_step-picker__layout__bY4mV","step-picker__funds-grid":"StepPicker_step-picker__funds-grid__DoXXR","step-picker__action-buttons":"StepPicker_step-picker__action-buttons__ff2p0","step-picker__continue-button":"StepPicker_step-picker__continue-button__IwZB6"}}},function(e){e.O(0,[379,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);